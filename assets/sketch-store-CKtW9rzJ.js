var Zo=Object.defineProperty;var qo=(e,t,n)=>t in e?Zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var P=(e,t,n)=>qo(e,typeof t!="symbol"?t+"":t,n);import{d as I,c as We,o as Ue,a as Z,J as Jo,h as g,b as R,q as S,i as T,j as D,F as Yo,t as Qe,k as ct,a2 as He,w as et,p as K,I as ve,Y as tt,G as Ve,f as le,x as _e,T as Xo,a4 as Qo,g as en,a5 as U,L as tn,Z as on,$ as F,a0 as E}from"./index-Da0un-1s.js";import{i as nn,m as M,n as w,o as $,B as me,l as L,aL as an,K as Ie,J as Ne,aD as rn,V as ln,w as ot,u as sn,q as dt,ah as un,E as cn,C as nt,p as dn,t as je,L as pn,v as fn,P as at,G as O,Y as rt,T as pt}from"./light-6TnQlKBd.js";import{v as mn,O as hn,j as vn,l as gn}from"./text-B338dg7y.js";import{N as it,a as yn}from"./Suffix-B1XmL1cn.js";import{u as bn}from"./use-locale-CTmw0-48.js";import{u as wn}from"./light-D0gFyn0Q.js";import{m as ae}from"./index-BdQ7pivQ.js";const xn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},la=I({name:"Route",render:function(t,n){return Ue(),We("svg",xn,n[0]||(n[0]=[Z("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[Z("circle",{cx:"6",cy:"19",r:"2"}),Z("circle",{cx:"18",cy:"5",r:"2"}),Z("path",{d:"M12 19h4.5a3.5 3.5 0 0 0 0-7h-8a3.5 3.5 0 0 1 0-7H12"})],-1)]))}}),Sn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},sa=I({name:"Trash",render:function(t,n){return Ue(),We("svg",Sn,n[0]||(n[0]=[Jo('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7h16"></path><path d="M10 11v6"></path><path d="M14 11v6"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2l1-12"></path><path d="M9 7V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3"></path></g>',1)]))}}),Cn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ua=I({name:"Upload",render:function(t,n){return Ue(),We("svg",Cn,n[0]||(n[0]=[Z("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[Z("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"}),Z("path",{d:"M7 9l5-5l5 5"}),Z("path",{d:"M12 4v12"})],-1)]))}}),ca=I({name:"Add",render(){return g("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),kn=I({name:"Eye",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),g("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),zn=I({name:"EyeOff",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g("path",{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z",fill:"currentColor"}),g("path",{d:"M255.66 384c-41.49 0-81.5-12.28-118.92-36.5c-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 0 0 .14-2.94L93.5 161.38a2 2 0 0 0-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0 0 75.8-12.58a2 2 0 0 0 .77-3.31l-21.58-21.58a4 4 0 0 0-3.83-1a204.8 204.8 0 0 1-51.16 6.47z",fill:"currentColor"}),g("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 0 0-74.89 12.83a2 2 0 0 0-.75 3.31l21.55 21.55a4 4 0 0 0 3.88 1a192.82 192.82 0 0 1 50.21-6.69c40.69 0 80.58 12.43 118.55 37c34.71 22.4 65.74 53.88 89.76 91a.13.13 0 0 1 0 .16a310.72 310.72 0 0 1-64.12 72.73a2 2 0 0 0-.15 2.95l19.9 19.89a2 2 0 0 0 2.7.13a343.49 343.49 0 0 0 68.64-78.48a32.2 32.2 0 0 0-.1-34.78z",fill:"currentColor"}),g("path",{d:"M256 160a95.88 95.88 0 0 0-21.37 2.4a2 2 0 0 0-1 3.38l112.59 112.56a2 2 0 0 0 3.38-1A96 96 0 0 0 256 160z",fill:"currentColor"}),g("path",{d:"M165.78 233.66a2 2 0 0 0-3.38 1a96 96 0 0 0 115 115a2 2 0 0 0 1-3.38z",fill:"currentColor"}))}}),ft=nn("n-input"),Rn=M("input",`
 max-width: 100%;
 cursor: text;
 line-height: 1.5;
 z-index: auto;
 outline: none;
 box-sizing: border-box;
 position: relative;
 display: inline-flex;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 --n-padding-vertical: calc((var(--n-height) - 1.5 * var(--n-font-size)) / 2);
`,[w("input, textarea",`
 overflow: hidden;
 flex-grow: 1;
 position: relative;
 `),w("input-el, textarea-el, input-mirror, textarea-mirror, separator, placeholder",`
 box-sizing: border-box;
 font-size: inherit;
 line-height: 1.5;
 font-family: inherit;
 border: none;
 outline: none;
 background-color: #0000;
 text-align: inherit;
 transition:
 -webkit-text-fill-color .3s var(--n-bezier),
 caret-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 `),w("input-el, textarea-el",`
 -webkit-appearance: none;
 scrollbar-width: none;
 width: 100%;
 min-width: 0;
 text-decoration-color: var(--n-text-decoration-color);
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 background-color: transparent;
 `,[L("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),L("&::placeholder",`
 color: #0000;
 -webkit-text-fill-color: transparent !important;
 `),L("&:-webkit-autofill ~",[w("placeholder","display: none;")])]),$("round",[me("textarea","border-radius: calc(var(--n-height) / 2);")]),w("placeholder",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: hidden;
 color: var(--n-placeholder-color);
 `,[L("span",`
 width: 100%;
 display: inline-block;
 `)]),$("textarea",[w("placeholder","overflow: visible;")]),me("autosize","width: 100%;"),$("autosize",[w("textarea-el, input-el",`
 position: absolute;
 top: 0;
 left: 0;
 height: 100%;
 `)]),M("input-wrapper",`
 overflow: hidden;
 display: inline-flex;
 flex-grow: 1;
 position: relative;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 `),w("input-mirror",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre;
 pointer-events: none;
 `),w("input-el",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 `,[L("&[type=password]::-ms-reveal","display: none;"),L("+",[w("placeholder",`
 display: flex;
 align-items: center; 
 `)])]),me("textarea",[w("placeholder","white-space: nowrap;")]),w("eye",`
 display: flex;
 align-items: center;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `),$("textarea","width: 100%;",[M("input-word-count",`
 position: absolute;
 right: var(--n-padding-right);
 bottom: var(--n-padding-vertical);
 `),$("resizable",[M("input-wrapper",`
 resize: vertical;
 min-height: var(--n-height);
 `)]),w("textarea-el, textarea-mirror, placeholder",`
 height: 100%;
 padding-left: 0;
 padding-right: 0;
 padding-top: var(--n-padding-vertical);
 padding-bottom: var(--n-padding-vertical);
 word-break: break-word;
 display: inline-block;
 vertical-align: bottom;
 box-sizing: border-box;
 line-height: var(--n-line-height-textarea);
 margin: 0;
 resize: none;
 white-space: pre-wrap;
 scroll-padding-block-end: var(--n-padding-vertical);
 `),w("textarea-mirror",`
 width: 100%;
 pointer-events: none;
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre-wrap;
 overflow-wrap: break-word;
 `)]),$("pair",[w("input-el, placeholder","text-align: center;"),w("separator",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 white-space: nowrap;
 `,[M("icon",`
 color: var(--n-icon-color);
 `),M("base-icon",`
 color: var(--n-icon-color);
 `)])]),$("disabled",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[w("border","border: var(--n-border-disabled);"),w("input-el, textarea-el",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 text-decoration-color: var(--n-text-color-disabled);
 `),w("placeholder","color: var(--n-placeholder-color-disabled);"),w("separator","color: var(--n-text-color-disabled);",[M("icon",`
 color: var(--n-icon-color-disabled);
 `),M("base-icon",`
 color: var(--n-icon-color-disabled);
 `)]),M("input-word-count",`
 color: var(--n-count-text-color-disabled);
 `),w("suffix, prefix","color: var(--n-text-color-disabled);",[M("icon",`
 color: var(--n-icon-color-disabled);
 `),M("internal-icon",`
 color: var(--n-icon-color-disabled);
 `)])]),me("disabled",[w("eye",`
 color: var(--n-icon-color);
 cursor: pointer;
 `,[L("&:hover",`
 color: var(--n-icon-color-hover);
 `),L("&:active",`
 color: var(--n-icon-color-pressed);
 `)]),L("&:hover",[w("state-border","border: var(--n-border-hover);")]),$("focus","background-color: var(--n-color-focus);",[w("state-border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),w("border, state-border",`
 box-sizing: border-box;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: inherit;
 border: var(--n-border);
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),w("state-border",`
 border-color: #0000;
 z-index: 1;
 `),w("prefix","margin-right: 4px;"),w("suffix",`
 margin-left: 4px;
 `),w("suffix, prefix",`
 transition: color .3s var(--n-bezier);
 flex-wrap: nowrap;
 flex-shrink: 0;
 line-height: var(--n-height);
 white-space: nowrap;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 color: var(--n-suffix-text-color);
 `,[M("base-loading",`
 font-size: var(--n-icon-size);
 margin: 0 2px;
 color: var(--n-loading-color);
 `),M("base-clear",`
 font-size: var(--n-icon-size);
 `,[w("placeholder",[M("base-icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)])]),L(">",[M("icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),M("base-icon",`
 font-size: var(--n-icon-size);
 `)]),M("input-word-count",`
 pointer-events: none;
 line-height: 1.5;
 font-size: .85em;
 color: var(--n-count-text-color);
 transition: color .3s var(--n-bezier);
 margin-left: 4px;
 font-variant: tabular-nums;
 `),["warning","error"].map(e=>$(`${e}-status`,[me("disabled",[M("base-loading",`
 color: var(--n-loading-color-${e})
 `),w("input-el, textarea-el",`
 caret-color: var(--n-caret-color-${e});
 `),w("state-border",`
 border: var(--n-border-${e});
 `),L("&:hover",[w("state-border",`
 border: var(--n-border-hover-${e});
 `)]),L("&:focus",`
 background-color: var(--n-color-focus-${e});
 `,[w("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)]),$("focus",`
 background-color: var(--n-color-focus-${e});
 `,[w("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),In=M("input",[$("disabled",[w("input-el, textarea-el",`
 -webkit-text-fill-color: var(--n-text-color-disabled);
 `)])]);function Bn(e){let t=0;for(const n of e)t++;return t}function Be(e){return e===""||e==null}function Mn(e){const t=R(null);function n(){const{value:l}=e;if(!(l!=null&&l.focus)){a();return}const{selectionStart:b,selectionEnd:f,value:h}=l;if(b==null||f==null){a();return}t.value={start:b,end:f,beforeText:h.slice(0,b),afterText:h.slice(f)}}function r(){var l;const{value:b}=t,{value:f}=e;if(!b||!f)return;const{value:h}=f,{start:v,beforeText:y,afterText:k}=b;let s=h.length;if(h.endsWith(k))s=h.length-k.length;else if(h.startsWith(y))s=y.length;else{const d=y[v-1],_=h.indexOf(d,v-1);_!==-1&&(s=_+1)}(l=f.setSelectionRange)===null||l===void 0||l.call(f,s,s)}function a(){t.value=null}return S(e,a),{recordCursor:n,restoreCursor:r}}const lt=I({name:"InputWordCount",setup(e,{slots:t}){const{mergedValueRef:n,maxlengthRef:r,mergedClsPrefixRef:a,countGraphemesRef:l}=T(ft),b=D(()=>{const{value:f}=n;return f===null||Array.isArray(f)?0:(l.value||Bn)(f)});return()=>{const{value:f}=r,{value:h}=n;return g("span",{class:`${a.value}-input-word-count`},an(t.default,{value:h===null||Array.isArray(h)?"":h},()=>[f===void 0?b.value:`${b.value} / ${f}`]))}}}),_n=Object.assign(Object.assign({},dt.props),{bordered:{type:Boolean,default:void 0},type:{type:String,default:"text"},placeholder:[Array,String],defaultValue:{type:[String,Array],default:null},value:[String,Array],disabled:{type:Boolean,default:void 0},size:String,rows:{type:[Number,String],default:3},round:Boolean,minlength:[String,Number],maxlength:[String,Number],clearable:Boolean,autosize:{type:[Boolean,Object],default:!1},pair:Boolean,separator:String,readonly:{type:[String,Boolean],default:!1},passivelyActivated:Boolean,showPasswordOn:String,stateful:{type:Boolean,default:!0},autofocus:Boolean,inputProps:Object,resizable:{type:Boolean,default:!0},showCount:Boolean,loading:{type:Boolean,default:void 0},allowInput:Function,renderCount:Function,onMousedown:Function,onKeydown:Function,onKeyup:[Function,Array],onInput:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClick:[Function,Array],onChange:[Function,Array],onClear:[Function,Array],countGraphemes:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],textDecoration:[String,Array],attrSize:{type:Number,default:20},onInputBlur:[Function,Array],onInputFocus:[Function,Array],onDeactivate:[Function,Array],onActivate:[Function,Array],onWrapperFocus:[Function,Array],onWrapperBlur:[Function,Array],internalDeactivateOnEnter:Boolean,internalForceFocus:Boolean,internalLoadingBeforeSuffix:{type:Boolean,default:!0},showPasswordToggle:Boolean}),da=I({name:"Input",props:_n,slots:Object,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:n,inlineThemeDisabled:r,mergedRtlRef:a}=sn(e),l=dt("Input","-input",Rn,mn,e,t);hn&&un("-input-safari",In,t);const b=R(null),f=R(null),h=R(null),v=R(null),y=R(null),k=R(null),s=R(null),d=Mn(s),_=R(null),{localeRef:W}=bn("Input"),re=R(e.defaultValue),Ae=Qe(e,"value"),j=cn(Ae,re),Y=wn(e),{mergedSizeRef:ce,mergedDisabledRef:H,mergedStatusRef:Te}=Y,G=R(!1),X=R(!1),c=R(!1),u=R(!1);let p=null;const x=D(()=>{const{placeholder:o,pair:i}=e;return i?Array.isArray(o)?o:o===void 0?["",""]:[o,o]:o===void 0?[W.value.placeholder]:[o]}),Oe=D(()=>{const{value:o}=c,{value:i}=j,{value:m}=x;return!o&&(Be(i)||Array.isArray(i)&&Be(i[0]))&&m[0]}),bt=D(()=>{const{value:o}=c,{value:i}=j,{value:m}=x;return!o&&m[1]&&(Be(i)||Array.isArray(i)&&Be(i[1]))}),Pe=nt(()=>e.internalForceFocus||G.value),wt=nt(()=>{if(H.value||e.readonly||!e.clearable||!Pe.value&&!X.value)return!1;const{value:o}=j,{value:i}=Pe;return e.pair?!!(Array.isArray(o)&&(o[0]||o[1]))&&(X.value||i):!!o&&(X.value||i)}),Fe=D(()=>{const{showPasswordOn:o}=e;if(o)return o;if(e.showPasswordToggle)return"click"}),de=R(!1),xt=D(()=>{const{textDecoration:o}=e;return o?Array.isArray(o)?o.map(i=>({textDecoration:i})):[{textDecoration:o}]:["",""]}),Ze=R(void 0),St=()=>{var o,i;if(e.type==="textarea"){const{autosize:m}=e;if(m&&(Ze.value=(i=(o=_.value)===null||o===void 0?void 0:o.$el)===null||i===void 0?void 0:i.offsetWidth),!f.value||typeof m=="boolean")return;const{paddingTop:z,paddingBottom:B,lineHeight:C}=window.getComputedStyle(f.value),Q=Number(z.slice(0,-2)),ee=Number(B.slice(0,-2)),te=Number(C.slice(0,-2)),{value:pe}=h;if(!pe)return;if(m.minRows){const fe=Math.max(m.minRows,1),Le=`${Q+ee+te*fe}px`;pe.style.minHeight=Le}if(m.maxRows){const fe=`${Q+ee+te*m.maxRows}px`;pe.style.maxHeight=fe}}},Ct=D(()=>{const{maxlength:o}=e;return o===void 0?void 0:Number(o)});ct(()=>{const{value:o}=j;Array.isArray(o)||De(o)});const kt=He().proxy;function xe(o,i){const{onUpdateValue:m,"onUpdate:value":z,onInput:B}=e,{nTriggerFormInput:C}=Y;m&&O(m,o,i),z&&O(z,o,i),B&&O(B,o,i),re.value=o,C()}function Se(o,i){const{onChange:m}=e,{nTriggerFormChange:z}=Y;m&&O(m,o,i),re.value=o,z()}function zt(o){const{onBlur:i}=e,{nTriggerFormBlur:m}=Y;i&&O(i,o),m()}function Rt(o){const{onFocus:i}=e,{nTriggerFormFocus:m}=Y;i&&O(i,o),m()}function It(o){const{onClear:i}=e;i&&O(i,o)}function Bt(o){const{onInputBlur:i}=e;i&&O(i,o)}function Mt(o){const{onInputFocus:i}=e;i&&O(i,o)}function _t(){const{onDeactivate:o}=e;o&&O(o)}function At(){const{onActivate:o}=e;o&&O(o)}function Tt(o){const{onClick:i}=e;i&&O(i,o)}function Ot(o){const{onWrapperFocus:i}=e;i&&O(i,o)}function Pt(o){const{onWrapperBlur:i}=e;i&&O(i,o)}function Ft(){c.value=!0}function Et(o){c.value=!1,o.target===k.value?Ce(o,1):Ce(o,0)}function Ce(o,i=0,m="input"){const z=o.target.value;if(De(z),o instanceof InputEvent&&!o.isComposing&&(c.value=!1),e.type==="textarea"){const{value:C}=_;C&&C.syncUnifiedContainer()}if(p=z,c.value)return;d.recordCursor();const B=Dt(z);if(B)if(!e.pair)m==="input"?xe(z,{source:i}):Se(z,{source:i});else{let{value:C}=j;Array.isArray(C)?C=[C[0],C[1]]:C=["",""],C[i]=z,m==="input"?xe(C,{source:i}):Se(C,{source:i})}kt.$forceUpdate(),B||ve(d.restoreCursor)}function Dt(o){const{countGraphemes:i,maxlength:m,minlength:z}=e;if(i){let C;if(m!==void 0&&(C===void 0&&(C=i(o)),C>Number(m))||z!==void 0&&(C===void 0&&(C=i(o)),C<Number(m)))return!1}const{allowInput:B}=e;return typeof B=="function"?B(o):!0}function Lt(o){Bt(o),o.relatedTarget===b.value&&_t(),o.relatedTarget!==null&&(o.relatedTarget===y.value||o.relatedTarget===k.value||o.relatedTarget===f.value)||(u.value=!1),ke(o,"blur"),s.value=null}function Nt(o,i){Mt(o),G.value=!0,u.value=!0,At(),ke(o,"focus"),i===0?s.value=y.value:i===1?s.value=k.value:i===2&&(s.value=f.value)}function jt(o){e.passivelyActivated&&(Pt(o),ke(o,"blur"))}function $t(o){e.passivelyActivated&&(G.value=!0,Ot(o),ke(o,"focus"))}function ke(o,i){o.relatedTarget!==null&&(o.relatedTarget===y.value||o.relatedTarget===k.value||o.relatedTarget===f.value||o.relatedTarget===b.value)||(i==="focus"?(Rt(o),G.value=!0):i==="blur"&&(zt(o),G.value=!1))}function Vt(o,i){Ce(o,i,"change")}function Wt(o){Tt(o)}function Ut(o){It(o),qe()}function qe(){e.pair?(xe(["",""],{source:"clear"}),Se(["",""],{source:"clear"})):(xe("",{source:"clear"}),Se("",{source:"clear"}))}function Ht(o){const{onMousedown:i}=e;i&&i(o);const{tagName:m}=o.target;if(m!=="INPUT"&&m!=="TEXTAREA"){if(e.resizable){const{value:z}=b;if(z){const{left:B,top:C,width:Q,height:ee}=z.getBoundingClientRect(),te=14;if(B+Q-te<o.clientX&&o.clientX<B+Q&&C+ee-te<o.clientY&&o.clientY<C+ee)return}}o.preventDefault(),G.value||Je()}}function Gt(){var o;X.value=!0,e.type==="textarea"&&((o=_.value)===null||o===void 0||o.handleMouseEnterWrapper())}function Kt(){var o;X.value=!1,e.type==="textarea"&&((o=_.value)===null||o===void 0||o.handleMouseLeaveWrapper())}function Zt(){H.value||Fe.value==="click"&&(de.value=!de.value)}function qt(o){if(H.value)return;o.preventDefault();const i=z=>{z.preventDefault(),rt("mouseup",document,i)};if(at("mouseup",document,i),Fe.value!=="mousedown")return;de.value=!0;const m=()=>{de.value=!1,rt("mouseup",document,m)};at("mouseup",document,m)}function Jt(o){e.onKeyup&&O(e.onKeyup,o)}function Yt(o){switch(e.onKeydown&&O(e.onKeydown,o),o.key){case"Escape":Ee();break;case"Enter":Xt(o);break}}function Xt(o){var i,m;if(e.passivelyActivated){const{value:z}=u;if(z){e.internalDeactivateOnEnter&&Ee();return}o.preventDefault(),e.type==="textarea"?(i=f.value)===null||i===void 0||i.focus():(m=y.value)===null||m===void 0||m.focus()}}function Ee(){e.passivelyActivated&&(u.value=!1,ve(()=>{var o;(o=b.value)===null||o===void 0||o.focus()}))}function Je(){var o,i,m;H.value||(e.passivelyActivated?(o=b.value)===null||o===void 0||o.focus():((i=f.value)===null||i===void 0||i.focus(),(m=y.value)===null||m===void 0||m.focus()))}function Qt(){var o;!((o=b.value)===null||o===void 0)&&o.contains(document.activeElement)&&document.activeElement.blur()}function eo(){var o,i;(o=f.value)===null||o===void 0||o.select(),(i=y.value)===null||i===void 0||i.select()}function to(){H.value||(f.value?f.value.focus():y.value&&y.value.focus())}function oo(){const{value:o}=b;o!=null&&o.contains(document.activeElement)&&o!==document.activeElement&&Ee()}function no(o){if(e.type==="textarea"){const{value:i}=f;i==null||i.scrollTo(o)}else{const{value:i}=y;i==null||i.scrollTo(o)}}function De(o){const{type:i,pair:m,autosize:z}=e;if(!m&&z)if(i==="textarea"){const{value:B}=h;B&&(B.textContent=`${o??""}\r
`)}else{const{value:B}=v;B&&(o?B.textContent=o:B.innerHTML="&nbsp;")}}function ao(){St()}const Ye=R({top:"0"});function ro(o){var i;const{scrollTop:m}=o.target;Ye.value.top=`${-m}px`,(i=_.value)===null||i===void 0||i.syncUnifiedContainer()}let ze=null;et(()=>{const{autosize:o,type:i}=e;o&&i==="textarea"?ze=S(j,m=>{!Array.isArray(m)&&m!==p&&De(m)}):ze==null||ze()});let Re=null;et(()=>{e.type==="textarea"?Re=S(j,o=>{var i;!Array.isArray(o)&&o!==p&&((i=_.value)===null||i===void 0||i.syncUnifiedContainer())}):Re==null||Re()}),K(ft,{mergedValueRef:j,maxlengthRef:Ct,mergedClsPrefixRef:t,countGraphemesRef:Qe(e,"countGraphemes")});const io={wrapperElRef:b,inputElRef:y,textareaElRef:f,isCompositing:c,clear:qe,focus:Je,blur:Qt,select:eo,deactivate:oo,activate:to,scrollTo:no},lo=dn("Input",a,t),Xe=D(()=>{const{value:o}=ce,{common:{cubicBezierEaseInOut:i},self:{color:m,borderRadius:z,textColor:B,caretColor:C,caretColorError:Q,caretColorWarning:ee,textDecorationColor:te,border:pe,borderDisabled:fe,borderHover:Le,borderFocus:so,placeholderColor:uo,placeholderColorDisabled:co,lineHeightTextarea:po,colorDisabled:fo,colorFocus:mo,textColorDisabled:ho,boxShadowFocus:vo,iconSize:go,colorFocusWarning:yo,boxShadowFocusWarning:bo,borderWarning:wo,borderFocusWarning:xo,borderHoverWarning:So,colorFocusError:Co,boxShadowFocusError:ko,borderError:zo,borderFocusError:Ro,borderHoverError:Io,clearSize:Bo,clearColor:Mo,clearColorHover:_o,clearColorPressed:Ao,iconColor:To,iconColorDisabled:Oo,suffixTextColor:Po,countTextColor:Fo,countTextColorDisabled:Eo,iconColorHover:Do,iconColorPressed:Lo,loadingColor:No,loadingColorError:jo,loadingColorWarning:$o,fontWeight:Vo,[je("padding",o)]:Wo,[je("fontSize",o)]:Uo,[je("height",o)]:Ho}}=l.value,{left:Go,right:Ko}=pn(Wo);return{"--n-bezier":i,"--n-count-text-color":Fo,"--n-count-text-color-disabled":Eo,"--n-color":m,"--n-font-size":Uo,"--n-font-weight":Vo,"--n-border-radius":z,"--n-height":Ho,"--n-padding-left":Go,"--n-padding-right":Ko,"--n-text-color":B,"--n-caret-color":C,"--n-text-decoration-color":te,"--n-border":pe,"--n-border-disabled":fe,"--n-border-hover":Le,"--n-border-focus":so,"--n-placeholder-color":uo,"--n-placeholder-color-disabled":co,"--n-icon-size":go,"--n-line-height-textarea":po,"--n-color-disabled":fo,"--n-color-focus":mo,"--n-text-color-disabled":ho,"--n-box-shadow-focus":vo,"--n-loading-color":No,"--n-caret-color-warning":ee,"--n-color-focus-warning":yo,"--n-box-shadow-focus-warning":bo,"--n-border-warning":wo,"--n-border-focus-warning":xo,"--n-border-hover-warning":So,"--n-loading-color-warning":$o,"--n-caret-color-error":Q,"--n-color-focus-error":Co,"--n-box-shadow-focus-error":ko,"--n-border-error":zo,"--n-border-focus-error":Ro,"--n-border-hover-error":Io,"--n-loading-color-error":jo,"--n-clear-color":Mo,"--n-clear-size":Bo,"--n-clear-color-hover":_o,"--n-clear-color-pressed":Ao,"--n-icon-color":To,"--n-icon-color-hover":Do,"--n-icon-color-pressed":Lo,"--n-icon-color-disabled":Oo,"--n-suffix-text-color":Po}}),ie=r?fn("input",D(()=>{const{value:o}=ce;return o[0]}),Xe,e):void 0;return Object.assign(Object.assign({},io),{wrapperElRef:b,inputElRef:y,inputMirrorElRef:v,inputEl2Ref:k,textareaElRef:f,textareaMirrorElRef:h,textareaScrollbarInstRef:_,rtlEnabled:lo,uncontrolledValue:re,mergedValue:j,passwordVisible:de,mergedPlaceholder:x,showPlaceholder1:Oe,showPlaceholder2:bt,mergedFocus:Pe,isComposing:c,activated:u,showClearButton:wt,mergedSize:ce,mergedDisabled:H,textDecorationStyle:xt,mergedClsPrefix:t,mergedBordered:n,mergedShowPasswordOn:Fe,placeholderStyle:Ye,mergedStatus:Te,textAreaScrollContainerWidth:Ze,handleTextAreaScroll:ro,handleCompositionStart:Ft,handleCompositionEnd:Et,handleInput:Ce,handleInputBlur:Lt,handleInputFocus:Nt,handleWrapperBlur:jt,handleWrapperFocus:$t,handleMouseEnter:Gt,handleMouseLeave:Kt,handleMouseDown:Ht,handleChange:Vt,handleClick:Wt,handleClear:Ut,handlePasswordToggleClick:Zt,handlePasswordToggleMousedown:qt,handleWrapperKeydown:Yt,handleWrapperKeyup:Jt,handleTextAreaMirrorResize:ao,getTextareaScrollContainer:()=>f.value,mergedTheme:l,cssVars:r?void 0:Xe,themeClass:ie==null?void 0:ie.themeClass,onRender:ie==null?void 0:ie.onRender})},render(){var e,t;const{mergedClsPrefix:n,mergedStatus:r,themeClass:a,type:l,countGraphemes:b,onRender:f}=this,h=this.$slots;return f==null||f(),g("div",{ref:"wrapperElRef",class:[`${n}-input`,a,r&&`${n}-input--${r}-status`,{[`${n}-input--rtl`]:this.rtlEnabled,[`${n}-input--disabled`]:this.mergedDisabled,[`${n}-input--textarea`]:l==="textarea",[`${n}-input--resizable`]:this.resizable&&!this.autosize,[`${n}-input--autosize`]:this.autosize,[`${n}-input--round`]:this.round&&l!=="textarea",[`${n}-input--pair`]:this.pair,[`${n}-input--focus`]:this.mergedFocus,[`${n}-input--stateful`]:this.stateful}],style:this.cssVars,tabindex:!this.mergedDisabled&&this.passivelyActivated&&!this.activated?0:void 0,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,onClick:this.handleClick,onMousedown:this.handleMouseDown,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd,onKeyup:this.handleWrapperKeyup,onKeydown:this.handleWrapperKeydown},g("div",{class:`${n}-input-wrapper`},Ie(h.prefix,v=>v&&g("div",{class:`${n}-input__prefix`},v)),l==="textarea"?g(rn,{ref:"textareaScrollbarInstRef",class:`${n}-input__textarea`,container:this.getTextareaScrollContainer,triggerDisplayManually:!0,useUnifiedContainer:!0,internalHoistYRail:!0},{default:()=>{var v,y;const{textAreaScrollContainerWidth:k}=this,s={width:this.autosize&&k&&`${k}px`};return g(Yo,null,g("textarea",Object.assign({},this.inputProps,{ref:"textareaElRef",class:[`${n}-input__textarea-el`,(v=this.inputProps)===null||v===void 0?void 0:v.class],autofocus:this.autofocus,rows:Number(this.rows),placeholder:this.placeholder,value:this.mergedValue,disabled:this.mergedDisabled,maxlength:b?void 0:this.maxlength,minlength:b?void 0:this.minlength,readonly:this.readonly,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,style:[this.textDecorationStyle[0],(y=this.inputProps)===null||y===void 0?void 0:y.style,s],onBlur:this.handleInputBlur,onFocus:d=>{this.handleInputFocus(d,2)},onInput:this.handleInput,onChange:this.handleChange,onScroll:this.handleTextAreaScroll})),this.showPlaceholder1?g("div",{class:`${n}-input__placeholder`,style:[this.placeholderStyle,s],key:"placeholder"},this.mergedPlaceholder[0]):null,this.autosize?g(ln,{onResize:this.handleTextAreaMirrorResize},{default:()=>g("div",{ref:"textareaMirrorElRef",class:`${n}-input__textarea-mirror`,key:"mirror"})}):null)}}):g("div",{class:`${n}-input__input`},g("input",Object.assign({type:l==="password"&&this.mergedShowPasswordOn&&this.passwordVisible?"text":l},this.inputProps,{ref:"inputElRef",class:[`${n}-input__input-el`,(e=this.inputProps)===null||e===void 0?void 0:e.class],style:[this.textDecorationStyle[0],(t=this.inputProps)===null||t===void 0?void 0:t.style],tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[0],disabled:this.mergedDisabled,maxlength:b?void 0:this.maxlength,minlength:b?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[0]:this.mergedValue,readonly:this.readonly,autofocus:this.autofocus,size:this.attrSize,onBlur:this.handleInputBlur,onFocus:v=>{this.handleInputFocus(v,0)},onInput:v=>{this.handleInput(v,0)},onChange:v=>{this.handleChange(v,0)}})),this.showPlaceholder1?g("div",{class:`${n}-input__placeholder`},g("span",null,this.mergedPlaceholder[0])):null,this.autosize?g("div",{class:`${n}-input__input-mirror`,key:"mirror",ref:"inputMirrorElRef"}," "):null),!this.pair&&Ie(h.suffix,v=>v||this.clearable||this.showCount||this.mergedShowPasswordOn||this.loading!==void 0?g("div",{class:`${n}-input__suffix`},[Ie(h["clear-icon-placeholder"],y=>(this.clearable||y)&&g(it,{clsPrefix:n,show:this.showClearButton,onClear:this.handleClear},{placeholder:()=>y,icon:()=>{var k,s;return(s=(k=this.$slots)["clear-icon"])===null||s===void 0?void 0:s.call(k)}})),this.internalLoadingBeforeSuffix?null:v,this.loading!==void 0?g(yn,{clsPrefix:n,loading:this.loading,showArrow:!1,showClear:!1,style:this.cssVars}):null,this.internalLoadingBeforeSuffix?v:null,this.showCount&&this.type!=="textarea"?g(lt,null,{default:y=>{var k;const{renderCount:s}=this;return s?s(y):(k=h.count)===null||k===void 0?void 0:k.call(h,y)}}):null,this.mergedShowPasswordOn&&this.type==="password"?g("div",{class:`${n}-input__eye`,onMousedown:this.handlePasswordToggleMousedown,onClick:this.handlePasswordToggleClick},this.passwordVisible?Ne(h["password-visible-icon"],()=>[g(ot,{clsPrefix:n},{default:()=>g(kn,null)})]):Ne(h["password-invisible-icon"],()=>[g(ot,{clsPrefix:n},{default:()=>g(zn,null)})])):null]):null)),this.pair?g("span",{class:`${n}-input__separator`},Ne(h.separator,()=>[this.separator])):null,this.pair?g("div",{class:`${n}-input-wrapper`},g("div",{class:`${n}-input__input`},g("input",{ref:"inputEl2Ref",type:this.type,class:`${n}-input__input-el`,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[1],disabled:this.mergedDisabled,maxlength:b?void 0:this.maxlength,minlength:b?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[1]:void 0,readonly:this.readonly,style:this.textDecorationStyle[1],onBlur:this.handleInputBlur,onFocus:v=>{this.handleInputFocus(v,1)},onInput:v=>{this.handleInput(v,1)},onChange:v=>{this.handleChange(v,1)}}),this.showPlaceholder2?g("div",{class:`${n}-input__placeholder`},g("span",null,this.mergedPlaceholder[1])):null),Ie(h.suffix,v=>(this.clearable||v)&&g("div",{class:`${n}-input__suffix`},[this.clearable&&g(it,{clsPrefix:n,show:this.showClearButton,onClear:this.handleClear},{icon:()=>{var y;return(y=h["clear-icon"])===null||y===void 0?void 0:y.call(h)},placeholder:()=>{var y;return(y=h["clear-icon-placeholder"])===null||y===void 0?void 0:y.call(h)}}),v]))):null,this.mergedBordered?g("div",{class:`${n}-input__border`}):null,this.mergedBordered?g("div",{class:`${n}-input__state-border`}):null,this.showCount&&l==="textarea"?g(lt,null,{default:v=>{var y;const{renderCount:k}=this;return k?k(v):(y=h.count)===null||y===void 0?void 0:y.call(h,v)}}):null)}});function pa(){const e=T(vn,null);return e===null&&pt("use-dialog","No outer <n-dialog-provider /> founded."),e}function fa(){const e=T(gn,null);return e===null&&pt("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),e}/*!
* @indoorequal/vue-maplibre-gl v8.4.2
* (c) 2025 François de Metz <francois@2metz.fr>
* @license MIT
*/const An=Symbol("map"),se=An,ye=Symbol("isLoaded"),Tn=Symbol("isInitialized"),mt=Tn,Ge=Symbol("componentId"),Ke=Symbol("sourceId"),ht=Symbol("sourceLayerRegistry"),On=["error","load","idle","remove","render","resize","webglcontextlost","webglcontextrestored","dataloading","data","tiledataloading","sourcedataloading","styledataloading","sourcedata","styledata","styleimagemissing","dataabort","sourcedataabort","boxzoomcancel","boxzoomstart","boxzoomend","touchcancel","touchmove","touchend","touchstart","click","contextmenu","dblclick","mousemove","mouseup","mousedown","mouseout","mouseover","movestart","move","moveend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","dragstart","drag","dragend","pitchstart","pitch","pitchend","wheel","terrain","cooperativegestureprevented"];function Pn(e,t,n,r){return a=>n.emit(r,{type:a.type,map:t,component:e,event:a})}function Fn(e,t){const n=ae.LngLat.convert(e),r=ae.LngLat.convert(t);return n.lng===r.lng&&n.lat===r.lat}var be=(e=>(e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_RIGHT="bottom-right",e))(be||{});const ue=Object.values(be),st=new Map,En=Symbol("default");function Dn(e,t,n=En){var a;let r=st.get(n);return r||(r=en({isLoaded:!1,isMounted:!1,language:null}),st.set(n,r)),r.isLoaded=((a=t.value)==null?void 0:a.loaded())||!1,r.isMounted=!1,r.component=e,r.map=t.value,r}const ma=I({name:"MglMap",props:{width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},attributionControl:{type:[Boolean,Object],default:void 0},bearing:{type:Number},bearingSnap:{type:Number},bounds:{type:[Array,Object]},boxZoom:{type:Boolean,default:void 0},center:{type:[Array,Object]},clickTolerance:{type:Number},collectResourceTiming:{type:Boolean,default:void 0},crossSourceCollisions:{type:Boolean,default:void 0},dragPan:{type:Boolean,default:void 0},dragRotate:{type:Boolean,default:void 0},doubleClickZoom:{type:Boolean,default:void 0},hash:{type:[Boolean,String],default:void 0},fadeDuration:{type:Number},fitBoundsOptions:{type:Object},interactive:{type:Boolean,default:void 0},keyboard:{type:Boolean,default:void 0},locale:{type:Object},localIdeographFontFamily:{type:String},logoPosition:{type:[String],validator:e=>e in be},maxBounds:{type:[Array,Object]},maxPitch:{type:Number},maxZoom:{type:Number},minPitch:{type:Number},minZoom:{type:Number},pitch:{type:Number},pitchWithRotate:{type:Boolean,default:void 0},canvasContextAttributes:{type:Object},refreshExpiredTiles:{type:Boolean,default:void 0},renderWorldCopies:{type:Boolean,default:void 0},scrollZoom:{type:Boolean,default:void 0},mapStyle:{type:[String,Object]},trackResize:{type:Boolean,default:void 0},transformRequest:{type:Function},transformCameraUpdate:{type:Function},touchZoomRotate:{type:Boolean,default:void 0},touchPitch:{type:Boolean,default:void 0},zoom:{type:Number},maxTileCacheSize:{type:Number},mapKey:{type:[String,Symbol]},pixelRatio:{type:Number},validateStyle:{type:Boolean,default:void 0},cooperativeGestures:{type:Boolean}},emits:["map:error","map:load","map:idle","map:remove","map:render","map:resize","map:webglcontextlost","map:webglcontextrestored","map:dataloading","map:data","map:tiledataloading","map:sourcedataloading","map:styledataloading","map:sourcedata","map:styledata","map:styleimagemissing","map:dataabort","map:sourcedataabort","map:boxzoomcancel","map:boxzoomstart","map:boxzoomend","map:touchcancel","map:touchmove","map:touchend","map:touchstart","map:click","map:contextmenu","map:dblclick","map:mousemove","map:mouseup","map:mousedown","map:mouseout","map:mouseover","map:movestart","map:move","map:moveend","map:zoomstart","map:zoom","map:zoomend","map:rotatestart","map:rotate","map:rotateend","map:dragstart","map:drag","map:dragend","map:pitchstart","map:pitch","map:pitchend","map:wheel","map:terrain","map:cooperativegestureprevented","map:projectiontransition","update:center","update:zoom","update:pitch","update:bearing"],slots:Object,setup(e,t){const n=tt(He()),r=Ve(),a=Ve(),l=R(!1),b=R(!1),f=new Map,h=Dn(n,a,e.mapKey);K(se,a),K(ye,b),K(mt,l),K(Ge,n.uid),K(Ke,""),S(()=>e.bearing,s=>{var d;s&&((d=a.value)==null||d.setBearing(s))}),S(()=>e.bounds,s=>{var d;s&&((d=a.value)==null||d.fitBounds(s,e.fitBoundsOptions))}),S(()=>e.center,s=>{var _,W;const d=(_=a.value)==null?void 0:_.getCenter();s&&d&&!Fn(s,d)&&((W=a.value)==null||W.setCenter(s))}),S(()=>e.maxBounds,s=>{var d;s&&((d=a.value)==null||d.setMaxBounds(s))}),S(()=>e.maxPitch,s=>{var d;s&&((d=a.value)==null||d.setMaxPitch(s))}),S(()=>e.maxZoom,s=>{var d;s&&((d=a.value)==null||d.setMaxZoom(s))}),S(()=>e.minPitch,s=>{var d;s&&((d=a.value)==null||d.setMinPitch(s))}),S(()=>e.minZoom,s=>{var d;s&&((d=a.value)==null||d.setMinZoom(s))}),S(()=>e.pitch,s=>{var d;s&&((d=a.value)==null||d.setPitch(s))}),S(()=>e.renderWorldCopies,s=>{var d;s&&((d=a.value)==null||d.setRenderWorldCopies(s))}),S(()=>e.mapStyle,s=>{var d;s&&((d=a.value)==null||d.setStyle(s))}),S(()=>e.transformRequest,s=>{var d;s&&((d=a.value)==null||d.setTransformRequest(s))}),S(()=>e.zoom,s=>{var d;s&&((d=a.value)==null||d.setZoom(s))}),S(()=>e.zoom,s=>{var d;s&&((d=a.value)==null||d.setZoom(s))});function v(){h.isMounted=!0;const s={...e,style:e.mapStyle,container:r.value};for(const d of Object.keys(s))s[d]===void 0&&delete s[d];if(a.value=tt(new ae.Map(s)),h.map=a.value,l.value=!0,f.set("__load",()=>(b.value=!0,h.isLoaded=!0)),a.value.on("load",f.get("__load")),f.set("__moveend",()=>t.emit("update:center",a.value.getCenter())),a.value.on("moveend",f.get("__moveend")),f.set("__zoomend",()=>t.emit("update:zoom",a.value.getZoom())),a.value.on("zoomend",f.get("__zoomend")),f.set("__pitchend",()=>t.emit("update:pitch",a.value.getPitch())),a.value.on("pitchend",f.get("__pitchend")),f.set("__rotateend",()=>t.emit("update:bearing",a.value.getBearing())),a.value.on("rotateend",f.get("__rotateend")),n.vnode.props){for(const d of On)if(n.vnode.props["onMap:"+d]){const _=`map:${d}`,W=Pn(n,a.value,t,_);f.set(d,W),a.value.on(d,W)}}a.value.getCanvas().addEventListener("webglcontextlost",k)}async function y(){h.isMounted=!1,h.isLoaded=!1,b.value=!1,a.value&&(a.value.getCanvas().removeEventListener("webglcontextlost",k),l.value=!1,f.forEach((s,d)=>{a.value.off(d.startsWith("__")?d.substring(2):d,s)}),a.value.remove())}function k(){y(),ve(v)}return ct(v),le(y),t.expose({map:a}),()=>[g("div",{ref:r,style:{height:e.height,width:e.width}}),l.value&&t.slots.default?t.slots.default({}):void 0]},render(){return null}});function Ln(e,t,n){S(e,r=>{var a,l;r&&ue.indexOf(r)===-1||((a=t.value)!=null&&a.hasControl(n)&&t.value.removeControl(n),(l=t.value)==null||l.addControl(n,r))},{immediate:!0})}function we(e,t){const n=T(se),r=T(mt),a=Ve();return a.value=e(),Ln(()=>t.position,n,a.value),le(()=>{var l;return r.value&&((l=n.value)==null?void 0:l.removeControl(a.value))}),{control:a,map:n}}class Nn{constructor(t,n){P(this,"container");this.isAdded=t,this.container=document.createElement("div"),this.setClasses(n)}getDefaultPosition(){return be.TOP_LEFT}onAdd(){return ve(()=>this.isAdded.value=!0),this.container}onRemove(){this.isAdded.value=!1,this.container.remove()}setClasses(t){this.container.className=t}}const ha=I({name:"MglCustomControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},class:{type:String,default:"maplibregl-ctrl maplibregl-ctrl-group"}},slots:Object,setup(e,{slots:t}){const n=R(!1),{control:r}=we(()=>new Nn(n,e.class),e);return S(()=>e.class,()=>r.value.setClasses(e.class)),()=>{var a;return n.value?g(Xo,{to:r.value.container},(a=t.default)==null?void 0:a.call(t,{})):_e("custom-component")}},render(){return null}}),va=I({name:"MglFullscreenControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},container:{type:Object,default:null}},setup(e){const{control:t,map:n}=we(()=>new ae.FullscreenControl({container:e.container||void 0}),e);function r(){ve(()=>{var a;return(a=n.value)==null?void 0:a.resize()})}t.value.on("fullscreenstart",r),t.value.on("fullscreenend",r),le(()=>{t.value.off("fullscreenstart",r),t.value.off("fullscreenend",r)})},render(){return null}}),ga=I({name:"MglGeolocateControl",props:{position:{type:String,default:be.TOP_RIGHT,validator:e=>ue.indexOf(e)!==-1},positionOptions:{type:Object,default:()=>({enableHighAccuracy:!1,timeout:6e3})},fitBoundsOptions:{type:Object,default:()=>({maxZoom:15})},trackUserLocation:{type:Boolean,default:!1},showAccuracyCircle:{type:Boolean,default:!0},showUserLocation:{type:Boolean,default:!0}},emits:["trackuserlocationstart","trackuserlocationend","userlocationlostfocus","userlocationfocus","geolocate","error","outofmaxbounds"],setup(e,t){const{control:n}=we(()=>new ae.GeolocateControl({positionOptions:e.positionOptions,fitBoundsOptions:e.fitBoundsOptions,trackUserLocation:e.trackUserLocation,showAccuracyCircle:e.showAccuracyCircle,showUserLocation:e.showUserLocation}),e);function r(a){const l=b=>{t.emit(a,b)};n.value.on(a,l),le(()=>{n.value.off(a,l)})}r("trackuserlocationstart"),r("trackuserlocationend"),r("userlocationlostfocus"),r("userlocationfocus"),r("geolocate"),r("error"),r("outofmaxbounds")},render(){return null}}),ya=I({name:"MglNavigationControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},showCompass:{type:Boolean,default:!0},showZoom:{type:Boolean,default:!0},visualizePitch:Boolean},setup(e){we(()=>new ae.NavigationControl({showCompass:e.showCompass,showZoom:e.showZoom,visualizePitch:e.visualizePitch}),e)},render(){return null}});var vt=(e=>(e.IMPERIAL="imperial",e.METRIC="metric",e.NAUTICAL="nautical",e))(vt||{});const jn=Object.values(vt),ba=I({name:"MglScaleControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},maxWidth:{type:Number,default:100},unit:{type:String,default:"metric",validator:e=>jn.indexOf(e)!==-1}},setup(e){we(()=>new ae.ScaleControl({maxWidth:e.maxWidth,unit:e.unit}),e)},render(){return null}});class $n{constructor(){P(this,"unmountHandlers",new Map)}registerUnmountHandler(t,n){this.unmountHandlers.set(t,n)}unregisterUnmountHandler(t){this.unmountHandlers.delete(t)}unmount(){this.unmountHandlers.forEach(t=>t())}}const he=class he{static genSourceOpts(t){const n={...t};for(const r of Object.keys(n))(n[r]===void 0||r==="sourceId")&&delete n[r];return n}static getSourceRef(t,n){const r=typeof n=="string",a=String(t)+(r?n:"");let l=he.REFS.get(a);return l||(l=R(r?null:void 0),he.REFS.set(a,l)),l}};P(he,"REFS",new Map);let ge=he;function Vn(e,t,n){const r=T(se),a=T(ye);function l(){a.value&&(r.value.addSource(t.sourceId,ge.genSourceOpts(t)),e.value=r.value.getSource(t.sourceId))}return S(a,l,{immediate:!0}),r.value.on("style.load",l),le(()=>{a.value&&(n.unmount(),r.value.removeSource(t.sourceId)),r.value.off("style.load",l)})}const wa=I({name:"MglGeoJsonSource",props:{sourceId:{type:String,required:!0},data:{type:[Object,String],required:!0},maxzoom:Number,attribution:String,buffer:Number,tolerance:Number,cluster:Boolean,clusterRadius:Number,clusterMaxZoom:Number,clusterMinPoints:Number,clusterProperties:Object,lineMetrics:Boolean,generateId:Boolean,promoteId:[Object,String],filter:[Array,String,Object]},slots:Object,setup(e,{slots:t}){const n=T(Ge),r=ge.getSourceRef(n,e.sourceId),a=new $n,l={...e,type:"geojson"};return K(Ke,e.sourceId),K(ht,a),Vn(r,l,a),S([Qo(e.data)?e.data:()=>e.data,r],([b,f])=>{f==null||f.setData(b||{type:"FeatureCollection",features:[]})},{immediate:!0}),()=>[_e("GeoJSON Source"),r.value&&t.default?t.default({}):void 0]}}),V=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","touchstart","touchend","touchcancel"];function q(){return{layerId:{type:String,required:!0},source:{type:String},metadata:{type:[Object,Array,String,Number]},sourceLayer:{type:String},minzoom:{type:Number},maxzoom:{type:Number},filter:{type:Object},before:{type:String},layout:{type:Object},paint:{type:Object}}}function Wn(e,t,n,r){const a={id:e,type:t,source:n.source||r,metadata:n.metadata,minzoom:n.minzoom,maxzoom:n.maxzoom,"source-layer":n.sourceLayer,filter:n.filter,paint:n.paint,layout:n.layout};for(const l of Object.keys(a))a[l]===void 0&&delete a[l];return a}function Un(e,t,n){if(n.props)for(const r of V){const a="on"+r.charAt(0).toUpperCase()+r.substr(1);n.props[a]&&e.on(r,t,n.props[a])}}function Hn(e,t,n){if(n.props)for(const r of V){const a="on"+r.charAt(0).toUpperCase()+r.substr(1);n.props[a]&&e.off(r,t,n.props[a])}}function gt(e,t){const n=T(se),r=T(ye),a=T(ht);function l(){r.value&&(t&&Hn(n.value,e,t.vnode),n.value.getLayer(e)&&n.value.removeLayer(e))}a.registerUnmountHandler(e,l),le(()=>{a.unregisterUnmountHandler(e),l()})}I({name:"MglBackgroundLayer",props:{layerId:{type:String,required:!0},metadata:[Object,Array,String,Number],minzoom:Number,maxzoom:Number,before:String,layout:Object,paint:Object},emits:[...V],setup(e){const t=T(se),n=T(ye);return gt(e.layerId),S(()=>e.layout,r=>{if(r)for(const[a,l]of Object.entries(r))t.value.setLayoutProperty(e.layerId,a,l)}),S(()=>e.paint,r=>{if(r)for(const[a,l]of Object.entries(r))t.value.setPaintProperty(e.layerId,a,l)}),S(n,r=>{r&&t.value.addLayer({id:e.layerId,type:"background",metadata:e.metadata,minzoom:e.minzoom,maxzoom:e.maxzoom,layout:e.layout,paint:e.paint},e.before||void 0)},{immediate:!0}),()=>_e("Background Layer")}});function J(e,t){const n=T(Ke);if(!n&&!t.source)return;const r=He(),a=T(se),l=T(ye),b=T(Ge),f=ge.getSourceRef(b,t.source||n);return gt(t.layerId,r),S(()=>t.minzoom,()=>a.value.setLayerZoomRange(t.layerId,t.minzoom||0,t.maxzoom||24)),S(()=>t.maxzoom,()=>a.value.setLayerZoomRange(t.layerId,t.minzoom||0,t.maxzoom||24)),S(()=>t.layout,h=>{if(h)for(const[v,y]of Object.entries(h))a.value.setLayoutProperty(t.layerId,v,y)},{deep:!0}),S(()=>t.paint,h=>{if(h)for(const[v,y]of Object.entries(h))a.value.setPaintProperty(t.layerId,v,y)},{deep:!0}),S(()=>t.filter,h=>a.value.setFilter(t.layerId,h),{deep:!0}),S([l,f],([h,v])=>{h&&(v||v===void 0)&&(a.value.addLayer(Wn(t.layerId,e,t,n),t.before||void 0),Un(a.value,t.layerId,r.vnode))},{immediate:!0}),()=>_e(`${e} Layer`)}I({name:"MglCircleLayer",props:q(),emits:[...V],setup(e){return J("circle",e)}});I({name:"MglFillLayer",props:q(),emits:[...V],setup(e){return J("fill",e)}});I({name:"MglFillExtrusionLayer",props:q(),emits:[...V],setup(e){return J("fill-extrusion",e)}});I({name:"MglHeatmapLayer",props:q(),emits:[...V],setup(e){return J("heatmap",e)}});I({name:"MglHillshadeLayer",props:q(),emits:[...V],setup(e){return J("hillshade",e)}});const xa=I({name:"MglLineLayer",props:q(),emits:[...V],setup(e){return J("line",e)}});I({name:"MglRasterLayer",props:q(),emits:[...V],setup(e){return J("raster",e)}});I({name:"MglSymbolLayer",props:q(),emits:[...V],setup(e){return J("symbol",e)}});const A=[];for(let e=0;e<256;++e)A.push((e+256).toString(16).slice(1));function Gn(e,t=0){return(A[e[t+0]]+A[e[t+1]]+A[e[t+2]]+A[e[t+3]]+"-"+A[e[t+4]]+A[e[t+5]]+"-"+A[e[t+6]]+A[e[t+7]]+"-"+A[e[t+8]]+A[e[t+9]]+"-"+A[e[t+10]]+A[e[t+11]]+A[e[t+12]]+A[e[t+13]]+A[e[t+14]]+A[e[t+15]]).toLowerCase()}let $e;const Kn=new Uint8Array(16);function Zn(){if(!$e){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");$e=crypto.getRandomValues.bind(crypto)}return $e(Kn)}const qn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ut={randomUUID:qn};function ne(e,t,n){var a;if(ut.randomUUID&&!e)return ut.randomUUID();e=e||{};const r=e.random??((a=e.rng)==null?void 0:a.call(e))??Zn();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Gn(r)}function N(){return{name:"Untitled",description:"A new geographic item",creation_timestamp:Date.now(),modification_timestamp:Date.now(),created_by:"anonymous",modified_by:"anonymous",tags:[]}}function Jn(){return{...N(),version:1,signature:void 0}}class oe{constructor(t=ne(),n,r,a){P(this,"id");P(this,"meta");P(this,"routes");P(this,"drafts");this.id=t,this.routes=n||{id:ne(),meta:N(),routes:[]},this.drafts=r||{id:ne(),meta:N(),drafts:[]},this.meta={...Jn(),...a}}toStorage(){return{id:this.id,meta:this.meta,routes:this.routes,drafts:this.drafts}}static fromStorage(t){return new oe(t.id,t.routes,t.drafts,t.meta)}clone(){return oe.fromStorage(this.toStorage())}updateName(t){this.meta.name=t,this.meta.modification_timestamp=Date.now()}updateDescription(t){this.meta.description=t,this.meta.modification_timestamp=Date.now()}addTag(t){this.meta.tags.includes(t)||(this.meta.tags.push(t),this.meta.modification_timestamp=Date.now())}removeTag(t){const n=this.meta.tags.indexOf(t);n>-1&&(this.meta.tags.splice(n,1),this.meta.modification_timestamp=Date.now())}}class yt{constructor(t=[],n=ne(),r=N()){P(this,"id");P(this,"meta");P(this,"routesInternal");this.id=n,this.meta=r||N(),this.routesInternal=t}get name(){return this.meta||(this.meta=N()),this.meta.name}set name(t){this.meta||(this.meta=N()),this.meta.name=t}get routes(){return U(this.routesInternal)}set routes(t){this.routesInternal=U(t)}findRoute(t){return this.routesInternal.find(n=>n.id===t)}existRoute(t){return this.routesInternal.some(n=>n.id===t)}addRoute(t){if(this.existRoute(t.id))throw new Error(`[CartoSketch.Route] Route ${t.id} already exist`);this.routesInternal.push(U(t)),this.updateModificationTime()}updateRoute(t){const n=this.routesInternal.findIndex(r=>r.id===t.id);if(n===-1)throw new Error(`[CartoSketch.Route] Route ${t.id} not found`);this.routesInternal[n]=U(t),this.updateModificationTime()}removeRoute(t){const n=this.routesInternal.findIndex(r=>r.id===t);n!==-1&&(this.routesInternal.splice(n,1),this.updateModificationTime())}updateModificationTime(){this.meta.modification_timestamp=Date.now()}exportAsGeoJSON(){return{type:"FeatureCollection",features:this.routesInternal.map(t=>t.exportAsGeoJSON()),properties:this.meta}}exportToStorage(){return Object.freeze({id:this.id,meta:this.meta,routes:this.routesInternal.map(t=>t.exportToStorage())})}}class Me{constructor(t=ne(),n=[],r={},a=N()){P(this,"id");P(this,"meta");P(this,"properties");P(this,"points");this.id=t,this.meta=a||N(),this.properties=r,this.points=n}get name(){return this.meta||(this.meta=N()),this.meta.name}set name(t){this.meta||(this.meta=N()),this.meta.name=t}setPoints(t){this.points=U(t),this.updateModificationTime()}appendPoint(t){this.points.push(U(t)),this.updateModificationTime()}getPoints(){return U(this.points)}setProperties(t){const n=U(t);Object.assign(this.properties,n),this.updateModificationTime()}updateModificationTime(){this.meta.modification_timestamp=Date.now()}exportAsGeoJSON(){return{type:"Feature",properties:{...this.properties,...this.meta,description:JSON.stringify({name:this.meta.name,id:this.id})},geometry:{type:"LineString",coordinates:this.points.map(t=>[t.longitude,t.latitude])}}}exportToStorage(){return U({id:this.id,meta:this.meta,properties:this.properties,points:this.points})}}function Yn(e){if(!e)throw new Error("[importItemFromStorage] Invalid data provided");const t=new Me(e.id||ne(),e.points||[],e.properties||{},e.meta);return e.meta&&(t.meta=e.meta),t}function Xn(e){if(!e)throw new Error("[readCollectionFromStorage] Invalid data provided");const t=(e.routes||[]).map(r=>Yn(r)),n=new yt(t,e.id||ne(),e.meta);return e.meta&&(n.meta=e.meta),n}const Sa=tn("sketches",()=>{const e=R([]),t=R(null),n=R(null),r=D(()=>{if(!t.value)return null;const c=e.value.find(u=>u.id===t.value);return c?new yt(c.routes.routes.map(u=>new Me(u.id,u.points,u.properties,u.meta)),c.routes.id,c.routes.meta):null}),a=D(()=>r.value?r.value.routes.map(c=>({id:c.id,name:c.name,points:c.getPoints()})):[]),l=D(()=>t.value&&e.value.find(c=>c.id===t.value)||null),b=D(()=>l.value?l.value.drafts.drafts:[]);async function f(){const c=await on("sketches");c?c&&typeof c=="object"&&"routes"in c&&!("sketches"in c)?(console.info("[SketchStore] Migrating old route data to new sketch format"),await h(c)):Array.isArray(c)?(e.value=c.map(u=>oe.fromStorage(u)),!t.value&&e.value.length>0&&(t.value=e.value[0].id)):await v():await v()}async function h(c){try{const u=Xn(c),p=new oe;p.meta.name=u.meta.name||"Migrated Routes",p.routes=u.exportToStorage(),e.value=[p],t.value=p.id,await F("sketches",e.value.map(x=>x.toStorage())),await E(),console.info("[SketchStore] Route migration to sketch format complete")}catch(u){console.error("[SketchStore] Failed to migrate route data:",u),await v()}}async function v(){const c=new oe;c.meta.name="Default Sketch",e.value=[c],t.value=c.id,await F("sketches",e.value.map(u=>u.toStorage())),await E()}async function y(c="New Sketch"){const u=new oe;return u.meta.name=c,e.value.push(u),await F("sketches",e.value.map(p=>p.toStorage())),await E(),u}async function k(c,u){const p=e.value.find(x=>x.id===c);p&&(u.name!==void 0&&p.updateName(u.name),u.description!==void 0&&p.updateDescription(u.description),u.tags!==void 0&&(p.meta.tags.forEach(x=>p.removeTag(x)),u.tags.forEach(x=>p.addTag(x))),await F("sketches",e.value.map(x=>x.toStorage())),await E())}async function s(c){const u=e.value.findIndex(p=>p.id===c);u!==-1&&(e.value.splice(u,1),t.value===c&&(t.value=e.value.length>0?e.value[0].id:null),await F("sketches",e.value.map(p=>p.toStorage())),await E())}function d(c){t.value=c,n.value=null}async function _(c,u={}){l.value||await v();const p=new Me(void 0,[],u);return p.meta.name=c,l.value&&l.value.routes.routes.push(p.exportToStorage()),await F("sketches",e.value.map(x=>x.toStorage())),await E(),p}async function W(c){if(!l.value)return;const u=l.value.routes.routes.findIndex(p=>p.id===c);u!==-1&&(l.value.routes.routes.splice(u,1),n.value===c&&(n.value=null),await F("sketches",e.value.map(p=>p.toStorage())),await E())}async function re(c,u){if(!l.value)return;const p=l.value.routes.routes.find(x=>x.id===c);p&&(p.points.push(u),p.meta.modification_timestamp=Date.now(),await F("sketches",e.value.map(x=>x.toStorage())),await E())}async function Ae(c,u){if(!l.value)return;const p=l.value.routes.routes.find(x=>x.id===c);p&&(u.name!==void 0&&(p.meta.name=u.name),u.properties!==void 0&&(p.properties={...p.properties,...u.properties}),p.meta.modification_timestamp=Date.now(),await F("sketches",e.value.map(x=>x.toStorage())),await E())}async function j(c){if(!l.value)return;const u=l.value.routes.routes.find(p=>p.id===c);u&&(u.points=[],u.meta.modification_timestamp=Date.now(),await F("sketches",e.value.map(p=>p.toStorage())),await E())}function Y(c){if(!l.value)return null;const u=l.value.routes.routes.find(p=>p.id===c);return u?new Me(u.id,u.points,u.properties,u.meta):null}function ce(c){n.value=c}async function H(c,u={},p={}){l.value||await v();const x={id:crypto.randomUUID(),meta:{...N(),...p},shape:c,properties:u};return l.value&&l.value.drafts.drafts.push(x),await F("sketches",e.value.map(Oe=>Oe.toStorage())),await E(),x}async function Te(c,u){if(!l.value)return;const p=l.value.drafts.drafts.find(x=>x.id===c);p&&(u.shape!==void 0&&(p.shape=u.shape),u.properties!==void 0&&(p.properties={...p.properties,...u.properties}),u.meta!==void 0&&(p.meta={...p.meta,...u.meta},p.meta.modification_timestamp=Date.now()),await F("sketches",e.value.map(x=>x.toStorage())),await E())}async function G(c){if(!l.value)return;const u=l.value.drafts.drafts.findIndex(p=>p.id===c);u!==-1&&(l.value.drafts.drafts.splice(u,1),await F("sketches",e.value.map(p=>p.toStorage())),await E())}function X(c){return l.value&&l.value.drafts.drafts.find(u=>u.id===c)||null}return{sketches:e,currentSketchId:t,currentRouteId:n,routeCollection:r,routes:a,currentSketch:l,currentDrafts:b,init:f,createSketch:y,updateSketch:k,deleteSketch:s,setCurrentSketchId:d,addRoute:_,deleteRoute:W,addPointToRoute:re,updateRoute:Ae,clearRoutePoints:j,getRouteById:Y,setCurrentRouteId:ce,addDraft:H,updateDraft:Te,deleteDraft:G,getDraftById:X}});export{ca as A,ba as C,kn as E,ya as L,va as M,da as N,la as R,ha as S,sa as T,ua as U,xa as V,wa as _,fa as a,pa as b,ga as h,Sa as u,ma as y};
