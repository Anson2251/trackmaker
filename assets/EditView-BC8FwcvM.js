var yn=Object.defineProperty;var bn=(r,e,n)=>e in r?yn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n;var P=(r,e,n)=>bn(r,typeof e!="symbol"?e+"":e,n);import{r as se,b as vr,w as Ye,e as Ct,f as wn,S as Jt,i as _n,g as Sn,h as xn,j as Cn,k as kn,l as In,m as Xt,d as oe,n as N,p as V,q,s as O,t as $e,v as we,x as Je,y as ae,z as Xe,N as Rn,A as En,B as zn,C as Qt,D as Zt,E as X,F as $n,G as Ee,H as kt,I as gr,J as Ve,K as bt,L as Dn,T as yr,M as Bn,O as br,P as It,Q as Pn,R as Tn,U as Mn,V as Nn,W as Qe,X as An,Y as On,Z as wt,_ as Ge,$ as Ln,a0 as Fn,a1 as Hn,a2 as qt,a3 as pe,a4 as wr,a5 as Un,a6 as jn,a7 as Wn,a8 as Yn,a9 as Vn,aa as Gn,ab as Kn,ac as er,ad as tr,ae as rr,o as ne,c as le,af as Q,ag as Jn,a as ee,ah as J,ai as Ke,aj as Rt,ak as be,al as Y,am as ze,an as Xn,ao as _t,ap as Qn,aq as _r,ar as Sr,as as _e,at as Zn,au as ue,av as St,aw as qn,ax as gt,ay as eo}from"./index-CJExvjd1.js";import{a as to,b as ro,u as no,B as oo}from"./customized-touchpad-behavior-BHqrTwrU.js";import{b as io,B as Et,c as Ue,g as so}from"./map-manager-CtvxU65A.js";import{i as ao}from"./Element-CMU9-W4S.js";import{u as lo,N as yt}from"./Card-CXjD4QO5.js";const co=new WeakSet;function uo(r){return!co.has(r)}let Ce=0,nr="",or="",ir="",sr="";const ar=se("0px");function fo(r){if(typeof document>"u")return;const e=document.documentElement;let n,c=!1;const f=()=>{e.style.marginRight=nr,e.style.overflow=or,e.style.overflowX=ir,e.style.overflowY=sr,ar.value="0px"};vr(()=>{n=Ye(r,C=>{if(C){if(!Ce){const w=window.innerWidth-e.offsetWidth;w>0&&(nr=e.style.marginRight,e.style.marginRight="".concat(w,"px"),ar.value="".concat(w,"px")),or=e.style.overflow,ir=e.style.overflowX,sr=e.style.overflowY,e.style.overflow="hidden",e.style.overflowX="hidden",e.style.overflowY="hidden"}c=!0,Ce++}else Ce--,Ce||f(),c=!1},{immediate:!0})}),Ct(()=>{n==null||n(),c&&(Ce--,Ce||f(),c=!1)})}const zt=se(!1);function lr(){zt.value=!0}function cr(){zt.value=!1}let Pe=0;function ho(){return ao&&(wn(()=>{Pe||(window.addEventListener("compositionstart",lr),window.addEventListener("compositionend",cr)),Pe++}),Ct(()=>{Pe<=1?(window.removeEventListener("compositionstart",lr),window.removeEventListener("compositionend",cr),Pe=0):Pe--})),zt}function po(r,e,n,c){for(var f=r.length,C=n+-1;++C<f;)if(e(r[C],C,r))return C;return-1}function mo(r){return r!==r}function vo(r,e,n){for(var c=n-1,f=r.length;++c<f;)if(r[c]===e)return c;return-1}function go(r,e,n){return e===e?vo(r,e,n):po(r,mo,n)}function yo(r,e){var n=r==null?0:r.length;return!!n&&go(r,e,0)>-1}var dr=Jt?Jt.isConcatSpreadable:void 0;function bo(r){return _n(r)||Sn(r)||!!(dr&&r&&r[dr])}function wo(r,e,n,c,f){var C=-1,w=r.length;for(n||(n=bo),f||(f=[]);++C<w;){var d=r[C];n(d)&&xn(f,d)}return f}var _o=200;function So(r,e,n,c){var f=-1,C=yo,w=!0,d=r.length,m=[],_=e.length;if(!d)return m;e.length>=_o&&(C=kn,w=!1,e=new Cn(e));e:for(;++f<d;){var I=r[f],h=I;if(I=I!==0?I:0,w&&h===h){for(var x=_;x--;)if(e[x]===h)continue e;m.push(I)}else C(e,h,c)||m.push(I)}return m}var ur=In(function(r,e){return Xt(r)?So(r,wo(e,1,Xt)):[]});const xo=oe({name:"Empty",render(){return N("svg",{viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},N("path",{d:"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z",fill:"currentColor"}),N("path",{d:"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z",fill:"currentColor"}))}}),Co=V("empty","\n display: flex;\n flex-direction: column;\n align-items: center;\n font-size: var(--n-font-size);\n",[q("icon","\n width: var(--n-icon-size);\n height: var(--n-icon-size);\n font-size: var(--n-icon-size);\n line-height: var(--n-icon-size);\n color: var(--n-icon-color);\n transition:\n color .3s var(--n-bezier);\n ",[O("+",[q("description","\n margin-top: 8px;\n ")])]),q("description","\n transition: color .3s var(--n-bezier);\n color: var(--n-text-color);\n "),q("extra","\n text-align: center;\n transition: color .3s var(--n-bezier);\n margin-top: 12px;\n color: var(--n-extra-text-color);\n ")]),ko=Object.assign(Object.assign({},we.props),{description:String,showDescription:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},size:{type:String,default:"medium"},renderIcon:Function}),fr=oe({name:"Empty",props:ko,setup(r){const{mergedClsPrefixRef:e,inlineThemeDisabled:n}=$e(r),c=we("Empty","-empty",Co,En,r,e),{localeRef:f}=lo("Empty"),C=Je(zn,null),w=ae(()=>{var I,h,x;return(I=r.description)!==null&&I!==void 0?I:(x=(h=C==null?void 0:C.mergedComponentPropsRef.value)===null||h===void 0?void 0:h.Empty)===null||x===void 0?void 0:x.description}),d=ae(()=>{var I,h;return((h=(I=C==null?void 0:C.mergedComponentPropsRef.value)===null||I===void 0?void 0:I.Empty)===null||h===void 0?void 0:h.renderIcon)||(()=>N(xo,null))}),m=ae(()=>{const{size:I}=r,{common:{cubicBezierEaseInOut:h},self:{[Qt("iconSize",I)]:x,[Qt("fontSize",I)]:S,textColor:E,iconColor:T,extraTextColor:M}}=c.value;return{"--n-icon-size":x,"--n-font-size":S,"--n-bezier":h,"--n-text-color":E,"--n-icon-color":T,"--n-extra-text-color":M}}),_=n?Xe("empty",ae(()=>{let I="";const{size:h}=r;return I+=h[0],I}),m,r):void 0;return{mergedClsPrefix:e,mergedRenderIcon:d,localizedDescription:ae(()=>w.value||f.value.description),cssVars:n?void 0:m,themeClass:_==null?void 0:_.themeClass,onRender:_==null?void 0:_.onRender}},render(){const{$slots:r,mergedClsPrefix:e,onRender:n}=this;return n==null||n(),N("div",{class:["".concat(e,"-empty"),this.themeClass],style:this.cssVars},this.showIcon?N("div",{class:"".concat(e,"-empty__icon")},r.icon?r.icon():N(Rn,{clsPrefix:e},{default:this.mergedRenderIcon})):null,this.showDescription?N("div",{class:"".concat(e,"-empty__description")},r.default?r.default():this.localizedDescription):null,r.extra?N("div",{class:"".concat(e,"-empty__extra")},r.extra()):null)}}),Z="0!important",xr="-1px!important";function ke(r){return X("".concat(r,"-type"),[O("& +",[V("button",{},[X("".concat(r,"-type"),[q("border",{borderLeftWidth:Z}),q("state-border",{left:xr})])])])])}function Ie(r){return X("".concat(r,"-type"),[O("& +",[V("button",[X("".concat(r,"-type"),[q("border",{borderTopWidth:Z}),q("state-border",{top:xr})])])])])}const Io=V("button-group","\n flex-wrap: nowrap;\n display: inline-flex;\n position: relative;\n",[Zt("vertical",{flexDirection:"row"},[Zt("rtl",[V("button",[O("&:first-child:not(:last-child)","\n margin-right: ".concat(Z,";\n border-top-right-radius: ").concat(Z,";\n border-bottom-right-radius: ").concat(Z,";\n ")),O("&:last-child:not(:first-child)","\n margin-left: ".concat(Z,";\n border-top-left-radius: ").concat(Z,";\n border-bottom-left-radius: ").concat(Z,";\n ")),O("&:not(:first-child):not(:last-child)","\n margin-left: ".concat(Z,";\n margin-right: ").concat(Z,";\n border-radius: ").concat(Z,";\n ")),ke("default"),X("ghost",[ke("primary"),ke("info"),ke("success"),ke("warning"),ke("error")])])])]),X("vertical",{flexDirection:"column"},[V("button",[O("&:first-child:not(:last-child)","\n margin-bottom: ".concat(Z,";\n margin-left: ").concat(Z,";\n margin-right: ").concat(Z,";\n border-bottom-left-radius: ").concat(Z,";\n border-bottom-right-radius: ").concat(Z,";\n ")),O("&:last-child:not(:first-child)","\n margin-top: ".concat(Z,";\n margin-left: ").concat(Z,";\n margin-right: ").concat(Z,";\n border-top-left-radius: ").concat(Z,";\n border-top-right-radius: ").concat(Z,";\n ")),O("&:not(:first-child):not(:last-child)","\n margin: ".concat(Z,";\n border-radius: ").concat(Z,";\n ")),Ie("default"),X("ghost",[Ie("primary"),Ie("info"),Ie("success"),Ie("warning"),Ie("error")])])])]),Ro={size:{type:String,default:void 0},vertical:Boolean},Eo=oe({name:"ButtonGroup",props:Ro,setup(r){const{mergedClsPrefixRef:e,mergedRtlRef:n}=$e(r);return $n("-button-group",Io,e),Ee(io,r),{rtlEnabled:kt("ButtonGroup",n,e),mergedClsPrefix:e}},render(){const{mergedClsPrefix:r}=this;return N("div",{class:["".concat(r,"-button-group"),this.rtlEnabled&&"".concat(r,"-button-group--rtl"),this.vertical&&"".concat(r,"-button-group--vertical")],role:"group"},this.$slots)}}),zo=oe({name:"NDrawerContent",inheritAttrs:!1,props:{blockScroll:Boolean,show:{type:Boolean,default:void 0},displayDirective:{type:String,required:!0},placement:{type:String,required:!0},contentClass:String,contentStyle:[Object,String],nativeScrollbar:{type:Boolean,required:!0},scrollbarProps:Object,trapFocus:{type:Boolean,default:!0},autoFocus:{type:Boolean,default:!0},showMask:{type:[Boolean,String],required:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,onClickoutside:Function,onAfterLeave:Function,onAfterEnter:Function,onEsc:Function},setup(r){const e=se(!!r.show),n=se(null),c=Je(It);let f=0,C="",w=null;const d=se(!1),m=se(!1),_=ae(()=>r.placement==="top"||r.placement==="bottom"),{mergedClsPrefixRef:I,mergedRtlRef:h}=$e(r),x=kt("Drawer",h,I),S=k,E=$=>{m.value=!0,f=_.value?$.clientY:$.clientX,C=document.body.style.cursor,document.body.style.cursor=_.value?"ns-resize":"ew-resize",document.body.addEventListener("mousemove",y),document.body.addEventListener("mouseleave",S),document.body.addEventListener("mouseup",k)},T=()=>{w!==null&&(window.clearTimeout(w),w=null),m.value?d.value=!0:w=window.setTimeout(()=>{d.value=!0},300)},M=()=>{w!==null&&(window.clearTimeout(w),w=null),d.value=!1},{doUpdateHeight:L,doUpdateWidth:A}=c,B=$=>{const{maxWidth:H}=r;if(H&&$>H)return H;const{minWidth:G}=r;return G&&$<G?G:$},U=$=>{const{maxHeight:H}=r;if(H&&$>H)return H;const{minHeight:G}=r;return G&&$<G?G:$};function y($){var H,G;if(m.value)if(_.value){let K=((H=n.value)===null||H===void 0?void 0:H.offsetHeight)||0;const te=f-$.clientY;K+=r.placement==="bottom"?te:-te,K=U(K),L(K),f=$.clientY}else{let K=((G=n.value)===null||G===void 0?void 0:G.offsetWidth)||0;const te=f-$.clientX;K+=r.placement==="right"?te:-te,K=B(K),A(K),f=$.clientX}}function k(){m.value&&(f=0,m.value=!1,document.body.style.cursor=C,document.body.removeEventListener("mousemove",y),document.body.removeEventListener("mouseup",k),document.body.removeEventListener("mouseleave",S))}gr(()=>{r.show&&(e.value=!0)}),Ye(()=>r.show,$=>{$||k()}),Ct(()=>{k()});const R=ae(()=>{const{show:$}=r,H=[[bt,$]];return r.showMask||H.push([Pn,r.onClickoutside,void 0,{capture:!0}]),H});function D(){var $;e.value=!1,($=r.onAfterLeave)===null||$===void 0||$.call(r)}return fo(ae(()=>r.blockScroll&&e.value)),Ee(Tn,n),Ee(Mn,null),Ee(Nn,null),{bodyRef:n,rtlEnabled:x,mergedClsPrefix:c.mergedClsPrefixRef,isMounted:c.isMountedRef,mergedTheme:c.mergedThemeRef,displayed:e,transitionName:ae(()=>({right:"slide-in-from-right-transition",left:"slide-in-from-left-transition",top:"slide-in-from-top-transition",bottom:"slide-in-from-bottom-transition"})[r.placement]),handleAfterLeave:D,bodyDirectives:R,handleMousedownResizeTrigger:E,handleMouseenterResizeTrigger:T,handleMouseleaveResizeTrigger:M,isDragging:m,isHoverOnResizeTrigger:d}},render(){const{$slots:r,mergedClsPrefix:e}=this;return this.displayDirective==="show"||this.displayed||this.show?Ve(N("div",{role:"none"},N(Dn,{disabled:!this.showMask||!this.trapFocus,active:this.show,autoFocus:this.autoFocus,onEsc:this.onEsc},{default:()=>N(yr,{name:this.transitionName,appear:this.isMounted,onAfterEnter:this.onAfterEnter,onAfterLeave:this.handleAfterLeave},{default:()=>Ve(N("div",Bn(this.$attrs,{role:"dialog",ref:"bodyRef","aria-modal":"true",class:["".concat(e,"-drawer"),this.rtlEnabled&&"".concat(e,"-drawer--rtl"),"".concat(e,"-drawer--").concat(this.placement,"-placement"),this.isDragging&&"".concat(e,"-drawer--unselectable"),this.nativeScrollbar&&"".concat(e,"-drawer--native-scrollbar")]}),[this.resizable?N("div",{class:["".concat(e,"-drawer__resize-trigger"),(this.isDragging||this.isHoverOnResizeTrigger)&&"".concat(e,"-drawer__resize-trigger--hover")],onMouseenter:this.handleMouseenterResizeTrigger,onMouseleave:this.handleMouseleaveResizeTrigger,onMousedown:this.handleMousedownResizeTrigger}):null,this.nativeScrollbar?N("div",{class:["".concat(e,"-drawer-content-wrapper"),this.contentClass],style:this.contentStyle,role:"none"},r):N(br,Object.assign({},this.scrollbarProps,{contentStyle:this.contentStyle,contentClass:["".concat(e,"-drawer-content-wrapper"),this.contentClass],theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar}),r)]),this.bodyDirectives)})})),[[bt,this.displayDirective==="if"||this.displayed||this.show]]):null}}),{cubicBezierEaseIn:$o,cubicBezierEaseOut:Do}=Qe;function Bo({duration:r="0.3s",leaveDuration:e="0.2s",name:n="slide-in-from-right"}={}){return[O("&.".concat(n,"-transition-leave-active"),{transition:"transform ".concat(e," ").concat($o)}),O("&.".concat(n,"-transition-enter-active"),{transition:"transform ".concat(r," ").concat(Do)}),O("&.".concat(n,"-transition-enter-to"),{transform:"translateX(0)"}),O("&.".concat(n,"-transition-enter-from"),{transform:"translateX(100%)"}),O("&.".concat(n,"-transition-leave-from"),{transform:"translateX(0)"}),O("&.".concat(n,"-transition-leave-to"),{transform:"translateX(100%)"})]}const{cubicBezierEaseIn:Po,cubicBezierEaseOut:To}=Qe;function Mo({duration:r="0.3s",leaveDuration:e="0.2s",name:n="slide-in-from-left"}={}){return[O("&.".concat(n,"-transition-leave-active"),{transition:"transform ".concat(e," ").concat(Po)}),O("&.".concat(n,"-transition-enter-active"),{transition:"transform ".concat(r," ").concat(To)}),O("&.".concat(n,"-transition-enter-to"),{transform:"translateX(0)"}),O("&.".concat(n,"-transition-enter-from"),{transform:"translateX(-100%)"}),O("&.".concat(n,"-transition-leave-from"),{transform:"translateX(0)"}),O("&.".concat(n,"-transition-leave-to"),{transform:"translateX(-100%)"})]}const{cubicBezierEaseIn:No,cubicBezierEaseOut:Ao}=Qe;function Oo({duration:r="0.3s",leaveDuration:e="0.2s",name:n="slide-in-from-top"}={}){return[O("&.".concat(n,"-transition-leave-active"),{transition:"transform ".concat(e," ").concat(No)}),O("&.".concat(n,"-transition-enter-active"),{transition:"transform ".concat(r," ").concat(Ao)}),O("&.".concat(n,"-transition-enter-to"),{transform:"translateY(0)"}),O("&.".concat(n,"-transition-enter-from"),{transform:"translateY(-100%)"}),O("&.".concat(n,"-transition-leave-from"),{transform:"translateY(0)"}),O("&.".concat(n,"-transition-leave-to"),{transform:"translateY(-100%)"})]}const{cubicBezierEaseIn:Lo,cubicBezierEaseOut:Fo}=Qe;function Ho({duration:r="0.3s",leaveDuration:e="0.2s",name:n="slide-in-from-bottom"}={}){return[O("&.".concat(n,"-transition-leave-active"),{transition:"transform ".concat(e," ").concat(Lo)}),O("&.".concat(n,"-transition-enter-active"),{transition:"transform ".concat(r," ").concat(Fo)}),O("&.".concat(n,"-transition-enter-to"),{transform:"translateY(0)"}),O("&.".concat(n,"-transition-enter-from"),{transform:"translateY(100%)"}),O("&.".concat(n,"-transition-leave-from"),{transform:"translateY(0)"}),O("&.".concat(n,"-transition-leave-to"),{transform:"translateY(100%)"})]}const Uo=O([V("drawer","\n word-break: break-word;\n line-height: var(--n-line-height);\n position: absolute;\n pointer-events: all;\n box-shadow: var(--n-box-shadow);\n transition:\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier);\n background-color: var(--n-color);\n color: var(--n-text-color);\n box-sizing: border-box;\n ",[Bo(),Mo(),Oo(),Ho(),X("unselectable","\n user-select: none; \n -webkit-user-select: none;\n "),X("native-scrollbar",[V("drawer-content-wrapper","\n overflow: auto;\n height: 100%;\n ")]),q("resize-trigger","\n position: absolute;\n background-color: #0000;\n transition: background-color .3s var(--n-bezier);\n ",[X("hover","\n background-color: var(--n-resize-trigger-color-hover);\n ")]),V("drawer-content-wrapper","\n box-sizing: border-box;\n "),V("drawer-content","\n height: 100%;\n display: flex;\n flex-direction: column;\n ",[X("native-scrollbar",[V("drawer-body-content-wrapper","\n height: 100%;\n overflow: auto;\n ")]),V("drawer-body","\n flex: 1 0 0;\n overflow: hidden;\n "),V("drawer-body-content-wrapper","\n box-sizing: border-box;\n padding: var(--n-body-padding);\n "),V("drawer-header","\n font-weight: var(--n-title-font-weight);\n line-height: 1;\n font-size: var(--n-title-font-size);\n color: var(--n-title-text-color);\n padding: var(--n-header-padding);\n transition: border .3s var(--n-bezier);\n border-bottom: 1px solid var(--n-divider-color);\n border-bottom: var(--n-header-border-bottom);\n display: flex;\n justify-content: space-between;\n align-items: center;\n ",[q("close","\n margin-left: 6px;\n transition:\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier);\n ")]),V("drawer-footer","\n display: flex;\n justify-content: flex-end;\n border-top: var(--n-footer-border-top);\n transition: border .3s var(--n-bezier);\n padding: var(--n-footer-padding);\n ")]),X("right-placement","\n top: 0;\n bottom: 0;\n right: 0;\n border-top-left-radius: var(--n-border-radius);\n border-bottom-left-radius: var(--n-border-radius);\n ",[q("resize-trigger","\n width: 3px;\n height: 100%;\n top: 0;\n left: 0;\n transform: translateX(-1.5px);\n cursor: ew-resize;\n ")]),X("left-placement","\n top: 0;\n bottom: 0;\n left: 0;\n border-top-right-radius: var(--n-border-radius);\n border-bottom-right-radius: var(--n-border-radius);\n ",[q("resize-trigger","\n width: 3px;\n height: 100%;\n top: 0;\n right: 0;\n transform: translateX(1.5px);\n cursor: ew-resize;\n ")]),X("top-placement","\n top: 0;\n left: 0;\n right: 0;\n border-bottom-left-radius: var(--n-border-radius);\n border-bottom-right-radius: var(--n-border-radius);\n ",[q("resize-trigger","\n width: 100%;\n height: 3px;\n bottom: 0;\n left: 0;\n transform: translateY(1.5px);\n cursor: ns-resize;\n ")]),X("bottom-placement","\n left: 0;\n bottom: 0;\n right: 0;\n border-top-left-radius: var(--n-border-radius);\n border-top-right-radius: var(--n-border-radius);\n ",[q("resize-trigger","\n width: 100%;\n height: 3px;\n top: 0;\n left: 0;\n transform: translateY(-1.5px);\n cursor: ns-resize;\n ")])]),O("body",[O(">",[V("drawer-container","\n position: fixed;\n ")])]),V("drawer-container","\n position: relative;\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n pointer-events: none;\n ",[O("> *","\n pointer-events: all;\n ")]),V("drawer-mask","\n background-color: rgba(0, 0, 0, .3);\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n ",[X("invisible","\n background-color: rgba(0, 0, 0, 0)\n "),An({enterDuration:"0.2s",leaveDuration:"0.2s",enterCubicBezier:"var(--n-bezier-in)",leaveCubicBezier:"var(--n-bezier-out)"})])]),jo=Object.assign(Object.assign({},we.props),{show:Boolean,width:[Number,String],height:[Number,String],placement:{type:String,default:"right"},maskClosable:{type:Boolean,default:!0},showMask:{type:[Boolean,String],default:!0},to:[String,Object],displayDirective:{type:String,default:"if"},nativeScrollbar:{type:Boolean,default:!0},zIndex:Number,onMaskClick:Function,scrollbarProps:Object,contentClass:String,contentStyle:[Object,String],trapFocus:{type:Boolean,default:!0},onEsc:Function,autoFocus:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!0},maxWidth:Number,maxHeight:Number,minWidth:Number,minHeight:Number,resizable:Boolean,defaultWidth:{type:[Number,String],default:251},defaultHeight:{type:[Number,String],default:251},onUpdateWidth:[Function,Array],onUpdateHeight:[Function,Array],"onUpdate:width":[Function,Array],"onUpdate:height":[Function,Array],"onUpdate:show":[Function,Array],onUpdateShow:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,drawerStyle:[String,Object],drawerClass:String,target:null,onShow:Function,onHide:Function}),Wo=oe({name:"Drawer",inheritAttrs:!1,props:jo,setup(r){const{mergedClsPrefixRef:e,namespaceRef:n,inlineThemeDisabled:c}=$e(r),f=On(),C=we("Drawer","-drawer",Uo,Hn,r,e),w=se(r.defaultWidth),d=se(r.defaultHeight),m=wt(Ge(r,"width"),w),_=wt(Ge(r,"height"),d),I=ae(()=>{const{placement:k}=r;return k==="top"||k==="bottom"?"":qt(m.value)}),h=ae(()=>{const{placement:k}=r;return k==="left"||k==="right"?"":qt(_.value)}),x=k=>{const{onUpdateWidth:R,"onUpdate:width":D}=r;R&&pe(R,k),D&&pe(D,k),w.value=k},S=k=>{const{onUpdateHeight:R,"onUpdate:width":D}=r;R&&pe(R,k),D&&pe(D,k),d.value=k},E=ae(()=>[{width:I.value,height:h.value},r.drawerStyle||""]);function T(k){const{onMaskClick:R,maskClosable:D}=r;D&&B(!1),R&&R(k)}function M(k){T(k)}const L=ho();function A(k){var R;(R=r.onEsc)===null||R===void 0||R.call(r),r.show&&r.closeOnEsc&&uo(k)&&(L.value||B(!1))}function B(k){const{onHide:R,onUpdateShow:D,"onUpdate:show":$}=r;D&&pe(D,k),$&&pe($,k),R&&!k&&pe(R,k)}Ee(It,{isMountedRef:f,mergedThemeRef:C,mergedClsPrefixRef:e,doUpdateShow:B,doUpdateHeight:S,doUpdateWidth:x});const U=ae(()=>{const{common:{cubicBezierEaseInOut:k,cubicBezierEaseIn:R,cubicBezierEaseOut:D},self:{color:$,textColor:H,boxShadow:G,lineHeight:K,headerPadding:te,footerPadding:he,borderRadius:me,bodyPadding:ce,titleFontSize:ve,titleTextColor:Oe,titleFontWeight:Ze,headerBorderBottom:qe,footerBorderTop:fe,closeIconColor:Le,closeIconColorHover:et,closeIconColorPressed:tt,closeColorHover:rt,closeColorPressed:nt,closeIconSize:ot,closeSize:it,closeBorderRadius:st,resizableTriggerColorHover:at}}=C.value;return{"--n-line-height":K,"--n-color":$,"--n-border-radius":me,"--n-text-color":H,"--n-box-shadow":G,"--n-bezier":k,"--n-bezier-out":D,"--n-bezier-in":R,"--n-header-padding":te,"--n-body-padding":ce,"--n-footer-padding":he,"--n-title-text-color":Oe,"--n-title-font-size":ve,"--n-title-font-weight":Ze,"--n-header-border-bottom":qe,"--n-footer-border-top":fe,"--n-close-icon-color":Le,"--n-close-icon-color-hover":et,"--n-close-icon-color-pressed":tt,"--n-close-size":it,"--n-close-color-hover":rt,"--n-close-color-pressed":nt,"--n-close-icon-size":ot,"--n-close-border-radius":st,"--n-resize-trigger-color-hover":at}}),y=c?Xe("drawer",void 0,U,r):void 0;return{mergedClsPrefix:e,namespace:n,mergedBodyStyle:E,handleOutsideClick:M,handleMaskClick:T,handleEsc:A,mergedTheme:C,cssVars:c?void 0:U,themeClass:y==null?void 0:y.themeClass,onRender:y==null?void 0:y.onRender,isMounted:f}},render(){const{mergedClsPrefix:r}=this;return N(Fn,{to:this.to,show:this.show},{default:()=>{var e;return(e=this.onRender)===null||e===void 0||e.call(this),Ve(N("div",{class:["".concat(r,"-drawer-container"),this.namespace,this.themeClass],style:this.cssVars,role:"none"},this.showMask?N(yr,{name:"fade-in-transition",appear:this.isMounted},{default:()=>this.show?N("div",{"aria-hidden":!0,class:["".concat(r,"-drawer-mask"),this.showMask==="transparent"&&"".concat(r,"-drawer-mask--invisible")],onClick:this.handleMaskClick}):null}):null,N(zo,Object.assign({},this.$attrs,{class:[this.drawerClass,this.$attrs.class],style:[this.mergedBodyStyle,this.$attrs.style],blockScroll:this.blockScroll,contentStyle:this.contentStyle,contentClass:this.contentClass,placement:this.placement,scrollbarProps:this.scrollbarProps,show:this.show,displayDirective:this.displayDirective,nativeScrollbar:this.nativeScrollbar,onAfterEnter:this.onAfterEnter,onAfterLeave:this.onAfterLeave,trapFocus:this.trapFocus,autoFocus:this.autoFocus,resizable:this.resizable,maxHeight:this.maxHeight,minHeight:this.minHeight,maxWidth:this.maxWidth,minWidth:this.minWidth,showMask:this.showMask,onEsc:this.handleEsc,onClickoutside:this.handleOutsideClick}),this.$slots)),[[Ln,{zIndex:this.zIndex,enabled:this.show}]])}})}}),Yo={title:String,headerClass:String,headerStyle:[Object,String],footerClass:String,footerStyle:[Object,String],bodyClass:String,bodyStyle:[Object,String],bodyContentClass:String,bodyContentStyle:[Object,String],nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,closable:Boolean},Vo=oe({name:"DrawerContent",props:Yo,setup(){const r=Je(It,null);r||wr("drawer-content","`n-drawer-content` must be placed inside `n-drawer`.");const{doUpdateShow:e}=r;function n(){e(!1)}return{handleCloseClick:n,mergedTheme:r.mergedThemeRef,mergedClsPrefix:r.mergedClsPrefixRef}},render(){const{title:r,mergedClsPrefix:e,nativeScrollbar:n,mergedTheme:c,bodyClass:f,bodyStyle:C,bodyContentClass:w,bodyContentStyle:d,headerClass:m,headerStyle:_,footerClass:I,footerStyle:h,scrollbarProps:x,closable:S,$slots:E}=this;return N("div",{role:"none",class:["".concat(e,"-drawer-content"),n&&"".concat(e,"-drawer-content--native-scrollbar")]},E.header||r||S?N("div",{class:["".concat(e,"-drawer-header"),m],style:_,role:"none"},N("div",{class:"".concat(e,"-drawer-header__main"),role:"heading","aria-level":"1"},E.header!==void 0?E.header():r),S&&N(Un,{onClick:this.handleCloseClick,clsPrefix:e,class:"".concat(e,"-drawer-header__close"),absolute:!0})):null,n?N("div",{class:["".concat(e,"-drawer-body"),f],style:C,role:"none"},N("div",{class:["".concat(e,"-drawer-body-content-wrapper"),w],style:d,role:"none"},E)):N(br,Object.assign({themeOverrides:c.peerOverrides.Scrollbar,theme:c.peers.Scrollbar},x,{class:"".concat(e,"-drawer-body"),contentClass:["".concat(e,"-drawer-body-content-wrapper"),w],contentStyle:d}),E),E.footer?N("div",{class:["".concat(e,"-drawer-footer"),I],style:h,role:"none"},E.footer()):null)}}),Go=O([V("list","\n --n-merged-border-color: var(--n-border-color);\n --n-merged-color: var(--n-color);\n --n-merged-color-hover: var(--n-color-hover);\n margin: 0;\n font-size: var(--n-font-size);\n transition:\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n padding: 0;\n list-style-type: none;\n color: var(--n-text-color);\n background-color: var(--n-merged-color);\n ",[X("show-divider",[V("list-item",[O("&:not(:last-child)",[q("divider","\n background-color: var(--n-merged-border-color);\n ")])])]),X("clickable",[V("list-item","\n cursor: pointer;\n ")]),X("bordered","\n border: 1px solid var(--n-merged-border-color);\n border-radius: var(--n-border-radius);\n "),X("hoverable",[V("list-item","\n border-radius: var(--n-border-radius);\n ",[O("&:hover","\n background-color: var(--n-merged-color-hover);\n ",[q("divider","\n background-color: transparent;\n ")])])]),X("bordered, hoverable",[V("list-item","\n padding: 12px 20px;\n "),q("header, footer","\n padding: 12px 20px;\n ")]),q("header, footer","\n padding: 12px 0;\n box-sizing: border-box;\n transition: border-color .3s var(--n-bezier);\n ",[O("&:not(:last-child)","\n border-bottom: 1px solid var(--n-merged-border-color);\n ")]),V("list-item","\n position: relative;\n padding: 12px 0; \n box-sizing: border-box;\n display: flex;\n flex-wrap: nowrap;\n align-items: center;\n transition:\n background-color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n ",[q("prefix","\n margin-right: 20px;\n flex: 0;\n "),q("suffix","\n margin-left: 20px;\n flex: 0;\n "),q("main","\n flex: 1;\n "),q("divider","\n height: 1px;\n position: absolute;\n bottom: 0;\n left: 0;\n right: 0;\n background-color: transparent;\n transition: background-color .3s var(--n-bezier);\n pointer-events: none;\n ")])]),jn(V("list","\n --n-merged-color-hover: var(--n-color-hover-modal);\n --n-merged-color: var(--n-color-modal);\n --n-merged-border-color: var(--n-border-color-modal);\n ")),Wn(V("list","\n --n-merged-color-hover: var(--n-color-hover-popover);\n --n-merged-color: var(--n-color-popover);\n --n-merged-border-color: var(--n-border-color-popover);\n "))]),Ko=Object.assign(Object.assign({},we.props),{size:{type:String,default:"medium"},bordered:Boolean,clickable:Boolean,hoverable:Boolean,showDivider:{type:Boolean,default:!0}}),Cr=Yn("n-list"),Jo=oe({name:"List",props:Ko,setup(r){const{mergedClsPrefixRef:e,inlineThemeDisabled:n,mergedRtlRef:c}=$e(r),f=kt("List",c,e),C=we("List","-list",Go,Vn,r,e);Ee(Cr,{showDividerRef:Ge(r,"showDivider"),mergedClsPrefixRef:e});const w=ae(()=>{const{common:{cubicBezierEaseInOut:m},self:{fontSize:_,textColor:I,color:h,colorModal:x,colorPopover:S,borderColor:E,borderColorModal:T,borderColorPopover:M,borderRadius:L,colorHover:A,colorHoverModal:B,colorHoverPopover:U}}=C.value;return{"--n-font-size":_,"--n-bezier":m,"--n-text-color":I,"--n-color":h,"--n-border-radius":L,"--n-border-color":E,"--n-border-color-modal":T,"--n-border-color-popover":M,"--n-color-modal":x,"--n-color-popover":S,"--n-color-hover":A,"--n-color-hover-modal":B,"--n-color-hover-popover":U}}),d=n?Xe("list",void 0,w,r):void 0;return{mergedClsPrefix:e,rtlEnabled:f,cssVars:n?void 0:w,themeClass:d==null?void 0:d.themeClass,onRender:d==null?void 0:d.onRender}},render(){var r;const{$slots:e,mergedClsPrefix:n,onRender:c}=this;return c==null||c(),N("ul",{class:["".concat(n,"-list"),this.rtlEnabled&&"".concat(n,"-list--rtl"),this.bordered&&"".concat(n,"-list--bordered"),this.showDivider&&"".concat(n,"-list--show-divider"),this.hoverable&&"".concat(n,"-list--hoverable"),this.clickable&&"".concat(n,"-list--clickable"),this.themeClass],style:this.cssVars},e.header?N("div",{class:"".concat(n,"-list__header")},e.header()):null,(r=e.default)===null||r===void 0?void 0:r.call(e),e.footer?N("div",{class:"".concat(n,"-list__footer")},e.footer()):null)}}),Xo=oe({name:"ListItem",setup(){const r=Je(Cr,null);return r||wr("list-item","`n-list-item` must be placed in `n-list`."),{showDivider:r.showDividerRef,mergedClsPrefix:r.mergedClsPrefixRef}},render(){const{$slots:r,mergedClsPrefix:e}=this;return N("li",{class:"".concat(e,"-list-item")},r.prefix?N("div",{class:"".concat(e,"-list-item__prefix")},r.prefix()):null,r.default?N("div",{class:"".concat(e,"-list-item__main")},r):null,r.suffix?N("div",{class:"".concat(e,"-list-item__suffix")},r.suffix()):null,this.showDivider&&N("div",{class:"".concat(e,"-list-item__divider")}))}});function Qo(r){const{primaryColorHover:e,borderColor:n}=r;return{resizableTriggerColorHover:e,resizableTriggerColor:n}}const Zo={name:"Split",common:Gn,self:Qo},qo=V("split","\n display: flex;\n width: 100%;\n height: 100%;\n",[X("horizontal","\n flex-direction: row;\n "),X("vertical","\n flex-direction: column;\n "),V("split-pane-1","\n overflow: hidden;\n "),V("split-pane-2","\n overflow: hidden;\n flex: 1;\n "),q("resize-trigger","\n background-color: var(--n-resize-trigger-color);\n transition: background-color .3s var(--n-bezier);\n ",[X("hover","\n background-color: var(--n-resize-trigger-color-hover);\n "),O("&:hover","\n background-color: var(--n-resize-trigger-color-hover);\n ")])]),ei=Object.assign(Object.assign({},we.props),{direction:{type:String,default:"horizontal"},resizeTriggerSize:{type:Number,default:3},disabled:Boolean,defaultSize:{type:[String,Number],default:.5},"onUpdate:size":[Function,Array],onUpdateSize:[Function,Array],size:[String,Number],min:{type:[String,Number],default:0},max:{type:[String,Number],default:1},pane1Class:String,pane1Style:[Object,String],pane2Class:String,pane2Style:[Object,String],onDragStart:Function,onDragMove:Function,onDragEnd:Function,watchProps:Array}),hr=oe({name:"Split",props:ei,setup(r){var e;const{mergedClsPrefixRef:n,inlineThemeDisabled:c}=$e(r),f=we("Split","-split",qo,Zo,r,n),C=ae(()=>{const{common:{cubicBezierEaseInOut:B},self:{resizableTriggerColor:U,resizableTriggerColorHover:y}}=f.value;return{"--n-bezier":B,"--n-resize-trigger-color":U,"--n-resize-trigger-color-hover":y}}),w=se(null),d=se(!1),m=Ge(r,"size"),_=se(r.defaultSize);!((e=r.watchProps)===null||e===void 0)&&e.includes("defaultSize")&&gr(()=>_.value=r.defaultSize);const I=B=>{const U=r["onUpdate:size"];r.onUpdateSize&&pe(r.onUpdateSize,B),U&&pe(U,B),_.value=B},h=wt(m,_),x=ae(()=>{const B=h.value;if(typeof B=="string")return{flex:"0 0 ".concat(B)};if(typeof B=="number"){const U=B*100;return{flex:"0 0 calc(".concat(U,"% - ").concat(r.resizeTriggerSize*U/100,"px)")}}}),S=ae(()=>r.direction==="horizontal"?{width:"".concat(r.resizeTriggerSize,"px"),height:"100%"}:{width:"100%",height:"".concat(r.resizeTriggerSize,"px")}),E=ae(()=>{const B=r.direction==="horizontal";return{width:B?"".concat(r.resizeTriggerSize,"px"):"",height:B?"":"".concat(r.resizeTriggerSize,"px"),cursor:r.direction==="horizontal"?"col-resize":"row-resize"}});let T=0;const M=B=>{B.preventDefault(),d.value=!0,r.onDragStart&&r.onDragStart(B);const U="mousemove",y="mouseup",k=$=>{L($),r.onDragMove&&r.onDragMove($)},R=()=>{rr(U,document,k),rr(y,document,R),d.value=!1,r.onDragEnd&&r.onDragEnd(B),document.body.style.cursor=""};document.body.style.cursor=E.value.cursor,er(U,document,k),er(y,document,R);const D=w.value;if(D){const $=D.getBoundingClientRect();r.direction==="horizontal"?T=B.clientX-$.left:T=$.top-B.clientY}L(B)};function L(B){var U,y;const k=(y=(U=w.value)===null||U===void 0?void 0:U.parentElement)===null||y===void 0?void 0:y.getBoundingClientRect();if(!k)return;const{direction:R}=r,D=k.width-r.resizeTriggerSize,$=k.height-r.resizeTriggerSize,H=R==="horizontal"?D:$,G=R==="horizontal"?B.clientX-k.left-T:B.clientY-k.top+T,{min:K,max:te}=r,he=typeof K=="string"?tr(K):K*H,me=typeof te=="string"?tr(te):te*H;let ce=G;ce=Math.max(ce,he),ce=Math.min(ce,me,H),typeof h.value=="string"?I("".concat(ce,"px")):I(ce/H)}const A=c?Xe("split",void 0,C,r):void 0;return{themeClass:A==null?void 0:A.themeClass,onRender:A==null?void 0:A.onRender,cssVars:c?void 0:C,resizeTriggerElRef:w,isDragging:d,mergedClsPrefix:n,resizeTriggerWrapperStyle:E,resizeTriggerStyle:S,handleMouseDown:M,firstPaneStyle:x}},render(){var r,e,n,c,f;return(r=this.onRender)===null||r===void 0||r.call(this),N("div",{class:["".concat(this.mergedClsPrefix,"-split"),"".concat(this.mergedClsPrefix,"-split--").concat(this.direction),this.themeClass],style:this.cssVars},N("div",{class:["".concat(this.mergedClsPrefix,"-split-pane-1"),this.pane1Class],style:[this.firstPaneStyle,this.pane1Style]},(n=(e=this.$slots)[1])===null||n===void 0?void 0:n.call(e)),!this.disabled&&N("div",{ref:"resizeTriggerElRef",class:"".concat(this.mergedClsPrefix,"-split__resize-trigger-wrapper"),style:this.resizeTriggerWrapperStyle,onMousedown:this.handleMouseDown},Kn(this.$slots["resize-trigger"],()=>[N("div",{style:this.resizeTriggerStyle,class:["".concat(this.mergedClsPrefix,"-split__resize-trigger"),this.isDragging&&"".concat(this.mergedClsPrefix,"-split__resize-trigger--hover")]})])),N("div",{class:["".concat(this.mergedClsPrefix,"-split-pane-2"),this.pane2Class],style:this.pane2Style},(f=(c=this.$slots)[2])===null||f===void 0?void 0:f.call(c)))}}),ti={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ri=Q("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),ni=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 176v160"},null,-1),oi=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 256H176"},null,-1),ii=[ri,ni,oi],si=oe({name:"AddCircleOutline",render:function(e,n){return ne(),le("svg",ti,ii)}}),ai={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},li=Q("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),ci=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 320L192 192"},null,-1),di=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M192 320l128-128"},null,-1),ui=[li,ci,di],fi=oe({name:"CloseCircleOutline",render:function(e,n){return ne(),le("svg",ai,ui)}}),hi={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},pi=Q("path",{d:"M408 96H252.11a23.89 23.89 0 0 1-13.31-4L211 73.41A55.77 55.77 0 0 0 179.89 64H104a56.06 56.06 0 0 0-56 56v24h416c0-30.88-25.12-48-56-48z",fill:"currentColor"},null,-1),mi=Q("path",{d:"M423.75 448H88.25a56 56 0 0 1-55.93-55.15L16.18 228.11v-.28A48 48 0 0 1 64 176h384.1a48 48 0 0 1 47.8 51.83v.28l-16.22 164.74A56 56 0 0 1 423.75 448zm56.15-221.45z",fill:"currentColor"},null,-1),vi=[pi,mi],gi=oe({name:"FolderOpen",render:function(e,n){return ne(),le("svg",hi,vi)}}),yi={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},bi=Q("path",{d:"M313.27 124.64L198.73 51.36a32 32 0 0 0-29.28.35L56.51 127.49A16 16 0 0 0 48 141.63v295.8a16 16 0 0 0 23.49 14.14l97.82-63.79a32 32 0 0 1 29.5-.24l111.86 73a32 32 0 0 0 29.27-.11l115.43-75.94a16 16 0 0 0 8.63-14.2V74.57a16 16 0 0 0-23.49-14.14l-98 63.86a32 32 0 0 1-29.24.35z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),wi=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M328 128v336"},null,-1),_i=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M184 48v336"},null,-1),Si=[bi,wi,_i],xi=oe({name:"MapOutline",render:function(e,n){return ne(),le("svg",yi,Si)}}),Ci={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ki=Q("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),Ii=Q("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 256H176"},null,-1),Ri=[ki,Ii],Ei=oe({name:"RemoveCircleOutline",render:function(e,n){return ne(),le("svg",Ci,Ri)}}),zi={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},$i=Q("path",{d:"M465.94 119.76l-73.7-73.7A47.68 47.68 0 0 0 358.3 32H96a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V153.7a47.68 47.68 0 0 0-14.06-33.94zM120 112h176a8 8 0 0 1 8 8v48a8 8 0 0 1-8 8H120a8 8 0 0 1-8-8v-48a8 8 0 0 1 8-8zm139.75 319.91a80 80 0 1 1 76.16-76.16a80.06 80.06 0 0 1-76.16 76.16z",fill:"currentColor"},null,-1),Di=Q("circle",{cx:"256",cy:"352",r:"48",fill:"currentColor"},null,-1),Bi=[$i,Di],Pi=oe({name:"Save",render:function(e,n){return ne(),le("svg",zi,Bi)}}),Ti={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Mi=Q("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32",d:"M336 320H32L184 48l152 272z"},null,-1),Ni=Q("path",{d:"M265.32 194.51A144 144 0 1 1 192 320",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),Ai=[Mi,Ni],Oi=oe({name:"ShapesOutline",render:function(e,n){return ne(),le("svg",Ti,Ai)}});class Li{constructor(e){P(this,"host");P(this,"space");P(this,"id");P(this,"containerID");P(this,"previousScale");P(this,"enable",e=>{const n=document.getElementById(e),c=Number(window.getComputedStyle(n).borderRadius.match(/\d+/g)),f="".concat(e,"-force-hidpi-style-support"),C=document.getElementById(f)||(()=>{const w=document.createElement("style");return w.id=f,document.head.appendChild(w),w})();return C.innerHTML="\n            #".concat(e," > div {\n                transform: scale(").concat(1/window.devicePixelRatio,") !important;\n                transform-origin: top left !important;\n                width: ").concat(window.devicePixelRatio*100,"% !important;\n                height: ").concat(window.devicePixelRatio*100,"% !important;\n            }\n            #").concat(e," * {\n                border-radius: ").concat(window.devicePixelRatio*c,"px !important;\n            }\n        "),f});this.host=e,this.space="liteModeHiDpi",this.containerID=e.container.id,this.previousScale=window.devicePixelRatio}mount(){return this.host.plugins[this.space]=this,this.host.properties.liteModeForceHiDPI&&(this.id=this.enableLiteForceHiDPI()),!0}unmount(){return this.host.plugins[this.space]=null,this.host.properties.liteModeForceHiDPI?this.disableLiteForceHiDPI():!0}onResize(){this.previousScale!==window.devicePixelRatio&&(this.previousScale=window.devicePixelRatio,this.enable(this.containerID))}enableLiteForceHiDPI(){return window.addEventListener("resize",()=>this.onResize()),this.enable(this.containerID)}disableLiteForceHiDPI(){const e="".concat(this.containerID,"-force-hidpi-style-support"),n=document.getElementById(e);if(n)document.head.removeChild(n);else return!1;return window.removeEventListener("resize",()=>this.onResize()),!0}}const Fi=[Jn,to,ro,Li],Hi={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ui=Q("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[Q("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"}),Q("path",{d:"M7 9l5-5l5 5"}),Q("path",{d:"M12 4v12"})],-1),ji=[Ui],Wi=oe({name:"Upload",render:function(e,n){return ne(),le("svg",Hi,ji)}}),Yi={class:"container"},Vi={style:{height:"100%",width:"100%",display:"flex","justify-items":"center"}},Gi=oe({__name:"SketchSelector",props:{list:{type:Array,default:()=>[]}},emits:["select","remove"],setup(r,{emit:e}){const n=r,c=e;function f(w){c("select",w)}function C(w){confirm("Are you sure to delete this CartoSketch?\nBoth Route and Drafts will be deleted")&&c("remove",w)}return(w,d)=>(ne(),le("div",Yi,[ee(Y(Jo),{class:"select-listview",hoverable:""},{default:J(()=>[(ne(!0),le(Ke,null,Rt(n.list,m=>(ne(),be(Y(Xo),{title:m.name,key:m.id,onClick:_=>f(m.id)},{prefix:J(()=>[Q("div",Vi,[ee(Y(ze),{size:"20"},{default:J(()=>[ee(Y(Oi))]),_:1})])]),suffix:J(()=>[ee(Y(Et),{quaternary:"",circle:"",onClick:Xn(_=>C(m.id),["stop"])},{icon:J(()=>[ee(Y(ze),null,{default:J(()=>[ee(Y(Ei))]),_:1})]),_:2},1032,["onClick"])]),default:J(()=>[_t(" "+Qn(m.name),1)]),_:2},1032,["title","onClick"]))),128))]),_:1})]))}}),Ki=_r(Gi,[["__scopeId","data-v-f96e4745"]]),Ji=oe({__name:"SelectorDrawer",props:{active:{type:Boolean,default:()=>!1},placement:{type:String,default:()=>"right"},list:{type:Array,default:()=>[]}},emits:["new","update:active","remove","select","import"],setup(r,{emit:e}){const n=r,c=[{title:"import",icon:Wi,callback:()=>{w("import")},secondary:!0,iconSize:17,type:"default"},{title:"new",icon:si,callback:()=>w("new"),secondary:!0,iconSize:20,type:"default"},{title:"close",icon:fi,callback:()=>{f.value=!1},secondary:!0,iconSize:20,type:"error"}],f=se(!1),C=se(n.placement);Ye(n,()=>{f.value=n.active,C.value=n.placement},{deep:!0}),Ye(f,()=>{w("update:active",f.value)});const w=e;return(d,m)=>(ne(),be(Y(Wo),{show:f.value,"onUpdate:show":m[2]||(m[2]=_=>f.value=_),width:502,placement:C.value,"auto-focus":!1},{default:J(()=>[ee(Y(Vo),{title:"CartoSketch Library"},{footer:J(()=>[ee(Y(Eo),null,{default:J(()=>[(ne(),le(Ke,null,Rt(c,_=>ee(Y(Et),{secondary:_.secondary,key:_.title,type:_.type,title:_.title,onClick:_.callback},{icon:J(()=>[ee(Y(ze),{size:_.iconSize},{default:J(()=>[(ne(),be(Sr(_.icon)))]),_:2},1032,["size"])]),_:2},1032,["secondary","type","title","onClick"])),64))]),_:1})]),default:J(()=>[ee(Ki,{list:r.list,onRemove:m[0]||(m[0]=_=>w("remove",_)),onSelect:m[1]||(m[1]=_=>w("select",_))},null,8,["list"])]),_:1})]),_:1},8,["show","placement"]))}});class Xi{constructor(e){P(this,"history",[]);P(this,"hostMap");P(this,"handlers",[]);P(this,"name");P(this,"id");P(this,"componentLibrary",new Map);P(this,"componentClassification",new Map);P(this,"previousComponentIDs",new Set);P(this,"shownComponentIDs",new Set);this.hostMap=e,this.initialiseBackend().then(()=>{this.executeHandler("ready"),this.startSyncComponents()}).catch(n=>{throw new Error("Fail to initialise drawing backend: ".concat(n))})}startSyncComponents(){this.addHandler("change",()=>{try{this.syncFromMapToBackend(),this.syncFromBackendToMap()}catch(e){console.error("Fail to sync components, reason: \na",e)}})}executeHandler(e){this.handlers.forEach(n=>{n.type===e&&n.handler(this)})}addHandler(e,n){const c=this.handlers.length>0?this.handlers[this.handlers.length-1].id+1:0;this.handlers.push({type:e,id:c,handler:n})}showByID(e,n=!1){this.shownComponentIDs.add(e),n||this.executeHandler("change")}show(e,n=!1){this.showByID(e.id,n)}hideByID(e,n=!1){this.shownComponentIDs.delete(e),n||this.executeHandler("change")}hide(e,n=!1){this.hideByID(e.id,n)}add(e,n="unknown"){this.componentLibrary.set(e.id,e),this.registerPrimitive(e,n)}remove(e,n=!1){try{this.hide(e)}finally{this.componentLibrary.delete(e.id),this.componentClassification.delete(e.id),this.componentLibrary.delete(e.id),n||this.executeHandler("change")}}addHistory(e,n){this.history.push([{type:e,data:n}])}generateShowHideHistory(){const e=pr(this.shownComponentIDs,this.previousComponentIDs),n=pr(this.previousComponentIDs,this.shownComponentIDs),c=[];return e.length>0&&c.push({type:"show",data:e}),n.length>0&&c.push({type:"delete",data:n}),this.previousComponentIDs=_e(this.shownComponentIDs),c}findCorrespondingUndoAction(){let e=1,n=0;for(let c=this.history.length-1;c>=0;c--)if(this.history[c][0].type==="undo"?e+=1:n+=1,e===n)return this.history[c];return[]}findCorrespondingRedoAction(){let e=0,n=1;for(let c=this.history.length-1;c>=0;c--){const f=this.history[c][0].type;if(f==="undo"?e+=1:f==="redo"&&(n+=1),f!=="redo"&&f!=="undo")return[];if(e===n)return this.history[c]}return[]}undo(){if(console.log(this.history),this.history.length>=1){const e=this.findCorrespondingUndoAction();if(e.length===0){console.warn("No action to undo");return}e[0].type!=="redo"?(e.forEach(n=>{n.type==="add"?n.data.forEach(c=>this.hide(c,!0)):n.type==="delete"&&n.data.forEach(c=>this.show(c,!0))}),this.executeHandler("change"),this.addHistory("undo",e)):(e[0].data.forEach(n=>{n.type==="add"?n.data.forEach(c=>this.hide(c,!0)):n.type==="delete"&&n.data.forEach(c=>this.show(c,!0))}),this.executeHandler("change"),this.addHistory("undo",e[0].data))}}redo(){if(this.history.length>=1){const e=this.findCorrespondingRedoAction();if(e.length===0){console.warn("No action to redo");return}e[0].data.forEach(n=>{n.type==="add"?n.data.forEach(c=>this.show(c,!0)):n.type==="delete"&&n.data.forEach(c=>this.hide(c,!0))}),this.executeHandler("change"),this.addHistory("redo",e[0].data)}}editComponent(e){const n=this.componentLibrary.get(e);if(n)this.editPrimitive(n);else throw new Error("No corresponding primitive found by id: ".concat(e))}getComponentMeta(e){return{id:e.id,className:this.componentClassification.get(e.id)||"unknown",name:e.name,type:e.type,properties:e.properties}}registerPrimitive(e,n){this.componentClassification.set(e.id,n||"unknown")}getClassificationInfo(){const e=Array.from(this.componentLibrary).map(c=>c[1]),n=c=>e.filter(f=>this.getComponentMeta(f).className===c).map(f=>this.getComponentMeta(f));return{routes:n("route"),drafts:n("draft"),unknowns:n("unknown")}}getClassifiedProxyComponents(){const e=Array.from(this.componentLibrary).map(n=>n[1]);return{routes:e.filter(n=>this.getComponentMeta(n).className==="route"),drafts:e.filter(n=>this.getComponentMeta(n).className==="draft"),unknowns:e.filter(n=>this.getComponentMeta(n).className==="unknown")}}}function pr(r,e){const n=new Set(e);return Array.from(r).filter(c=>!n.has(c))}class Qi{constructor(e=[]){P(this,"forwardMap",new Map);P(this,"backwardMap",new Map);e.forEach(n=>{this.forwardMap.set(n.key1,n.key2),this.backwardMap.set(n.key2,n.key1)})}getForward(e){return this.forwardMap.get(e)}getBackward(e){return this.backwardMap.get(e)}set(e,n){this.forwardMap.set(e,n),this.backwardMap.set(n,e)}removeForward(e){this.backwardMap.delete(this.getForward(e)),this.forwardMap.delete(e)}removeBackward(e){this.forwardMap.delete(this.getBackward(e)),this.backwardMap.delete(e)}forwardKeys(){return Array.from(this.forwardMap.keys())}backwardKeys(){return Array.from(this.backwardMap.keys())}iterateForward(e){this.forwardMap.forEach((n,c,f)=>e(c,n,f))}iterateBackward(e){this.backwardMap.forEach((n,c,f)=>e(c,n,f))}hasForward(e){return this.forwardMap.has(e)}hasBackward(e){return this.backwardMap.has(e)}}class Zi extends Xi{constructor(){super(...arguments);P(this,"primitiveComponentMap",new Qi);P(this,"previousPrimitiveIDs",[])}syncFromMapToBackend(){const n=this.hostMap.plugins.drawingTools.getAllPrimitiveIDs(),c=ur(n,this.previousPrimitiveIDs),f=ur(this.previousPrimitiveIDs,n);this.previousPrimitiveIDs=n;const C=[];c&&c.forEach(w=>{const d=this.hostMap.plugins.drawingTools.getPrimitiveByID(w),m=Zn(d);this.add(m),this.showByID(m.id,!0),C.push(m.id),this.primitiveComponentMap.set(w,m.id)}),f&&f.forEach(w=>{const d=this.primitiveComponentMap.getForward(w);if(!d)throw new Error("correspondingComponentID ".concat(w," is undefined"));const m=this.componentLibrary.get(d);this.hide(m,!0),this.remove(m),this.primitiveComponentMap.removeForward(w)})}syncFromBackendToMap(){}getShownComponentIDs(){return this.primitiveComponentMap.backwardKeys()}escape(){this.hostMap.plugins.drawingTools.stopDrawing()}initialiseBackend(){return this.hostMap.plugins.drawingTools.initialised?Promise.resolve():new Promise(n=>{this.hostMap.plugins.drawingTools.addHandler("ready",()=>{this.hostMap.plugins.drawingTools.addHandler("drawingChanged",()=>{this.executeHandler("change")}),n()})})}clear(){this.hostMap.plugins.drawingTools.clear()}editPrimitive(n){const c=this.getPrimitiveFromComponent(n);if(c===void 0)throw new Error("Fail to find primitive with id ".concat(n.id));this.hostMap.plugins.drawingTools.edit(c)}getPrimitiveFromComponent(n){const c=this.primitiveComponentMap.getBackward(n.id);if(c!==void 0)return this.hostMap.plugins.drawingTools.getPrimitiveByID(c)}}function je(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kr={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(r,e){(function(n){r.exports=n()})(function(){return function n(c,f,C){function w(_,I){if(!f[_]){if(!c[_]){var h=typeof je=="function"&&je;if(!I&&h)return h(_,!0);if(d)return d(_,!0);var x=new Error("Cannot find module '"+_+"'");throw x.code="MODULE_NOT_FOUND",x}var S=f[_]={exports:{}};c[_][0].call(S.exports,function(E){var T=c[_][1][E];return w(T||E)},S,S.exports,n,c,f,C)}return f[_].exports}for(var d=typeof je=="function"&&je,m=0;m<C.length;m++)w(C[m]);return w}({1:[function(n,c,f){(function(C){var w=C.MutationObserver||C.WebKitMutationObserver,d;if(w){var m=0,_=new w(E),I=C.document.createTextNode("");_.observe(I,{characterData:!0}),d=function(){I.data=m=++m%2}}else if(!C.setImmediate&&typeof C.MessageChannel<"u"){var h=new C.MessageChannel;h.port1.onmessage=E,d=function(){h.port2.postMessage(0)}}else"document"in C&&"onreadystatechange"in C.document.createElement("script")?d=function(){var M=C.document.createElement("script");M.onreadystatechange=function(){E(),M.onreadystatechange=null,M.parentNode.removeChild(M),M=null},C.document.documentElement.appendChild(M)}:d=function(){setTimeout(E,0)};var x,S=[];function E(){x=!0;for(var M,L,A=S.length;A;){for(L=S,S=[],M=-1;++M<A;)L[M]();A=S.length}x=!1}c.exports=T;function T(M){S.push(M)===1&&!x&&d()}}).call(this,typeof Ue<"u"?Ue:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,c,f){var C=n(1);function w(){}var d={},m=["REJECTED"],_=["FULFILLED"],I=["PENDING"];c.exports=h;function h(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,y!==w&&T(this,y)}h.prototype.catch=function(y){return this.then(null,y)},h.prototype.then=function(y,k){if(typeof y!="function"&&this.state===_||typeof k!="function"&&this.state===m)return this;var R=new this.constructor(w);if(this.state!==I){var D=this.state===_?y:k;S(R,D,this.outcome)}else this.queue.push(new x(R,y,k));return R};function x(y,k,R){this.promise=y,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}x.prototype.callFulfilled=function(y){d.resolve(this.promise,y)},x.prototype.otherCallFulfilled=function(y){S(this.promise,this.onFulfilled,y)},x.prototype.callRejected=function(y){d.reject(this.promise,y)},x.prototype.otherCallRejected=function(y){S(this.promise,this.onRejected,y)};function S(y,k,R){C(function(){var D;try{D=k(R)}catch($){return d.reject(y,$)}D===y?d.reject(y,new TypeError("Cannot resolve promise with itself")):d.resolve(y,D)})}d.resolve=function(y,k){var R=M(E,k);if(R.status==="error")return d.reject(y,R.value);var D=R.value;if(D)T(y,D);else{y.state=_,y.outcome=k;for(var $=-1,H=y.queue.length;++$<H;)y.queue[$].callFulfilled(k)}return y},d.reject=function(y,k){y.state=m,y.outcome=k;for(var R=-1,D=y.queue.length;++R<D;)y.queue[R].callRejected(k);return y};function E(y){var k=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof k=="function")return function(){k.apply(y,arguments)}}function T(y,k){var R=!1;function D(K){R||(R=!0,d.reject(y,K))}function $(K){R||(R=!0,d.resolve(y,K))}function H(){k($,D)}var G=M(H);G.status==="error"&&D(G.value)}function M(y,k){var R={};try{R.value=y(k),R.status="success"}catch(D){R.status="error",R.value=D}return R}h.resolve=L;function L(y){return y instanceof this?y:d.resolve(new this(w),y)}h.reject=A;function A(y){var k=new this(w);return d.reject(k,y)}h.all=B;function B(y){var k=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=y.length,D=!1;if(!R)return this.resolve([]);for(var $=new Array(R),H=0,G=-1,K=new this(w);++G<R;)te(y[G],G);return K;function te(he,me){k.resolve(he).then(ce,function(ve){D||(D=!0,d.reject(K,ve))});function ce(ve){$[me]=ve,++H===R&&!D&&(D=!0,d.resolve(K,$))}}}h.race=U;function U(y){var k=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=y.length,D=!1;if(!R)return this.resolve([]);for(var $=-1,H=new this(w);++$<R;)G(y[$]);return H;function G(K){k.resolve(K).then(function(te){D||(D=!0,d.resolve(H,te))},function(te){D||(D=!0,d.reject(H,te))})}}},{1:1}],3:[function(n,c,f){(function(C){typeof C.Promise!="function"&&(C.Promise=n(2))}).call(this,typeof Ue<"u"?Ue:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,c,f){var C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function w(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function d(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch(t){return}}var m=d();function _(){try{if(!m||!m.open)return!1;var t=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),i=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!t||i)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch(o){return!1}}function I(t,i){t=t||[],i=i||{};try{return new Blob(t,i)}catch(s){if(s.name!=="TypeError")throw s;for(var o=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,a=new o,l=0;l<t.length;l+=1)a.append(t[l]);return a.getBlob(i.type)}}typeof Promise>"u"&&n(3);var h=Promise;function x(t,i){i&&t.then(function(o){i(null,o)},function(o){i(o)})}function S(t,i,o){typeof i=="function"&&t.then(i),typeof o=="function"&&t.catch(o)}function E(t){return typeof t!="string"&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function T(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var M="local-forage-detect-blob-support",L=void 0,A={},B=Object.prototype.toString,U="readonly",y="readwrite";function k(t){for(var i=t.length,o=new ArrayBuffer(i),a=new Uint8Array(o),l=0;l<i;l++)a[l]=t.charCodeAt(l);return o}function R(t){return new h(function(i){var o=t.transaction(M,y),a=I([""]);o.objectStore(M).put(a,"key"),o.onabort=function(l){l.preventDefault(),l.stopPropagation(),i(!1)},o.oncomplete=function(){var l=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);i(s||!l||parseInt(l[1],10)>=43)}}).catch(function(){return!1})}function D(t){return typeof L=="boolean"?h.resolve(L):R(t).then(function(i){return L=i,L})}function $(t){var i=A[t.name],o={};o.promise=new h(function(a,l){o.resolve=a,o.reject=l}),i.deferredOperations.push(o),i.dbReady?i.dbReady=i.dbReady.then(function(){return o.promise}):i.dbReady=o.promise}function H(t){var i=A[t.name],o=i.deferredOperations.pop();if(o)return o.resolve(),o.promise}function G(t,i){var o=A[t.name],a=o.deferredOperations.pop();if(a)return a.reject(i),a.promise}function K(t,i){return new h(function(o,a){if(A[t.name]=A[t.name]||Le(),t.db)if(i)$(t),t.db.close();else return o(t.db);var l=[t.name];i&&l.push(t.version);var s=m.open.apply(m,l);i&&(s.onupgradeneeded=function(u){var p=s.result;try{p.createObjectStore(t.storeName),u.oldVersion<=1&&p.createObjectStore(M)}catch(v){if(v.name==="ConstraintError")console.warn('The database "'+t.name+'" has been upgraded from version '+u.oldVersion+" to version "+u.newVersion+', but the storage "'+t.storeName+'" already exists.');else throw v}}),s.onerror=function(u){u.preventDefault(),a(s.error)},s.onsuccess=function(){var u=s.result;u.onversionchange=function(p){p.target.close()},o(u),H(t)}})}function te(t){return K(t,!1)}function he(t){return K(t,!0)}function me(t,i){if(!t.db)return!0;var o=!t.db.objectStoreNames.contains(t.storeName),a=t.version<t.db.version,l=t.version>t.db.version;if(a&&(t.version!==i&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),l||o){if(o){var s=t.db.version+1;s>t.version&&(t.version=s)}return!0}return!1}function ce(t){return new h(function(i,o){var a=new FileReader;a.onerror=o,a.onloadend=function(l){var s=btoa(l.target.result||"");i({__local_forage_encoded_blob:!0,data:s,type:t.type})},a.readAsBinaryString(t)})}function ve(t){var i=k(atob(t.data));return I([i],{type:t.type})}function Oe(t){return t&&t.__local_forage_encoded_blob}function Ze(t){var i=this,o=i._initReady().then(function(){var a=A[i._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return S(o,t,t),o}function qe(t){$(t);for(var i=A[t.name],o=i.forages,a=0;a<o.length;a++){var l=o[a];l._dbInfo.db&&(l._dbInfo.db.close(),l._dbInfo.db=null)}return t.db=null,te(t).then(function(s){return t.db=s,me(t)?he(t):s}).then(function(s){t.db=i.db=s;for(var u=0;u<o.length;u++)o[u]._dbInfo.db=s}).catch(function(s){throw G(t,s),s})}function fe(t,i,o,a){a===void 0&&(a=1);try{var l=t.db.transaction(t.storeName,i);o(null,l)}catch(s){if(a>0&&(!t.db||s.name==="InvalidStateError"||s.name==="NotFoundError"))return h.resolve().then(function(){if(!t.db||s.name==="NotFoundError"&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),he(t)}).then(function(){return qe(t).then(function(){fe(t,i,o,a-1)})}).catch(o);o(s)}}function Le(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function et(t){var i=this,o={db:null};if(t)for(var a in t)o[a]=t[a];var l=A[o.name];l||(l=Le(),A[o.name]=l),l.forages.push(i),i._initReady||(i._initReady=i.ready,i.ready=Ze);var s=[];function u(){return h.resolve()}for(var p=0;p<l.forages.length;p++){var v=l.forages[p];v!==i&&s.push(v._initReady().catch(u))}var g=l.forages.slice(0);return h.all(s).then(function(){return o.db=l.db,te(o)}).then(function(b){return o.db=b,me(o,i._defaultConfig.version)?he(o):b}).then(function(b){o.db=l.db=b,i._dbInfo=o;for(var z=0;z<g.length;z++){var F=g[z];F!==i&&(F._dbInfo.db=o.db,F._dbInfo.version=o.version)}})}function tt(t,i){var o=this;t=E(t);var a=new h(function(l,s){o.ready().then(function(){fe(o._dbInfo,U,function(u,p){if(u)return s(u);try{var v=p.objectStore(o._dbInfo.storeName),g=v.get(t);g.onsuccess=function(){var b=g.result;b===void 0&&(b=null),Oe(b)&&(b=ve(b)),l(b)},g.onerror=function(){s(g.error)}}catch(b){s(b)}})}).catch(s)});return x(a,i),a}function rt(t,i){var o=this,a=new h(function(l,s){o.ready().then(function(){fe(o._dbInfo,U,function(u,p){if(u)return s(u);try{var v=p.objectStore(o._dbInfo.storeName),g=v.openCursor(),b=1;g.onsuccess=function(){var z=g.result;if(z){var F=z.value;Oe(F)&&(F=ve(F));var j=t(F,z.key,b++);j!==void 0?l(j):z.continue()}else l()},g.onerror=function(){s(g.error)}}catch(z){s(z)}})}).catch(s)});return x(a,i),a}function nt(t,i,o){var a=this;t=E(t);var l=new h(function(s,u){var p;a.ready().then(function(){return p=a._dbInfo,B.call(i)==="[object Blob]"?D(p.db).then(function(v){return v?i:ce(i)}):i}).then(function(v){fe(a._dbInfo,y,function(g,b){if(g)return u(g);try{var z=b.objectStore(a._dbInfo.storeName);v===null&&(v=void 0);var F=z.put(v,t);b.oncomplete=function(){v===void 0&&(v=null),s(v)},b.onabort=b.onerror=function(){var j=F.error?F.error:F.transaction.error;u(j)}}catch(j){u(j)}})}).catch(u)});return x(l,o),l}function ot(t,i){var o=this;t=E(t);var a=new h(function(l,s){o.ready().then(function(){fe(o._dbInfo,y,function(u,p){if(u)return s(u);try{var v=p.objectStore(o._dbInfo.storeName),g=v.delete(t);p.oncomplete=function(){l()},p.onerror=function(){s(g.error)},p.onabort=function(){var b=g.error?g.error:g.transaction.error;s(b)}}catch(b){s(b)}})}).catch(s)});return x(a,i),a}function it(t){var i=this,o=new h(function(a,l){i.ready().then(function(){fe(i._dbInfo,y,function(s,u){if(s)return l(s);try{var p=u.objectStore(i._dbInfo.storeName),v=p.clear();u.oncomplete=function(){a()},u.onabort=u.onerror=function(){var g=v.error?v.error:v.transaction.error;l(g)}}catch(g){l(g)}})}).catch(l)});return x(o,t),o}function st(t){var i=this,o=new h(function(a,l){i.ready().then(function(){fe(i._dbInfo,U,function(s,u){if(s)return l(s);try{var p=u.objectStore(i._dbInfo.storeName),v=p.count();v.onsuccess=function(){a(v.result)},v.onerror=function(){l(v.error)}}catch(g){l(g)}})}).catch(l)});return x(o,t),o}function at(t,i){var o=this,a=new h(function(l,s){if(t<0){l(null);return}o.ready().then(function(){fe(o._dbInfo,U,function(u,p){if(u)return s(u);try{var v=p.objectStore(o._dbInfo.storeName),g=!1,b=v.openKeyCursor();b.onsuccess=function(){var z=b.result;if(!z){l(null);return}t===0||g?l(z.key):(g=!0,z.advance(t))},b.onerror=function(){s(b.error)}}catch(z){s(z)}})}).catch(s)});return x(a,i),a}function Er(t){var i=this,o=new h(function(a,l){i.ready().then(function(){fe(i._dbInfo,U,function(s,u){if(s)return l(s);try{var p=u.objectStore(i._dbInfo.storeName),v=p.openKeyCursor(),g=[];v.onsuccess=function(){var b=v.result;if(!b){a(g);return}g.push(b.key),b.continue()},v.onerror=function(){l(v.error)}}catch(b){l(b)}})}).catch(l)});return x(o,t),o}function zr(t,i){i=T.apply(this,arguments);var o=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||o.name,t.storeName=t.storeName||o.storeName);var a=this,l;if(!t.name)l=h.reject("Invalid arguments");else{var s=t.name===o.name&&a._dbInfo.db,u=s?h.resolve(a._dbInfo.db):te(t).then(function(p){var v=A[t.name],g=v.forages;v.db=p;for(var b=0;b<g.length;b++)g[b]._dbInfo.db=p;return p});t.storeName?l=u.then(function(p){if(p.objectStoreNames.contains(t.storeName)){var v=p.version+1;$(t);var g=A[t.name],b=g.forages;p.close();for(var z=0;z<b.length;z++){var F=b[z];F._dbInfo.db=null,F._dbInfo.version=v}var j=new h(function(W,ie){var re=m.open(t.name,v);re.onerror=function(de){var Be=re.result;Be.close(),ie(de)},re.onupgradeneeded=function(){var de=re.result;de.deleteObjectStore(t.storeName)},re.onsuccess=function(){var de=re.result;de.close(),W(de)}});return j.then(function(W){g.db=W;for(var ie=0;ie<b.length;ie++){var re=b[ie];re._dbInfo.db=W,H(re._dbInfo)}}).catch(function(W){throw(G(t,W)||h.resolve()).catch(function(){}),W})}}):l=u.then(function(p){$(t);var v=A[t.name],g=v.forages;p.close();for(var b=0;b<g.length;b++){var z=g[b];z._dbInfo.db=null}var F=new h(function(j,W){var ie=m.deleteDatabase(t.name);ie.onerror=function(){var re=ie.result;re&&re.close(),W(ie.error)},ie.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},ie.onsuccess=function(){var re=ie.result;re&&re.close(),j(re)}});return F.then(function(j){v.db=j;for(var W=0;W<g.length;W++){var ie=g[W];H(ie._dbInfo)}}).catch(function(j){throw(G(t,j)||h.resolve()).catch(function(){}),j})})}return x(l,i),l}var $r={_driver:"asyncStorage",_initStorage:et,_support:_(),iterate:rt,getItem:tt,setItem:nt,removeItem:ot,clear:it,length:st,key:at,keys:Er,dropInstance:zr};function Dr(){return typeof openDatabase=="function"}var ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Br="~~local_forage_type~",$t=/^~~local_forage_type~([^~]+)~/,Fe="__lfsc__:",lt=Fe.length,ct="arbf",dt="blob",Dt="si08",Bt="ui08",Pt="uic8",Tt="si16",Mt="si32",Nt="ur16",At="ui32",Ot="fl32",Lt="fl64",Ft=lt+ct.length,Ht=Object.prototype.toString;function Ut(t){var i=t.length*.75,o=t.length,a,l=0,s,u,p,v;t[t.length-1]==="="&&(i--,t[t.length-2]==="="&&i--);var g=new ArrayBuffer(i),b=new Uint8Array(g);for(a=0;a<o;a+=4)s=ge.indexOf(t[a]),u=ge.indexOf(t[a+1]),p=ge.indexOf(t[a+2]),v=ge.indexOf(t[a+3]),b[l++]=s<<2|u>>4,b[l++]=(u&15)<<4|p>>2,b[l++]=(p&3)<<6|v&63;return g}function ut(t){var i=new Uint8Array(t),o="",a;for(a=0;a<i.length;a+=3)o+=ge[i[a]>>2],o+=ge[(i[a]&3)<<4|i[a+1]>>4],o+=ge[(i[a+1]&15)<<2|i[a+2]>>6],o+=ge[i[a+2]&63];return i.length%3===2?o=o.substring(0,o.length-1)+"=":i.length%3===1&&(o=o.substring(0,o.length-2)+"=="),o}function Pr(t,i){var o="";if(t&&(o=Ht.call(t)),t&&(o==="[object ArrayBuffer]"||t.buffer&&Ht.call(t.buffer)==="[object ArrayBuffer]")){var a,l=Fe;t instanceof ArrayBuffer?(a=t,l+=ct):(a=t.buffer,o==="[object Int8Array]"?l+=Dt:o==="[object Uint8Array]"?l+=Bt:o==="[object Uint8ClampedArray]"?l+=Pt:o==="[object Int16Array]"?l+=Tt:o==="[object Uint16Array]"?l+=Nt:o==="[object Int32Array]"?l+=Mt:o==="[object Uint32Array]"?l+=At:o==="[object Float32Array]"?l+=Ot:o==="[object Float64Array]"?l+=Lt:i(new Error("Failed to get type for BinaryArray"))),i(l+ut(a))}else if(o==="[object Blob]"){var s=new FileReader;s.onload=function(){var u=Br+t.type+"~"+ut(this.result);i(Fe+dt+u)},s.readAsArrayBuffer(t)}else try{i(JSON.stringify(t))}catch(u){console.error("Couldn't convert value into a JSON string: ",t),i(null,u)}}function Tr(t){if(t.substring(0,lt)!==Fe)return JSON.parse(t);var i=t.substring(Ft),o=t.substring(lt,Ft),a;if(o===dt&&$t.test(i)){var l=i.match($t);a=l[1],i=i.substring(l[0].length)}var s=Ut(i);switch(o){case ct:return s;case dt:return I([s],{type:a});case Dt:return new Int8Array(s);case Bt:return new Uint8Array(s);case Pt:return new Uint8ClampedArray(s);case Tt:return new Int16Array(s);case Nt:return new Uint16Array(s);case Mt:return new Int32Array(s);case At:return new Uint32Array(s);case Ot:return new Float32Array(s);case Lt:return new Float64Array(s);default:throw new Error("Unkown type: "+o)}}var ft={serialize:Pr,deserialize:Tr,stringToBuffer:Ut,bufferToString:ut};function jt(t,i,o,a){t.executeSql("CREATE TABLE IF NOT EXISTS "+i.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],o,a)}function Mr(t){var i=this,o={db:null};if(t)for(var a in t)o[a]=typeof t[a]!="string"?t[a].toString():t[a];var l=new h(function(s,u){try{o.db=openDatabase(o.name,String(o.version),o.description,o.size)}catch(p){return u(p)}o.db.transaction(function(p){jt(p,o,function(){i._dbInfo=o,s()},function(v,g){u(g)})},u)});return o.serializer=ft,l}function ye(t,i,o,a,l,s){t.executeSql(o,a,l,function(u,p){p.code===p.SYNTAX_ERR?u.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[i.storeName],function(v,g){g.rows.length?s(v,p):jt(v,i,function(){v.executeSql(o,a,l,s)},s)},s):s(u,p)},s)}function Nr(t,i){var o=this;t=E(t);var a=new h(function(l,s){o.ready().then(function(){var u=o._dbInfo;u.db.transaction(function(p){ye(p,u,"SELECT * FROM "+u.storeName+" WHERE key = ? LIMIT 1",[t],function(v,g){var b=g.rows.length?g.rows.item(0).value:null;b&&(b=u.serializer.deserialize(b)),l(b)},function(v,g){s(g)})})}).catch(s)});return x(a,i),a}function Ar(t,i){var o=this,a=new h(function(l,s){o.ready().then(function(){var u=o._dbInfo;u.db.transaction(function(p){ye(p,u,"SELECT * FROM "+u.storeName,[],function(v,g){for(var b=g.rows,z=b.length,F=0;F<z;F++){var j=b.item(F),W=j.value;if(W&&(W=u.serializer.deserialize(W)),W=t(W,j.key,F+1),W!==void 0){l(W);return}}l()},function(v,g){s(g)})})}).catch(s)});return x(a,i),a}function Wt(t,i,o,a){var l=this;t=E(t);var s=new h(function(u,p){l.ready().then(function(){i===void 0&&(i=null);var v=i,g=l._dbInfo;g.serializer.serialize(i,function(b,z){z?p(z):g.db.transaction(function(F){ye(F,g,"INSERT OR REPLACE INTO "+g.storeName+" (key, value) VALUES (?, ?)",[t,b],function(){u(v)},function(j,W){p(W)})},function(F){if(F.code===F.QUOTA_ERR){if(a>0){u(Wt.apply(l,[t,v,o,a-1]));return}p(F)}})})}).catch(p)});return x(s,o),s}function Or(t,i,o){return Wt.apply(this,[t,i,o,1])}function Lr(t,i){var o=this;t=E(t);var a=new h(function(l,s){o.ready().then(function(){var u=o._dbInfo;u.db.transaction(function(p){ye(p,u,"DELETE FROM "+u.storeName+" WHERE key = ?",[t],function(){l()},function(v,g){s(g)})})}).catch(s)});return x(a,i),a}function Fr(t){var i=this,o=new h(function(a,l){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(u){ye(u,s,"DELETE FROM "+s.storeName,[],function(){a()},function(p,v){l(v)})})}).catch(l)});return x(o,t),o}function Hr(t){var i=this,o=new h(function(a,l){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(u){ye(u,s,"SELECT COUNT(key) as c FROM "+s.storeName,[],function(p,v){var g=v.rows.item(0).c;a(g)},function(p,v){l(v)})})}).catch(l)});return x(o,t),o}function Ur(t,i){var o=this,a=new h(function(l,s){o.ready().then(function(){var u=o._dbInfo;u.db.transaction(function(p){ye(p,u,"SELECT key FROM "+u.storeName+" WHERE id = ? LIMIT 1",[t+1],function(v,g){var b=g.rows.length?g.rows.item(0).key:null;l(b)},function(v,g){s(g)})})}).catch(s)});return x(a,i),a}function jr(t){var i=this,o=new h(function(a,l){i.ready().then(function(){var s=i._dbInfo;s.db.transaction(function(u){ye(u,s,"SELECT key FROM "+s.storeName,[],function(p,v){for(var g=[],b=0;b<v.rows.length;b++)g.push(v.rows.item(b).key);a(g)},function(p,v){l(v)})})}).catch(l)});return x(o,t),o}function Wr(t){return new h(function(i,o){t.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(l,s){for(var u=[],p=0;p<s.rows.length;p++)u.push(s.rows.item(p).name);i({db:t,storeNames:u})},function(l,s){o(s)})},function(a){o(a)})})}function Yr(t,i){i=T.apply(this,arguments);var o=this.config();t=typeof t!="function"&&t||{},t.name||(t.name=t.name||o.name,t.storeName=t.storeName||o.storeName);var a=this,l;return t.name?l=new h(function(s){var u;t.name===o.name?u=a._dbInfo.db:u=openDatabase(t.name,"","",0),t.storeName?s({db:u,storeNames:[t.storeName]}):s(Wr(u))}).then(function(s){return new h(function(u,p){s.db.transaction(function(v){function g(j){return new h(function(W,ie){v.executeSql("DROP TABLE IF EXISTS "+j,[],function(){W()},function(re,de){ie(de)})})}for(var b=[],z=0,F=s.storeNames.length;z<F;z++)b.push(g(s.storeNames[z]));h.all(b).then(function(){u()}).catch(function(j){p(j)})},function(v){p(v)})})}):l=h.reject("Invalid arguments"),x(l,i),l}var Vr={_driver:"webSQLStorage",_initStorage:Mr,_support:Dr(),iterate:Ar,getItem:Nr,setItem:Or,removeItem:Lr,clear:Fr,length:Hr,key:Ur,keys:jr,dropInstance:Yr};function Gr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Yt(t,i){var o=t.name+"/";return t.storeName!==i.storeName&&(o+=t.storeName+"/"),o}function Kr(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(i){return!0}}function Jr(){return!Kr()||localStorage.length>0}function Xr(t){var i=this,o={};if(t)for(var a in t)o[a]=t[a];return o.keyPrefix=Yt(t,i._defaultConfig),Jr()?(i._dbInfo=o,o.serializer=ft,h.resolve()):h.reject()}function Qr(t){var i=this,o=i.ready().then(function(){for(var a=i._dbInfo.keyPrefix,l=localStorage.length-1;l>=0;l--){var s=localStorage.key(l);s.indexOf(a)===0&&localStorage.removeItem(s)}});return x(o,t),o}function Zr(t,i){var o=this;t=E(t);var a=o.ready().then(function(){var l=o._dbInfo,s=localStorage.getItem(l.keyPrefix+t);return s&&(s=l.serializer.deserialize(s)),s});return x(a,i),a}function qr(t,i){var o=this,a=o.ready().then(function(){for(var l=o._dbInfo,s=l.keyPrefix,u=s.length,p=localStorage.length,v=1,g=0;g<p;g++){var b=localStorage.key(g);if(b.indexOf(s)===0){var z=localStorage.getItem(b);if(z&&(z=l.serializer.deserialize(z)),z=t(z,b.substring(u),v++),z!==void 0)return z}}});return x(a,i),a}function en(t,i){var o=this,a=o.ready().then(function(){var l=o._dbInfo,s;try{s=localStorage.key(t)}catch(u){s=null}return s&&(s=s.substring(l.keyPrefix.length)),s});return x(a,i),a}function tn(t){var i=this,o=i.ready().then(function(){for(var a=i._dbInfo,l=localStorage.length,s=[],u=0;u<l;u++){var p=localStorage.key(u);p.indexOf(a.keyPrefix)===0&&s.push(p.substring(a.keyPrefix.length))}return s});return x(o,t),o}function rn(t){var i=this,o=i.keys().then(function(a){return a.length});return x(o,t),o}function nn(t,i){var o=this;t=E(t);var a=o.ready().then(function(){var l=o._dbInfo;localStorage.removeItem(l.keyPrefix+t)});return x(a,i),a}function on(t,i,o){var a=this;t=E(t);var l=a.ready().then(function(){i===void 0&&(i=null);var s=i;return new h(function(u,p){var v=a._dbInfo;v.serializer.serialize(i,function(g,b){if(b)p(b);else try{localStorage.setItem(v.keyPrefix+t,g),u(s)}catch(z){(z.name==="QuotaExceededError"||z.name==="NS_ERROR_DOM_QUOTA_REACHED")&&p(z),p(z)}})})});return x(l,o),l}function sn(t,i){if(i=T.apply(this,arguments),t=typeof t!="function"&&t||{},!t.name){var o=this.config();t.name=t.name||o.name,t.storeName=t.storeName||o.storeName}var a=this,l;return t.name?l=new h(function(s){t.storeName?s(Yt(t,a._defaultConfig)):s(t.name+"/")}).then(function(s){for(var u=localStorage.length-1;u>=0;u--){var p=localStorage.key(u);p.indexOf(s)===0&&localStorage.removeItem(p)}}):l=h.reject("Invalid arguments"),x(l,i),l}var an={_driver:"localStorageWrapper",_initStorage:Xr,_support:Gr(),iterate:qr,getItem:Zr,setItem:on,removeItem:nn,clear:Qr,length:rn,key:en,keys:tn,dropInstance:sn},ln=function(i,o){return i===o||typeof i=="number"&&typeof o=="number"&&isNaN(i)&&isNaN(o)},cn=function(i,o){for(var a=i.length,l=0;l<a;){if(ln(i[l],o))return!0;l++}return!1},Vt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},De={},Gt={},xe={INDEXEDDB:$r,WEBSQL:Vr,LOCALSTORAGE:an},dn=[xe.INDEXEDDB._driver,xe.WEBSQL._driver,xe.LOCALSTORAGE._driver],He=["dropInstance"],ht=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(He),un={description:"",driver:dn.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function fn(t,i){t[i]=function(){var o=arguments;return t.ready().then(function(){return t[i].apply(t,o)})}}function pt(){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i)for(var o in i)i.hasOwnProperty(o)&&(Vt(i[o])?arguments[0][o]=i[o].slice():arguments[0][o]=i[o])}return arguments[0]}var hn=function(){function t(i){w(this,t);for(var o in xe)if(xe.hasOwnProperty(o)){var a=xe[o],l=a._driver;this[o]=l,De[l]||this.defineDriver(a)}this._defaultConfig=pt({},un),this._config=pt({},this._defaultConfig,i),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(o){if((typeof o>"u"?"undefined":C(o))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in o){if(a==="storeName"&&(o[a]=o[a].replace(/\W/g,"_")),a==="version"&&typeof o[a]!="number")return new Error("Database version must be a number.");this._config[a]=o[a]}return"driver"in o&&o.driver?this.setDriver(this._config.driver):!0}else return typeof o=="string"?this._config[o]:this._config},t.prototype.defineDriver=function(o,a,l){var s=new h(function(u,p){try{var v=o._driver,g=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!o._driver){p(g);return}for(var b=ht.concat("_initStorage"),z=0,F=b.length;z<F;z++){var j=b[z],W=!cn(He,j);if((W||o[j])&&typeof o[j]!="function"){p(g);return}}var ie=function(){for(var Be=function(vn){return function(){var gn=new Error("Method "+vn+" is not implemented by the current driver"),Kt=h.reject(gn);return x(Kt,arguments[arguments.length-1]),Kt}},mt=0,mn=He.length;mt<mn;mt++){var vt=He[mt];o[vt]||(o[vt]=Be(vt))}};ie();var re=function(Be){De[v]&&console.info("Redefining LocalForage driver: "+v),De[v]=o,Gt[v]=Be,u()};"_support"in o?o._support&&typeof o._support=="function"?o._support().then(re,p):re(!!o._support):re(!0)}catch(de){p(de)}});return S(s,a,l),s},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(o,a,l){var s=De[o]?h.resolve(De[o]):h.reject(new Error("Driver not found."));return S(s,a,l),s},t.prototype.getSerializer=function(o){var a=h.resolve(ft);return S(a,o),a},t.prototype.ready=function(o){var a=this,l=a._driverSet.then(function(){return a._ready===null&&(a._ready=a._initDriver()),a._ready});return S(l,o,o),l},t.prototype.setDriver=function(o,a,l){var s=this;Vt(o)||(o=[o]);var u=this._getSupportedDrivers(o);function p(){s._config.driver=s.driver()}function v(z){return s._extend(z),p(),s._ready=s._initStorage(s._config),s._ready}function g(z){return function(){var F=0;function j(){for(;F<z.length;){var W=z[F];return F++,s._dbInfo=null,s._ready=null,s.getDriver(W).then(v).catch(j)}p();var ie=new Error("No available storage method found.");return s._driverSet=h.reject(ie),s._driverSet}return j()}}var b=this._driverSet!==null?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=b.then(function(){var z=u[0];return s._dbInfo=null,s._ready=null,s.getDriver(z).then(function(F){s._driver=F._driver,p(),s._wrapLibraryMethodsWithReady(),s._initDriver=g(u)})}).catch(function(){p();var z=new Error("No available storage method found.");return s._driverSet=h.reject(z),s._driverSet}),S(this._driverSet,a,l),this._driverSet},t.prototype.supports=function(o){return!!Gt[o]},t.prototype._extend=function(o){pt(this,o)},t.prototype._getSupportedDrivers=function(o){for(var a=[],l=0,s=o.length;l<s;l++){var u=o[l];this.supports(u)&&a.push(u)}return a},t.prototype._wrapLibraryMethodsWithReady=function(){for(var o=0,a=ht.length;o<a;o++)fn(this,ht[o])},t.prototype.createInstance=function(o){return new t(o)},t}(),pn=new hn;c.exports=pn},{3:3}]},{},[4])(4)})})(kr);var qi=kr.exports;const es=so(qi);class Me{constructor(e,n=[],c=ue()){P(this,"id");P(this,"name");P(this,"routes");this.id=c,this.name=e,this.routes=n}getRoutes(){return Object.freeze(this.routes)}getRoute(e){return this.routes.find(n=>n.id===e)}addRoute(e){this.routes.push(e)}exportAsGeoJSON(){return{type:"FeatureCollection",features:this.routes.map(e=>e.exportAsGeoJSON())}}exportToStorage(){return{id:this.id,name:this.name,routes:this.routes.map(e=>e.exportToStorage())}}}(r=>{function e(d,m=[],_=ue()){return new r(d,m,_)}r.create=e;function n(d,m=ue(),_=[],I={}){return new Te(d,m,_,I)}r.createItem=n;function c(d,m,_=ue()){if(d.feature)throw new Error("Multiple features should be contained");m=m||_;const I=d.features.map((h,x)=>f(h,"".concat(m,"-").concat(x)));return new r(m,I,_)}r.importFromGeoJSON=c;function f(d,m,_){if(d.features)throw new Error("[importItemFromGeoJSON] Only one feature is supported");const I=d.properties,h=d.geometry.type,x=d.geometry.coordinates;if(h!=="LineString")throw new Error("[importItemFromGeoJSON] Unsupported geometry type for routes ".concat(h));return _=_||ue(),m=m||_,new Te(m,_,x.map(S=>({latitude:S[1],longitude:S[0]})),I)}r.importItemFromGeoJSON=f;function C(d){return new Te(d.name,d.id,d.points,d.properties)}r.importItemFromStorage=C;function w(d){return new r(d.name,d.routes.map(m=>C(m)),d.id)}r.readFromStorage=w})(Me||(Me={}));class Te{constructor(e,n=ue(),c=[],f={}){P(this,"name");P(this,"id");P(this,"properties");P(this,"points");this.name=e,this.id=n,this.properties=f,this.points=c}setPoints(e){this.points=_e(e)}appendPoint(e){this.points.push(_e(e))}getPoints(){return Object.freeze(this.points)}setProperties(e){const n=_e(e);Object.assign(this.properties,n)}exportAsGeoJSON(){return{type:"Feature",properties:Object.assign({},this.properties,{name:this.name,id:this.id}),geometry:{type:"LineString",coordinates:this.points.map(e=>[e.longitude,e.latitude])}}}exportAsBingMapsPrimitive(){return new Microsoft.Maps.Polyline(this.points.map(e=>new Microsoft.Maps.Location(e.latitude,e.longitude)),this.properties)}exportToStorage(){return{name:this.name,id:this.id,properties:this.properties,points:this.points}}}const Ir=Me,ts=Object.freeze(Object.defineProperty({__proto__:null,get CartoSketchRoute(){return Me},CartoSketchRouteItem:Te,default:Ir},Symbol.toStringTag,{value:"Module"})),rs=["Polygon","LineString","Point"];class Ne{constructor(e,n=[],c=ue()){P(this,"id");P(this,"name");P(this,"drafts");this.id=c,this.name=e,this.drafts=n}getDrafts(){return Object.freeze(this.drafts)}getDraft(e){return this.drafts.find(n=>n.id===e)}addDraft(e){this.drafts.push(e)}exportAsGeoJSON(){return{type:"FeatureCollection",features:this.drafts.map(e=>e.exportAsGeoJSON())}}exportToStorage(){return{id:this.id,name:this.name,drafts:this.drafts.map(e=>e.exportToStorage())}}}(r=>{function e(d,m=[],_=ue()){return new r(d,m,_)}r.create=e;function n(d,m=ue(),_,I={}){return new Se(d,_,m,I)}r.createItem=n;function c(d,m,_){if(Array.isArray(d.features))throw new Error("[createDraftItemFromGeoJSON] Only one feature is supported");const I=d.geometry.type,h=Array.isArray(d.geometry.coordinates[0])?d.geometry.coordinates:[d.geometry.coordinates],x=d.properties.title;if(!(I in rs))throw new Error("Invalid or unsupported geometry type ".concat(I," in feature ").concat(x));if(!h)throw new Error("No coordinates provided in feature ".concat(x));if(!x)throw new Error("No title provided");const S={title:x,subTitle:d.properties.subTitle||"",label:d.properties.label||"",fillColor:d.properties.fillColor||"",strokeColor:d.properties.strokeColor||"",strokeThickness:d.properties.strokeThickness||1,icon:d.properties.icon||"",visible:d.properties.visible||!0},E={type:I,coordinates:h};return new Se(m||x,E,_,S)}r.importItemFromGeoJSON=c;function f(d,m,_=ue()){if(d.feature)throw new Error("[importFromGeoJSON] Multiple features should be contained");const I=d.features.map((h,x)=>c(h,"".concat(m,"-").concat(x),void 0));return new r(_,I,_)}r.importFromGeoJSON=f;function C(d){return new Se(d.name,d.shape,d.id,d.properties)}r.readItemFromStorage=C;function w(d){return new r(d.name,d.drafts.map(m=>r.readItemFromStorage(m)),d.id)}r.readFromStorage=w})(Ne||(Ne={}));class Se{constructor(e,n,c=ue(),f={}){P(this,"name");P(this,"id");P(this,"shape");P(this,"properties");this.name=e,this.id=c,this.shape=n,this.properties=f}setShapes(e){this.shape=e}getShapes(){return Object.freeze(this.shape)}setProperties(e){const n=_e(e);Object.assign(this.properties,n)}exportAsGeoJSON(){return{type:"Feature",properties:Object.assign({},this.properties,{name:this.name,id:this.id}),geometry:this.shape}}exportToStorage(){return{name:this.name,id:this.id,properties:this.properties,shape:this.shape}}}const Rr=Ne,ns=Object.freeze(Object.defineProperty({__proto__:null,get CartoSketchDraft(){return Ne},CartoSketchDraftItem:Se,default:Rr},Symbol.toStringTag,{value:"Module"}));class Ae{constructor(e,n=ue(),c,f){P(this,"id");P(this,"name");P(this,"routes");P(this,"drafts");this.name=e,this.id=n,this.routes=c||new Ir(e,[],n),this.drafts=f||new Rr(e,[],n)}exportToStorage(){return{id:this.id,name:this.name,routes:this.routes.exportToStorage(),drafts:this.drafts.exportToStorage()}}exportAsGeoJSON(){const e=this.routes.exportAsGeoJSON().features,n=this.drafts.exportAsGeoJSON().features;return{type:"FeatureCollection",features:[...e,...n]}}async save(){await Ae.write(this)}}(r=>{r.storageSpace="cartosketch_storage",r.storage=es.createInstance({name:r.storageSpace}),r.Routes=ts,r.Drafts=ns;async function e(S){try{return Promise.resolve(!!await r.storage.getItem(S))}catch(E){return Promise.reject(E)}}r.exist=e;async function n(){const S=[];for(const E of await f()){const T=await I(E);T?S.push({name:T.name,id:T.id}):console.error("CartoSketch ".concat(E," cannot be read, ignore"))}return Promise.resolve(S)}r.getInfoList=n;function c(S){return new r(S.name,S.id,r.Routes.CartoSketchRoute.readFromStorage(S.routes),r.Drafts.CartoSketchDraft.readFromStorage(S.drafts))}r.readFromStorage=c;async function f(){return await r.storage.keys()}r.getIDList=f;async function C(){const S=[];for(const E of await f())S.push(await m(E));return Promise.resolve(S)}r.getList=C;async function w(){const S=[];for(const E of await f()){const T=await I(E);T&&S.push(T)}return Promise.resolve(S)}r.getListRaw=w;async function d(S){return new Promise((E,T)=>{e(S).then(async M=>{M?await x(S).then(()=>E()).catch(L=>T("Fail to remove the CartoSketch with id: ".concat(S,". Reason: ").concat(L))):T("The CartoSketch with id: "+S+" cannot be found and will not be removed")}).catch(M=>{T("Fail to identify the existence of the CartoSketch with id: ".concat(S,". Reason: ").concat(M,". It will not be removed"))})})}r.remove=d;async function m(S){if(!await e(S))return Promise.reject("The CartoSketch with id: "+S+" not found");const E=await I(S);return E?Promise.resolve(c(E)):Promise.reject("The CartoSketch with id: "+S+" is empty. It cannot be read")}r.read=m;async function _(S){await h(S.id,S.exportToStorage())}r.write=_;async function I(S){return new Promise((E,T)=>{r.storage.getItem(S).then(M=>E(M!==null?M:void 0)).catch(M=>T(M))})}r.readRaw=I;function h(S,E){return new Promise((T,M)=>{r.storage.setItem(S,E).then(()=>T()).catch(L=>M(L))})}r.writeRaw=h;function x(S){return new Promise((E,T)=>{r.storage.removeItem(S).then(()=>E()).catch(M=>T(M))})}r.deleteRaw=x})(Ae||(Ae={}));const Re=Ae;function os(r){const e=r.getShapes();switch(e.type){case"Point":{const n={latitude:e.coordinates[0][1],longitude:e.coordinates[0][0]},c=Object.assign({},{draggable:!1,icon:"",label:"",title:r.name||"",subTitle:"",visible:!0},r.properties);return new qn([n],c,r.id,r.name)}case"LineString":{const n=e.coordinates.map(f=>({longitude:f[0],latitude:f[1]})),c=Object.assign({},{strokeColor:"#000000",strokeThickness:1,visible:!0},r.properties);return new St(n,c,r.id,r.name)}case"Polygon":{const n=e.coordinates.map(f=>({longitude:f[0],latitude:f[1]})),c=Object.assign({},{fillColor:"#2d9cec",strokeColor:"#000000",strokeThickness:1,visible:!0},r.properties);return new St(n,c,r.id,r.name)}default:throw new Error("Unknown GeoJSON type: ".concat(e.type))}}function is(r){return r.getDrafts().map(e=>os(e))}function ss(r){const e=Object.assign({},{strokeColor:"#000000",strokeThickness:1,visible:!0},r.properties),n=r.getPoints().map(c=>({latitude:c.latitude,longitude:c.longitude}));return new St(n,e,r.id,r.name)}function as(r){return r.getRoutes().map(e=>ss(e))}function ls(r){return{routes:as(r.routes),drafts:is(r.drafts)}}function cs(r){const e=_e(r.getProperties()),n={type:r.type,coordinates:r.coordinates.map(c=>[c.longitude,c.latitude])};switch(r.type){case"Polygon":return new Se(r.name,n,r.id,e);case"LineString":return new Se(r.name,n,r.id,e);case"Point":return new Se(r.name,n,r.id,e);default:throw new Error("Unknown component type: ".concat(r.type))}}function ds(r,e,n){const c=r.map(f=>cs(f));return new Ne(n,c,e)}function us(r){const e=r.getLocations().map(c=>({latitude:c.latitude,longitude:c.longitude})),n=_e(r.getProperties());return new Te(r.name,r.id,e,n)}function fs(r,e,n){return new Me(n,r.map(c=>us(c)),e)}function hs(r,e,n,c){const f=fs(r,n,c),C=ds(e,n,c);return new Re(c,n,f,C)}var xt;(r=>{r.ua=new no.UAParser(navigator.userAgent),r.isMobile=r.ua.getDevice().type==="mobile",r.isTablet=r.ua.getDevice().type==="tablet",r.isUnknown=r.ua.getDevice().type==="",r.browser=r.ua.getBrowser().name||"",r.engine=r.ua.getEngine().name||"",r.os=r.ua.getOS().name||""})(xt||(xt={}));const ps=xt,We=ps.os==="Mac OS";class ms{constructor(e){P(this,"handlers",[]);P(this,"backend");P(this,"isBackendReady",!1);P(this,"initialised",!1);P(this,"sketchID");P(this,"sketchName");P(this,"shortcutMounted",!1);this.backend=e,this.backend&&this.backendReady()}setBackend(e){this.backend=e,this.isBackendReady=!1,this.backendReady()}backendReady(){this.backend&&this.backend.addHandler("ready",()=>{this.isBackendReady=!0,this.initialiseAdapter()})}checkBackendReady(){return this.isBackendReady||console.warn("SketchEditAdapter: Backend is not ready"),this.isBackendReady}initialiseAdapter(){this.mountKeyShortcuts(),this.initialised=!0}redo(){this.checkBackendReady()&&(console.log("redo"),this.backend.redo())}undo(){this.checkBackendReady()&&(console.log("undo"),this.backend.undo())}escape(){this.checkBackendReady()&&this.backend.escape()}edit(e){this.checkBackendReady()&&this.backend.editComponent(e)}clear(){this.checkBackendReady()&&(console.log("clear"),this.backend.clear())}mountKeyShortcuts(){this.checkBackendReady()&&(this.shortcutMounted||(this.shortcutMounted=!0,document.addEventListener("keyup",e=>{console.log(e.key,e.ctrlKey,e.metaKey,e.shiftKey);const n=e.key==="z"&&!e.shiftKey&&(e.ctrlKey&&!We||e.metaKey&&We),c=e.key==="z"&&e.shiftKey&&(e.ctrlKey&&!We||e.metaKey&&We);n&&this.undo(),c&&this.redo(),e.key==="Escape"&&this.escape()})))}executeHandler(e){this.handlers.forEach(n=>{n.type===e&&n.handler()})}addHandler(e,n){const c=this.handlers.length>0?this.handlers[this.handlers.length-1].id+1:0;this.handlers.push({type:e,id:c,handler:n})}removeHandler(e){this.handlers=this.handlers.filter(n=>n.id!==e)}async load(e){if(!this.checkBackendReady())return;const n=await Re.read(e);if(!n)return Promise.reject("Cannot load sketch ".concat(e));if(console.log(n,this),this.sketchID=n.id,this.sketchName=n.name,!this.initialised){console.warn("Cannot import from sketch, adapter not initialised");return}const c=ls(n);c.routes.forEach(f=>{this.backend.add(f,"route")}),c.drafts.forEach(f=>{this.backend.add(f,"draft")}),this.executeHandler("change")}async save(){if(!this.checkBackendReady())return;if(!this.initialised){console.warn("Cannot export to sketch, adapter not initialised");return}if(!this.sketchID||!this.sketchName)return Promise.reject("Cannot export to sketch, sketch ID or name not set. It seems the sketch has not been loaded yet");const e=this.backend.getClassifiedProxyComponents();await hs(e.routes,e.drafts,this.sketchID,this.sketchName).save()}}const vs={class:"edit-layout"},gs=["onClick","title"],mr=20,ys=oe({__name:"SketchEdit",props:{liteMode:{type:Boolean},forceHighDpi:{type:Boolean},mapType:{}},setup(r){const e=r,n=new ms,c=se([]);let f=se(!1);const C=se(Microsoft.Maps.MapTypeId.road),w=se(!1),d=se("right"),m={open:()=>w.value=!0,close:()=>w.value=!1},_=se(Fi),I=[{title:"save",icon:Pi,iconSize:mr,callback:n.save.bind(n)},{title:"Open",icon:gi,iconSize:mr,callback:m.open}];function h(L){console.log(L);const A=new Zi(L);n.setBackend(A),window.adapter=n,f.value=!0}async function x(){const L=prompt("Enter the name of the new CartoSketch");L&&(await Re.write(new Re(L)),S())}function S(){Re.getInfoList().then(L=>{c.value=L})}async function E(L){await Re.remove(L),S()}async function T(L){await n.load(L),console.log("selected sketch, id:",L),m.close()}function M(L){alert(L)}return vr(()=>{S()}),(L,A)=>(ne(),le(Ke,null,[ee(Ji,{list:c.value,active:w.value,"onUpdate:active":A[0]||(A[0]=B=>w.value=B),placement:d.value,onNew:x,onRemove:E,onSelect:T,onActiveStateSync:A[1]||(A[1]=B=>{w.value=B}),onImport:A[2]||(A[2]=B=>M("Not implemented"))},null,8,["list","active","placement"]),ee(Y(hr),{direction:"horizontal",max:.8,min:.4,"default-size":.7},{1:J(()=>[ee(Y(yt),{class:"map-container","content-style":"padding: 0"},{default:J(()=>[Ve(ee(oo,{"map-type":C.value,plugin:_.value,"lite-mode":e.liteMode,forceHiDPI:e.forceHighDpi,onReady:h},null,8,["map-type","plugin","lite-mode","forceHiDPI"]),[[bt,Y(f)]]),Y(f)?gt("",!0):(ne(),be(Y(fr),{key:0,description:"Map",size:"huge",style:{height:"100%","justify-content":"center"}},{icon:J(()=>[ee(Y(ze),null,{default:J(()=>[ee(Y(xi))]),_:1})]),_:1}))]),_:1})]),2:J(()=>[Q("div",vs,[ee(Y(yt),{"content-class":"route-edit-tool-tip"},{default:J(()=>[(ne(),le(Ke,null,Rt(I,(B,U)=>Q("div",{key:U,onClick:B.callback,title:B.title,class:"tool-tip-item"},[ee(Y(ze),{size:B.iconSize},{default:J(()=>[(ne(),be(Sr(B.icon)))]),_:2},1032,["size"])],8,gs)),64))]),_:1}),ee(Y(yt),{class:"draft-container"},eo({default:J(()=>[Y(f)?(ne(),be(Y(hr),{key:0,direction:"vertical",max:.8,min:.3,"default-size":.7},{1:J(()=>[]),2:J(()=>[]),_:1})):gt("",!0),Y(f)?gt("",!0):(ne(),be(Y(fr),{key:1,description:"No sketch selected",style:{height:"100%","justify-content":"center"}},{icon:J(()=>[ee(Y(ze))]),extra:J(()=>[ee(Y(Et),{size:"small",onClick:A[3]||(A[3]=B=>m.open())},{default:J(()=>[_t("Select a sketch")]),_:1})]),_:1}))]),_:2},[Y(f)?{name:"header",fn:J(()=>[_t(" Components ")]),key:"0"}:void 0]),1024)])]),_:1})],64))}}),bs=_r(ys,[["__scopeId","data-v-f1c86884"]]),Rs=oe({__name:"EditView",setup(r){return(e,n)=>(ne(),be(bs,{"lite-mode":!0,"force-high-dpi":!1}))}});export{Rs as default};
