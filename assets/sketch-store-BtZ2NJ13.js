var Zo=Object.defineProperty;var qo=(e,t,n)=>t in e?Zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var O=(e,t,n)=>qo(e,typeof t!="symbol"?t+"":t,n);import{d as R,c as _e,o as Ae,a as $,L as Jo,h as g,b as I,s as S,i as T,g as D,F as Yo,t as Xe,k as ct,a2 as He,w as et,p as Z,J as ve,m as tt,H as We,f as le,y as Te,T as Qo,a4 as Xo,j as en,a5 as H,M as tn,Z as on,$ as P,a0 as E}from"./index-Dif3EidE.js";import{o as nn,x as B,y as w,z as V,G as me,v as N,aH as rn,Q as Ie,P as Le,az as an,V as ln,F as ot,A as sn,C as dt,ad as un,I as cn,u as nt,B as dn,D as Ve,R as pn,E as fn,U as rt,K as F,a0 as at,Z as pt}from"./Card-BAEXTjt4.js";import{i as mn,x as hn,k as vn,n as gn}from"./text-BhbrJ6Ra.js";import{N as it,a as yn}from"./Suffix-lA-KlE_x.js";import{u as bn}from"./use-locale-wwiFD7AO.js";import{u as wn}from"./create-Dd47qeh4.js";import{m as re}from"./index-BLEJe1aX.js";const xn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},sr=R({name:"DeviceFloppy",render:function(t,n){return Ae(),_e("svg",xn,n[0]||(n[0]=[$("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[$("path",{d:"M6 4h10l4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2"}),$("circle",{cx:"12",cy:"14",r:"2"}),$("path",{d:"M14 4v4H8V4"})],-1)]))}}),Sn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ur=R({name:"Route",render:function(t,n){return Ae(),_e("svg",Sn,n[0]||(n[0]=[$("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[$("circle",{cx:"6",cy:"19",r:"2"}),$("circle",{cx:"18",cy:"5",r:"2"}),$("path",{d:"M12 19h4.5a3.5 3.5 0 0 0 0-7h-8a3.5 3.5 0 0 1 0-7H12"})],-1)]))}}),Cn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},cr=R({name:"Trash",render:function(t,n){return Ae(),_e("svg",Cn,n[0]||(n[0]=[Jo('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 7h16"></path><path d="M10 11v6"></path><path d="M14 11v6"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2l1-12"></path><path d="M9 7V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3"></path></g>',1)]))}}),kn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},dr=R({name:"Upload",render:function(t,n){return Ae(),_e("svg",kn,n[0]||(n[0]=[$("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[$("path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"}),$("path",{d:"M7 9l5-5l5 5"}),$("path",{d:"M12 4v12"})],-1)]))}}),pr=R({name:"Add",render(){return g("svg",{width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g("path",{d:"M256 112V400M400 256H112",stroke:"currentColor","stroke-width":"32","stroke-linecap":"round","stroke-linejoin":"round"}))}}),zn=R({name:"Eye",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),g("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),Rn=R({name:"EyeOff",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},g("path",{d:"M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z",fill:"currentColor"}),g("path",{d:"M255.66 384c-41.49 0-81.5-12.28-118.92-36.5c-34.07-22-64.74-53.51-88.7-91v-.08c19.94-28.57 41.78-52.73 65.24-72.21a2 2 0 0 0 .14-2.94L93.5 161.38a2 2 0 0 0-2.71-.12c-24.92 21-48.05 46.76-69.08 76.92a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416a239.13 239.13 0 0 0 75.8-12.58a2 2 0 0 0 .77-3.31l-21.58-21.58a4 4 0 0 0-3.83-1a204.8 204.8 0 0 1-51.16 6.47z",fill:"currentColor"}),g("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96a227.34 227.34 0 0 0-74.89 12.83a2 2 0 0 0-.75 3.31l21.55 21.55a4 4 0 0 0 3.88 1a192.82 192.82 0 0 1 50.21-6.69c40.69 0 80.58 12.43 118.55 37c34.71 22.4 65.74 53.88 89.76 91a.13.13 0 0 1 0 .16a310.72 310.72 0 0 1-64.12 72.73a2 2 0 0 0-.15 2.95l19.9 19.89a2 2 0 0 0 2.7.13a343.49 343.49 0 0 0 68.64-78.48a32.2 32.2 0 0 0-.1-34.78z",fill:"currentColor"}),g("path",{d:"M256 160a95.88 95.88 0 0 0-21.37 2.4a2 2 0 0 0-1 3.38l112.59 112.56a2 2 0 0 0 3.38-1A96 96 0 0 0 256 160z",fill:"currentColor"}),g("path",{d:"M165.78 233.66a2 2 0 0 0-3.38 1a96 96 0 0 0 115 115a2 2 0 0 0 1-3.38z",fill:"currentColor"}))}}),ft=nn("n-input"),In=B("input",`
 max-width: 100%;
 cursor: text;
 line-height: 1.5;
 z-index: auto;
 outline: none;
 box-sizing: border-box;
 position: relative;
 display: inline-flex;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color .3s var(--n-bezier);
 font-size: var(--n-font-size);
 font-weight: var(--n-font-weight);
 --n-padding-vertical: calc((var(--n-height) - 1.5 * var(--n-font-size)) / 2);
`,[w("input, textarea",`
 overflow: hidden;
 flex-grow: 1;
 position: relative;
 `),w("input-el, textarea-el, input-mirror, textarea-mirror, separator, placeholder",`
 box-sizing: border-box;
 font-size: inherit;
 line-height: 1.5;
 font-family: inherit;
 border: none;
 outline: none;
 background-color: #0000;
 text-align: inherit;
 transition:
 -webkit-text-fill-color .3s var(--n-bezier),
 caret-color .3s var(--n-bezier),
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier);
 `),w("input-el, textarea-el",`
 -webkit-appearance: none;
 scrollbar-width: none;
 width: 100%;
 min-width: 0;
 text-decoration-color: var(--n-text-decoration-color);
 color: var(--n-text-color);
 caret-color: var(--n-caret-color);
 background-color: transparent;
 `,[N("&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb",`
 width: 0;
 height: 0;
 display: none;
 `),N("&::placeholder",`
 color: #0000;
 -webkit-text-fill-color: transparent !important;
 `),N("&:-webkit-autofill ~",[w("placeholder","display: none;")])]),V("round",[me("textarea","border-radius: calc(var(--n-height) / 2);")]),w("placeholder",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 overflow: hidden;
 color: var(--n-placeholder-color);
 `,[N("span",`
 width: 100%;
 display: inline-block;
 `)]),V("textarea",[w("placeholder","overflow: visible;")]),me("autosize","width: 100%;"),V("autosize",[w("textarea-el, input-el",`
 position: absolute;
 top: 0;
 left: 0;
 height: 100%;
 `)]),B("input-wrapper",`
 overflow: hidden;
 display: inline-flex;
 flex-grow: 1;
 position: relative;
 padding-left: var(--n-padding-left);
 padding-right: var(--n-padding-right);
 `),w("input-mirror",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre;
 pointer-events: none;
 `),w("input-el",`
 padding: 0;
 height: var(--n-height);
 line-height: var(--n-height);
 `,[N("&[type=password]::-ms-reveal","display: none;"),N("+",[w("placeholder",`
 display: flex;
 align-items: center; 
 `)])]),me("textarea",[w("placeholder","white-space: nowrap;")]),w("eye",`
 display: flex;
 align-items: center;
 justify-content: center;
 transition: color .3s var(--n-bezier);
 `),V("textarea","width: 100%;",[B("input-word-count",`
 position: absolute;
 right: var(--n-padding-right);
 bottom: var(--n-padding-vertical);
 `),V("resizable",[B("input-wrapper",`
 resize: vertical;
 min-height: var(--n-height);
 `)]),w("textarea-el, textarea-mirror, placeholder",`
 height: 100%;
 padding-left: 0;
 padding-right: 0;
 padding-top: var(--n-padding-vertical);
 padding-bottom: var(--n-padding-vertical);
 word-break: break-word;
 display: inline-block;
 vertical-align: bottom;
 box-sizing: border-box;
 line-height: var(--n-line-height-textarea);
 margin: 0;
 resize: none;
 white-space: pre-wrap;
 scroll-padding-block-end: var(--n-padding-vertical);
 `),w("textarea-mirror",`
 width: 100%;
 pointer-events: none;
 overflow: hidden;
 visibility: hidden;
 position: static;
 white-space: pre-wrap;
 overflow-wrap: break-word;
 `)]),V("pair",[w("input-el, placeholder","text-align: center;"),w("separator",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 white-space: nowrap;
 `,[B("icon",`
 color: var(--n-icon-color);
 `),B("base-icon",`
 color: var(--n-icon-color);
 `)])]),V("disabled",`
 cursor: not-allowed;
 background-color: var(--n-color-disabled);
 `,[w("border","border: var(--n-border-disabled);"),w("input-el, textarea-el",`
 cursor: not-allowed;
 color: var(--n-text-color-disabled);
 text-decoration-color: var(--n-text-color-disabled);
 `),w("placeholder","color: var(--n-placeholder-color-disabled);"),w("separator","color: var(--n-text-color-disabled);",[B("icon",`
 color: var(--n-icon-color-disabled);
 `),B("base-icon",`
 color: var(--n-icon-color-disabled);
 `)]),B("input-word-count",`
 color: var(--n-count-text-color-disabled);
 `),w("suffix, prefix","color: var(--n-text-color-disabled);",[B("icon",`
 color: var(--n-icon-color-disabled);
 `),B("internal-icon",`
 color: var(--n-icon-color-disabled);
 `)])]),me("disabled",[w("eye",`
 color: var(--n-icon-color);
 cursor: pointer;
 `,[N("&:hover",`
 color: var(--n-icon-color-hover);
 `),N("&:active",`
 color: var(--n-icon-color-pressed);
 `)]),N("&:hover",[w("state-border","border: var(--n-border-hover);")]),V("focus","background-color: var(--n-color-focus);",[w("state-border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),w("border, state-border",`
 box-sizing: border-box;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 pointer-events: none;
 border-radius: inherit;
 border: var(--n-border);
 transition:
 box-shadow .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `),w("state-border",`
 border-color: #0000;
 z-index: 1;
 `),w("prefix","margin-right: 4px;"),w("suffix",`
 margin-left: 4px;
 `),w("suffix, prefix",`
 transition: color .3s var(--n-bezier);
 flex-wrap: nowrap;
 flex-shrink: 0;
 line-height: var(--n-height);
 white-space: nowrap;
 display: inline-flex;
 align-items: center;
 justify-content: center;
 color: var(--n-suffix-text-color);
 `,[B("base-loading",`
 font-size: var(--n-icon-size);
 margin: 0 2px;
 color: var(--n-loading-color);
 `),B("base-clear",`
 font-size: var(--n-icon-size);
 `,[w("placeholder",[B("base-icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)])]),N(">",[B("icon",`
 transition: color .3s var(--n-bezier);
 color: var(--n-icon-color);
 font-size: var(--n-icon-size);
 `)]),B("base-icon",`
 font-size: var(--n-icon-size);
 `)]),B("input-word-count",`
 pointer-events: none;
 line-height: 1.5;
 font-size: .85em;
 color: var(--n-count-text-color);
 transition: color .3s var(--n-bezier);
 margin-left: 4px;
 font-variant: tabular-nums;
 `),["warning","error"].map(e=>V(`${e}-status`,[me("disabled",[B("base-loading",`
 color: var(--n-loading-color-${e})
 `),w("input-el, textarea-el",`
 caret-color: var(--n-caret-color-${e});
 `),w("state-border",`
 border: var(--n-border-${e});
 `),N("&:hover",[w("state-border",`
 border: var(--n-border-hover-${e});
 `)]),N("&:focus",`
 background-color: var(--n-color-focus-${e});
 `,[w("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)]),V("focus",`
 background-color: var(--n-color-focus-${e});
 `,[w("state-border",`
 box-shadow: var(--n-box-shadow-focus-${e});
 border: var(--n-border-focus-${e});
 `)])])]))]),Mn=B("input",[V("disabled",[w("input-el, textarea-el",`
 -webkit-text-fill-color: var(--n-text-color-disabled);
 `)])]);function Bn(e){let t=0;for(const n of e)t++;return t}function Me(e){return e===""||e==null}function _n(e){const t=I(null);function n(){const{value:l}=e;if(!(l!=null&&l.focus)){r();return}const{selectionStart:b,selectionEnd:f,value:h}=l;if(b==null||f==null){r();return}t.value={start:b,end:f,beforeText:h.slice(0,b),afterText:h.slice(f)}}function a(){var l;const{value:b}=t,{value:f}=e;if(!b||!f)return;const{value:h}=f,{start:v,beforeText:y,afterText:k}=b;let s=h.length;if(h.endsWith(k))s=h.length-k.length;else if(h.startsWith(y))s=y.length;else{const d=y[v-1],_=h.indexOf(d,v-1);_!==-1&&(s=_+1)}(l=f.setSelectionRange)===null||l===void 0||l.call(f,s,s)}function r(){t.value=null}return S(e,r),{recordCursor:n,restoreCursor:a}}const lt=R({name:"InputWordCount",setup(e,{slots:t}){const{mergedValueRef:n,maxlengthRef:a,mergedClsPrefixRef:r,countGraphemesRef:l}=T(ft),b=D(()=>{const{value:f}=n;return f===null||Array.isArray(f)?0:(l.value||Bn)(f)});return()=>{const{value:f}=a,{value:h}=n;return g("span",{class:`${r.value}-input-word-count`},rn(t.default,{value:h===null||Array.isArray(h)?"":h},()=>[f===void 0?b.value:`${b.value} / ${f}`]))}}}),An=Object.assign(Object.assign({},dt.props),{bordered:{type:Boolean,default:void 0},type:{type:String,default:"text"},placeholder:[Array,String],defaultValue:{type:[String,Array],default:null},value:[String,Array],disabled:{type:Boolean,default:void 0},size:String,rows:{type:[Number,String],default:3},round:Boolean,minlength:[String,Number],maxlength:[String,Number],clearable:Boolean,autosize:{type:[Boolean,Object],default:!1},pair:Boolean,separator:String,readonly:{type:[String,Boolean],default:!1},passivelyActivated:Boolean,showPasswordOn:String,stateful:{type:Boolean,default:!0},autofocus:Boolean,inputProps:Object,resizable:{type:Boolean,default:!0},showCount:Boolean,loading:{type:Boolean,default:void 0},allowInput:Function,renderCount:Function,onMousedown:Function,onKeydown:Function,onKeyup:[Function,Array],onInput:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClick:[Function,Array],onChange:[Function,Array],onClear:[Function,Array],countGraphemes:Function,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],textDecoration:[String,Array],attrSize:{type:Number,default:20},onInputBlur:[Function,Array],onInputFocus:[Function,Array],onDeactivate:[Function,Array],onActivate:[Function,Array],onWrapperFocus:[Function,Array],onWrapperBlur:[Function,Array],internalDeactivateOnEnter:Boolean,internalForceFocus:Boolean,internalLoadingBeforeSuffix:{type:Boolean,default:!0},showPasswordToggle:Boolean}),fr=R({name:"Input",props:An,slots:Object,setup(e){const{mergedClsPrefixRef:t,mergedBorderedRef:n,inlineThemeDisabled:a,mergedRtlRef:r}=sn(e),l=dt("Input","-input",In,mn,e,t);hn&&un("-input-safari",Mn,t);const b=I(null),f=I(null),h=I(null),v=I(null),y=I(null),k=I(null),s=I(null),d=_n(s),_=I(null),{localeRef:W}=bn("Input"),ae=I(e.defaultValue),Fe=Xe(e,"value"),L=cn(Fe,ae),Y=wn(e),{mergedSizeRef:ce,mergedDisabledRef:G,mergedStatusRef:Oe}=Y,K=I(!1),Q=I(!1),c=I(!1),u=I(!1);let p=null;const x=D(()=>{const{placeholder:o,pair:i}=e;return i?Array.isArray(o)?o:o===void 0?["",""]:[o,o]:o===void 0?[W.value.placeholder]:[o]}),Pe=D(()=>{const{value:o}=c,{value:i}=L,{value:m}=x;return!o&&(Me(i)||Array.isArray(i)&&Me(i[0]))&&m[0]}),bt=D(()=>{const{value:o}=c,{value:i}=L,{value:m}=x;return!o&&m[1]&&(Me(i)||Array.isArray(i)&&Me(i[1]))}),Ee=nt(()=>e.internalForceFocus||K.value),wt=nt(()=>{if(G.value||e.readonly||!e.clearable||!Ee.value&&!Q.value)return!1;const{value:o}=L,{value:i}=Ee;return e.pair?!!(Array.isArray(o)&&(o[0]||o[1]))&&(Q.value||i):!!o&&(Q.value||i)}),De=D(()=>{const{showPasswordOn:o}=e;if(o)return o;if(e.showPasswordToggle)return"click"}),de=I(!1),xt=D(()=>{const{textDecoration:o}=e;return o?Array.isArray(o)?o.map(i=>({textDecoration:i})):[{textDecoration:o}]:["",""]}),Ze=I(void 0),St=()=>{var o,i;if(e.type==="textarea"){const{autosize:m}=e;if(m&&(Ze.value=(i=(o=_.value)===null||o===void 0?void 0:o.$el)===null||i===void 0?void 0:i.offsetWidth),!f.value||typeof m=="boolean")return;const{paddingTop:z,paddingBottom:M,lineHeight:C}=window.getComputedStyle(f.value),X=Number(z.slice(0,-2)),ee=Number(M.slice(0,-2)),te=Number(C.slice(0,-2)),{value:pe}=h;if(!pe)return;if(m.minRows){const fe=Math.max(m.minRows,1),je=`${X+ee+te*fe}px`;pe.style.minHeight=je}if(m.maxRows){const fe=`${X+ee+te*m.maxRows}px`;pe.style.maxHeight=fe}}},Ct=D(()=>{const{maxlength:o}=e;return o===void 0?void 0:Number(o)});ct(()=>{const{value:o}=L;Array.isArray(o)||$e(o)});const kt=He().proxy;function xe(o,i){const{onUpdateValue:m,"onUpdate:value":z,onInput:M}=e,{nTriggerFormInput:C}=Y;m&&F(m,o,i),z&&F(z,o,i),M&&F(M,o,i),ae.value=o,C()}function Se(o,i){const{onChange:m}=e,{nTriggerFormChange:z}=Y;m&&F(m,o,i),ae.value=o,z()}function zt(o){const{onBlur:i}=e,{nTriggerFormBlur:m}=Y;i&&F(i,o),m()}function Rt(o){const{onFocus:i}=e,{nTriggerFormFocus:m}=Y;i&&F(i,o),m()}function It(o){const{onClear:i}=e;i&&F(i,o)}function Mt(o){const{onInputBlur:i}=e;i&&F(i,o)}function Bt(o){const{onInputFocus:i}=e;i&&F(i,o)}function _t(){const{onDeactivate:o}=e;o&&F(o)}function At(){const{onActivate:o}=e;o&&F(o)}function Tt(o){const{onClick:i}=e;i&&F(i,o)}function Ft(o){const{onWrapperFocus:i}=e;i&&F(i,o)}function Ot(o){const{onWrapperBlur:i}=e;i&&F(i,o)}function Pt(){c.value=!0}function Et(o){c.value=!1,o.target===k.value?Ce(o,1):Ce(o,0)}function Ce(o,i=0,m="input"){const z=o.target.value;if($e(z),o instanceof InputEvent&&!o.isComposing&&(c.value=!1),e.type==="textarea"){const{value:C}=_;C&&C.syncUnifiedContainer()}if(p=z,c.value)return;d.recordCursor();const M=Dt(z);if(M)if(!e.pair)m==="input"?xe(z,{source:i}):Se(z,{source:i});else{let{value:C}=L;Array.isArray(C)?C=[C[0],C[1]]:C=["",""],C[i]=z,m==="input"?xe(C,{source:i}):Se(C,{source:i})}kt.$forceUpdate(),M||ve(d.restoreCursor)}function Dt(o){const{countGraphemes:i,maxlength:m,minlength:z}=e;if(i){let C;if(m!==void 0&&(C===void 0&&(C=i(o)),C>Number(m))||z!==void 0&&(C===void 0&&(C=i(o)),C<Number(m)))return!1}const{allowInput:M}=e;return typeof M=="function"?M(o):!0}function Nt(o){Mt(o),o.relatedTarget===b.value&&_t(),o.relatedTarget!==null&&(o.relatedTarget===y.value||o.relatedTarget===k.value||o.relatedTarget===f.value)||(u.value=!1),ke(o,"blur"),s.value=null}function $t(o,i){Bt(o),K.value=!0,u.value=!0,At(),ke(o,"focus"),i===0?s.value=y.value:i===1?s.value=k.value:i===2&&(s.value=f.value)}function jt(o){e.passivelyActivated&&(Ot(o),ke(o,"blur"))}function Lt(o){e.passivelyActivated&&(K.value=!0,Ft(o),ke(o,"focus"))}function ke(o,i){o.relatedTarget!==null&&(o.relatedTarget===y.value||o.relatedTarget===k.value||o.relatedTarget===f.value||o.relatedTarget===b.value)||(i==="focus"?(Rt(o),K.value=!0):i==="blur"&&(zt(o),K.value=!1))}function Vt(o,i){Ce(o,i,"change")}function Ut(o){Tt(o)}function Wt(o){It(o),qe()}function qe(){e.pair?(xe(["",""],{source:"clear"}),Se(["",""],{source:"clear"})):(xe("",{source:"clear"}),Se("",{source:"clear"}))}function Ht(o){const{onMousedown:i}=e;i&&i(o);const{tagName:m}=o.target;if(m!=="INPUT"&&m!=="TEXTAREA"){if(e.resizable){const{value:z}=b;if(z){const{left:M,top:C,width:X,height:ee}=z.getBoundingClientRect(),te=14;if(M+X-te<o.clientX&&o.clientX<M+X&&C+ee-te<o.clientY&&o.clientY<C+ee)return}}o.preventDefault(),K.value||Je()}}function Gt(){var o;Q.value=!0,e.type==="textarea"&&((o=_.value)===null||o===void 0||o.handleMouseEnterWrapper())}function Kt(){var o;Q.value=!1,e.type==="textarea"&&((o=_.value)===null||o===void 0||o.handleMouseLeaveWrapper())}function Zt(){G.value||De.value==="click"&&(de.value=!de.value)}function qt(o){if(G.value)return;o.preventDefault();const i=z=>{z.preventDefault(),at("mouseup",document,i)};if(rt("mouseup",document,i),De.value!=="mousedown")return;de.value=!0;const m=()=>{de.value=!1,at("mouseup",document,m)};rt("mouseup",document,m)}function Jt(o){e.onKeyup&&F(e.onKeyup,o)}function Yt(o){switch(e.onKeydown&&F(e.onKeydown,o),o.key){case"Escape":Ne();break;case"Enter":Qt(o);break}}function Qt(o){var i,m;if(e.passivelyActivated){const{value:z}=u;if(z){e.internalDeactivateOnEnter&&Ne();return}o.preventDefault(),e.type==="textarea"?(i=f.value)===null||i===void 0||i.focus():(m=y.value)===null||m===void 0||m.focus()}}function Ne(){e.passivelyActivated&&(u.value=!1,ve(()=>{var o;(o=b.value)===null||o===void 0||o.focus()}))}function Je(){var o,i,m;G.value||(e.passivelyActivated?(o=b.value)===null||o===void 0||o.focus():((i=f.value)===null||i===void 0||i.focus(),(m=y.value)===null||m===void 0||m.focus()))}function Xt(){var o;!((o=b.value)===null||o===void 0)&&o.contains(document.activeElement)&&document.activeElement.blur()}function eo(){var o,i;(o=f.value)===null||o===void 0||o.select(),(i=y.value)===null||i===void 0||i.select()}function to(){G.value||(f.value?f.value.focus():y.value&&y.value.focus())}function oo(){const{value:o}=b;o!=null&&o.contains(document.activeElement)&&o!==document.activeElement&&Ne()}function no(o){if(e.type==="textarea"){const{value:i}=f;i==null||i.scrollTo(o)}else{const{value:i}=y;i==null||i.scrollTo(o)}}function $e(o){const{type:i,pair:m,autosize:z}=e;if(!m&&z)if(i==="textarea"){const{value:M}=h;M&&(M.textContent=`${o??""}\r
`)}else{const{value:M}=v;M&&(o?M.textContent=o:M.innerHTML="&nbsp;")}}function ro(){St()}const Ye=I({top:"0"});function ao(o){var i;const{scrollTop:m}=o.target;Ye.value.top=`${-m}px`,(i=_.value)===null||i===void 0||i.syncUnifiedContainer()}let ze=null;et(()=>{const{autosize:o,type:i}=e;o&&i==="textarea"?ze=S(L,m=>{!Array.isArray(m)&&m!==p&&$e(m)}):ze==null||ze()});let Re=null;et(()=>{e.type==="textarea"?Re=S(L,o=>{var i;!Array.isArray(o)&&o!==p&&((i=_.value)===null||i===void 0||i.syncUnifiedContainer())}):Re==null||Re()}),Z(ft,{mergedValueRef:L,maxlengthRef:Ct,mergedClsPrefixRef:t,countGraphemesRef:Xe(e,"countGraphemes")});const io={wrapperElRef:b,inputElRef:y,textareaElRef:f,isCompositing:c,clear:qe,focus:Je,blur:Xt,select:eo,deactivate:oo,activate:to,scrollTo:no},lo=dn("Input",r,t),Qe=D(()=>{const{value:o}=ce,{common:{cubicBezierEaseInOut:i},self:{color:m,borderRadius:z,textColor:M,caretColor:C,caretColorError:X,caretColorWarning:ee,textDecorationColor:te,border:pe,borderDisabled:fe,borderHover:je,borderFocus:so,placeholderColor:uo,placeholderColorDisabled:co,lineHeightTextarea:po,colorDisabled:fo,colorFocus:mo,textColorDisabled:ho,boxShadowFocus:vo,iconSize:go,colorFocusWarning:yo,boxShadowFocusWarning:bo,borderWarning:wo,borderFocusWarning:xo,borderHoverWarning:So,colorFocusError:Co,boxShadowFocusError:ko,borderError:zo,borderFocusError:Ro,borderHoverError:Io,clearSize:Mo,clearColor:Bo,clearColorHover:_o,clearColorPressed:Ao,iconColor:To,iconColorDisabled:Fo,suffixTextColor:Oo,countTextColor:Po,countTextColorDisabled:Eo,iconColorHover:Do,iconColorPressed:No,loadingColor:$o,loadingColorError:jo,loadingColorWarning:Lo,fontWeight:Vo,[Ve("padding",o)]:Uo,[Ve("fontSize",o)]:Wo,[Ve("height",o)]:Ho}}=l.value,{left:Go,right:Ko}=pn(Uo);return{"--n-bezier":i,"--n-count-text-color":Po,"--n-count-text-color-disabled":Eo,"--n-color":m,"--n-font-size":Wo,"--n-font-weight":Vo,"--n-border-radius":z,"--n-height":Ho,"--n-padding-left":Go,"--n-padding-right":Ko,"--n-text-color":M,"--n-caret-color":C,"--n-text-decoration-color":te,"--n-border":pe,"--n-border-disabled":fe,"--n-border-hover":je,"--n-border-focus":so,"--n-placeholder-color":uo,"--n-placeholder-color-disabled":co,"--n-icon-size":go,"--n-line-height-textarea":po,"--n-color-disabled":fo,"--n-color-focus":mo,"--n-text-color-disabled":ho,"--n-box-shadow-focus":vo,"--n-loading-color":$o,"--n-caret-color-warning":ee,"--n-color-focus-warning":yo,"--n-box-shadow-focus-warning":bo,"--n-border-warning":wo,"--n-border-focus-warning":xo,"--n-border-hover-warning":So,"--n-loading-color-warning":Lo,"--n-caret-color-error":X,"--n-color-focus-error":Co,"--n-box-shadow-focus-error":ko,"--n-border-error":zo,"--n-border-focus-error":Ro,"--n-border-hover-error":Io,"--n-loading-color-error":jo,"--n-clear-color":Bo,"--n-clear-size":Mo,"--n-clear-color-hover":_o,"--n-clear-color-pressed":Ao,"--n-icon-color":To,"--n-icon-color-hover":Do,"--n-icon-color-pressed":No,"--n-icon-color-disabled":Fo,"--n-suffix-text-color":Oo}}),ie=a?fn("input",D(()=>{const{value:o}=ce;return o[0]}),Qe,e):void 0;return Object.assign(Object.assign({},io),{wrapperElRef:b,inputElRef:y,inputMirrorElRef:v,inputEl2Ref:k,textareaElRef:f,textareaMirrorElRef:h,textareaScrollbarInstRef:_,rtlEnabled:lo,uncontrolledValue:ae,mergedValue:L,passwordVisible:de,mergedPlaceholder:x,showPlaceholder1:Pe,showPlaceholder2:bt,mergedFocus:Ee,isComposing:c,activated:u,showClearButton:wt,mergedSize:ce,mergedDisabled:G,textDecorationStyle:xt,mergedClsPrefix:t,mergedBordered:n,mergedShowPasswordOn:De,placeholderStyle:Ye,mergedStatus:Oe,textAreaScrollContainerWidth:Ze,handleTextAreaScroll:ao,handleCompositionStart:Pt,handleCompositionEnd:Et,handleInput:Ce,handleInputBlur:Nt,handleInputFocus:$t,handleWrapperBlur:jt,handleWrapperFocus:Lt,handleMouseEnter:Gt,handleMouseLeave:Kt,handleMouseDown:Ht,handleChange:Vt,handleClick:Ut,handleClear:Wt,handlePasswordToggleClick:Zt,handlePasswordToggleMousedown:qt,handleWrapperKeydown:Yt,handleWrapperKeyup:Jt,handleTextAreaMirrorResize:ro,getTextareaScrollContainer:()=>f.value,mergedTheme:l,cssVars:a?void 0:Qe,themeClass:ie==null?void 0:ie.themeClass,onRender:ie==null?void 0:ie.onRender})},render(){var e,t;const{mergedClsPrefix:n,mergedStatus:a,themeClass:r,type:l,countGraphemes:b,onRender:f}=this,h=this.$slots;return f==null||f(),g("div",{ref:"wrapperElRef",class:[`${n}-input`,r,a&&`${n}-input--${a}-status`,{[`${n}-input--rtl`]:this.rtlEnabled,[`${n}-input--disabled`]:this.mergedDisabled,[`${n}-input--textarea`]:l==="textarea",[`${n}-input--resizable`]:this.resizable&&!this.autosize,[`${n}-input--autosize`]:this.autosize,[`${n}-input--round`]:this.round&&l!=="textarea",[`${n}-input--pair`]:this.pair,[`${n}-input--focus`]:this.mergedFocus,[`${n}-input--stateful`]:this.stateful}],style:this.cssVars,tabindex:!this.mergedDisabled&&this.passivelyActivated&&!this.activated?0:void 0,onFocus:this.handleWrapperFocus,onBlur:this.handleWrapperBlur,onClick:this.handleClick,onMousedown:this.handleMouseDown,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onCompositionstart:this.handleCompositionStart,onCompositionend:this.handleCompositionEnd,onKeyup:this.handleWrapperKeyup,onKeydown:this.handleWrapperKeydown},g("div",{class:`${n}-input-wrapper`},Ie(h.prefix,v=>v&&g("div",{class:`${n}-input__prefix`},v)),l==="textarea"?g(an,{ref:"textareaScrollbarInstRef",class:`${n}-input__textarea`,container:this.getTextareaScrollContainer,triggerDisplayManually:!0,useUnifiedContainer:!0,internalHoistYRail:!0},{default:()=>{var v,y;const{textAreaScrollContainerWidth:k}=this,s={width:this.autosize&&k&&`${k}px`};return g(Yo,null,g("textarea",Object.assign({},this.inputProps,{ref:"textareaElRef",class:[`${n}-input__textarea-el`,(v=this.inputProps)===null||v===void 0?void 0:v.class],autofocus:this.autofocus,rows:Number(this.rows),placeholder:this.placeholder,value:this.mergedValue,disabled:this.mergedDisabled,maxlength:b?void 0:this.maxlength,minlength:b?void 0:this.minlength,readonly:this.readonly,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,style:[this.textDecorationStyle[0],(y=this.inputProps)===null||y===void 0?void 0:y.style,s],onBlur:this.handleInputBlur,onFocus:d=>{this.handleInputFocus(d,2)},onInput:this.handleInput,onChange:this.handleChange,onScroll:this.handleTextAreaScroll})),this.showPlaceholder1?g("div",{class:`${n}-input__placeholder`,style:[this.placeholderStyle,s],key:"placeholder"},this.mergedPlaceholder[0]):null,this.autosize?g(ln,{onResize:this.handleTextAreaMirrorResize},{default:()=>g("div",{ref:"textareaMirrorElRef",class:`${n}-input__textarea-mirror`,key:"mirror"})}):null)}}):g("div",{class:`${n}-input__input`},g("input",Object.assign({type:l==="password"&&this.mergedShowPasswordOn&&this.passwordVisible?"text":l},this.inputProps,{ref:"inputElRef",class:[`${n}-input__input-el`,(e=this.inputProps)===null||e===void 0?void 0:e.class],style:[this.textDecorationStyle[0],(t=this.inputProps)===null||t===void 0?void 0:t.style],tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[0],disabled:this.mergedDisabled,maxlength:b?void 0:this.maxlength,minlength:b?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[0]:this.mergedValue,readonly:this.readonly,autofocus:this.autofocus,size:this.attrSize,onBlur:this.handleInputBlur,onFocus:v=>{this.handleInputFocus(v,0)},onInput:v=>{this.handleInput(v,0)},onChange:v=>{this.handleChange(v,0)}})),this.showPlaceholder1?g("div",{class:`${n}-input__placeholder`},g("span",null,this.mergedPlaceholder[0])):null,this.autosize?g("div",{class:`${n}-input__input-mirror`,key:"mirror",ref:"inputMirrorElRef"}," "):null),!this.pair&&Ie(h.suffix,v=>v||this.clearable||this.showCount||this.mergedShowPasswordOn||this.loading!==void 0?g("div",{class:`${n}-input__suffix`},[Ie(h["clear-icon-placeholder"],y=>(this.clearable||y)&&g(it,{clsPrefix:n,show:this.showClearButton,onClear:this.handleClear},{placeholder:()=>y,icon:()=>{var k,s;return(s=(k=this.$slots)["clear-icon"])===null||s===void 0?void 0:s.call(k)}})),this.internalLoadingBeforeSuffix?null:v,this.loading!==void 0?g(yn,{clsPrefix:n,loading:this.loading,showArrow:!1,showClear:!1,style:this.cssVars}):null,this.internalLoadingBeforeSuffix?v:null,this.showCount&&this.type!=="textarea"?g(lt,null,{default:y=>{var k;const{renderCount:s}=this;return s?s(y):(k=h.count)===null||k===void 0?void 0:k.call(h,y)}}):null,this.mergedShowPasswordOn&&this.type==="password"?g("div",{class:`${n}-input__eye`,onMousedown:this.handlePasswordToggleMousedown,onClick:this.handlePasswordToggleClick},this.passwordVisible?Le(h["password-visible-icon"],()=>[g(ot,{clsPrefix:n},{default:()=>g(zn,null)})]):Le(h["password-invisible-icon"],()=>[g(ot,{clsPrefix:n},{default:()=>g(Rn,null)})])):null]):null)),this.pair?g("span",{class:`${n}-input__separator`},Le(h.separator,()=>[this.separator])):null,this.pair?g("div",{class:`${n}-input-wrapper`},g("div",{class:`${n}-input__input`},g("input",{ref:"inputEl2Ref",type:this.type,class:`${n}-input__input-el`,tabindex:this.passivelyActivated&&!this.activated?-1:void 0,placeholder:this.mergedPlaceholder[1],disabled:this.mergedDisabled,maxlength:b?void 0:this.maxlength,minlength:b?void 0:this.minlength,value:Array.isArray(this.mergedValue)?this.mergedValue[1]:void 0,readonly:this.readonly,style:this.textDecorationStyle[1],onBlur:this.handleInputBlur,onFocus:v=>{this.handleInputFocus(v,1)},onInput:v=>{this.handleInput(v,1)},onChange:v=>{this.handleChange(v,1)}}),this.showPlaceholder2?g("div",{class:`${n}-input__placeholder`},g("span",null,this.mergedPlaceholder[1])):null),Ie(h.suffix,v=>(this.clearable||v)&&g("div",{class:`${n}-input__suffix`},[this.clearable&&g(it,{clsPrefix:n,show:this.showClearButton,onClear:this.handleClear},{icon:()=>{var y;return(y=h["clear-icon"])===null||y===void 0?void 0:y.call(h)},placeholder:()=>{var y;return(y=h["clear-icon-placeholder"])===null||y===void 0?void 0:y.call(h)}}),v]))):null,this.mergedBordered?g("div",{class:`${n}-input__border`}):null,this.mergedBordered?g("div",{class:`${n}-input__state-border`}):null,this.showCount&&l==="textarea"?g(lt,null,{default:v=>{var y;const{renderCount:k}=this;return k?k(v):(y=h.count)===null||y===void 0?void 0:y.call(h,v)}}):null)}});function mr(){const e=T(vn,null);return e===null&&pt("use-dialog","No outer <n-dialog-provider /> founded."),e}function hr(){const e=T(gn,null);return e===null&&pt("use-message","No outer <n-message-provider /> founded. See prerequisite in https://www.naiveui.com/en-US/os-theme/components/message for more details. If you want to use `useMessage` outside setup, please check https://www.naiveui.com/zh-CN/os-theme/components/message#Q-&-A."),e}/*!
* @indoorequal/vue-maplibre-gl v8.4.2
* (c) 2025 François de Metz <francois@2metz.fr>
* @license MIT
*/const Tn=Symbol("map"),se=Tn,ye=Symbol("isLoaded"),Fn=Symbol("isInitialized"),mt=Fn,Ge=Symbol("componentId"),Ke=Symbol("sourceId"),ht=Symbol("sourceLayerRegistry"),On=["error","load","idle","remove","render","resize","webglcontextlost","webglcontextrestored","dataloading","data","tiledataloading","sourcedataloading","styledataloading","sourcedata","styledata","styleimagemissing","dataabort","sourcedataabort","boxzoomcancel","boxzoomstart","boxzoomend","touchcancel","touchmove","touchend","touchstart","click","contextmenu","dblclick","mousemove","mouseup","mousedown","mouseout","mouseover","movestart","move","moveend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","dragstart","drag","dragend","pitchstart","pitch","pitchend","wheel","terrain","cooperativegestureprevented"];function Pn(e,t,n,a){return r=>n.emit(a,{type:r.type,map:t,component:e,event:r})}function En(e,t){const n=re.LngLat.convert(e),a=re.LngLat.convert(t);return n.lng===a.lng&&n.lat===a.lat}var be=(e=>(e.TOP_LEFT="top-left",e.TOP_RIGHT="top-right",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_RIGHT="bottom-right",e))(be||{});const ue=Object.values(be),st=new Map,Dn=Symbol("default");function Nn(e,t,n=Dn){var r;let a=st.get(n);return a||(a=en({isLoaded:!1,isMounted:!1,language:null}),st.set(n,a)),a.isLoaded=((r=t.value)==null?void 0:r.loaded())||!1,a.isMounted=!1,a.component=e,a.map=t.value,a}const vr=R({name:"MglMap",props:{width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},attributionControl:{type:[Boolean,Object],default:void 0},bearing:{type:Number},bearingSnap:{type:Number},bounds:{type:[Array,Object]},boxZoom:{type:Boolean,default:void 0},center:{type:[Array,Object]},clickTolerance:{type:Number},collectResourceTiming:{type:Boolean,default:void 0},crossSourceCollisions:{type:Boolean,default:void 0},dragPan:{type:Boolean,default:void 0},dragRotate:{type:Boolean,default:void 0},doubleClickZoom:{type:Boolean,default:void 0},hash:{type:[Boolean,String],default:void 0},fadeDuration:{type:Number},fitBoundsOptions:{type:Object},interactive:{type:Boolean,default:void 0},keyboard:{type:Boolean,default:void 0},locale:{type:Object},localIdeographFontFamily:{type:String},logoPosition:{type:[String],validator:e=>e in be},maxBounds:{type:[Array,Object]},maxPitch:{type:Number},maxZoom:{type:Number},minPitch:{type:Number},minZoom:{type:Number},pitch:{type:Number},pitchWithRotate:{type:Boolean,default:void 0},canvasContextAttributes:{type:Object},refreshExpiredTiles:{type:Boolean,default:void 0},renderWorldCopies:{type:Boolean,default:void 0},scrollZoom:{type:Boolean,default:void 0},mapStyle:{type:[String,Object]},trackResize:{type:Boolean,default:void 0},transformRequest:{type:Function},transformCameraUpdate:{type:Function},touchZoomRotate:{type:Boolean,default:void 0},touchPitch:{type:Boolean,default:void 0},zoom:{type:Number},maxTileCacheSize:{type:Number},mapKey:{type:[String,Symbol]},pixelRatio:{type:Number},validateStyle:{type:Boolean,default:void 0},cooperativeGestures:{type:Boolean}},emits:["map:error","map:load","map:idle","map:remove","map:render","map:resize","map:webglcontextlost","map:webglcontextrestored","map:dataloading","map:data","map:tiledataloading","map:sourcedataloading","map:styledataloading","map:sourcedata","map:styledata","map:styleimagemissing","map:dataabort","map:sourcedataabort","map:boxzoomcancel","map:boxzoomstart","map:boxzoomend","map:touchcancel","map:touchmove","map:touchend","map:touchstart","map:click","map:contextmenu","map:dblclick","map:mousemove","map:mouseup","map:mousedown","map:mouseout","map:mouseover","map:movestart","map:move","map:moveend","map:zoomstart","map:zoom","map:zoomend","map:rotatestart","map:rotate","map:rotateend","map:dragstart","map:drag","map:dragend","map:pitchstart","map:pitch","map:pitchend","map:wheel","map:terrain","map:cooperativegestureprevented","map:projectiontransition","update:center","update:zoom","update:pitch","update:bearing"],slots:Object,setup(e,t){const n=tt(He()),a=We(),r=We(),l=I(!1),b=I(!1),f=new Map,h=Nn(n,r,e.mapKey);Z(se,r),Z(ye,b),Z(mt,l),Z(Ge,n.uid),Z(Ke,""),S(()=>e.bearing,s=>{var d;s&&((d=r.value)==null||d.setBearing(s))}),S(()=>e.bounds,s=>{var d;s&&((d=r.value)==null||d.fitBounds(s,e.fitBoundsOptions))}),S(()=>e.center,s=>{var _,W;const d=(_=r.value)==null?void 0:_.getCenter();s&&d&&!En(s,d)&&((W=r.value)==null||W.setCenter(s))}),S(()=>e.maxBounds,s=>{var d;s&&((d=r.value)==null||d.setMaxBounds(s))}),S(()=>e.maxPitch,s=>{var d;s&&((d=r.value)==null||d.setMaxPitch(s))}),S(()=>e.maxZoom,s=>{var d;s&&((d=r.value)==null||d.setMaxZoom(s))}),S(()=>e.minPitch,s=>{var d;s&&((d=r.value)==null||d.setMinPitch(s))}),S(()=>e.minZoom,s=>{var d;s&&((d=r.value)==null||d.setMinZoom(s))}),S(()=>e.pitch,s=>{var d;s&&((d=r.value)==null||d.setPitch(s))}),S(()=>e.renderWorldCopies,s=>{var d;s&&((d=r.value)==null||d.setRenderWorldCopies(s))}),S(()=>e.mapStyle,s=>{var d;s&&((d=r.value)==null||d.setStyle(s))}),S(()=>e.transformRequest,s=>{var d;s&&((d=r.value)==null||d.setTransformRequest(s))}),S(()=>e.zoom,s=>{var d;s&&((d=r.value)==null||d.setZoom(s))}),S(()=>e.zoom,s=>{var d;s&&((d=r.value)==null||d.setZoom(s))});function v(){h.isMounted=!0;const s={...e,style:e.mapStyle,container:a.value};for(const d of Object.keys(s))s[d]===void 0&&delete s[d];if(r.value=tt(new re.Map(s)),h.map=r.value,l.value=!0,f.set("__load",()=>(b.value=!0,h.isLoaded=!0)),r.value.on("load",f.get("__load")),f.set("__moveend",()=>t.emit("update:center",r.value.getCenter())),r.value.on("moveend",f.get("__moveend")),f.set("__zoomend",()=>t.emit("update:zoom",r.value.getZoom())),r.value.on("zoomend",f.get("__zoomend")),f.set("__pitchend",()=>t.emit("update:pitch",r.value.getPitch())),r.value.on("pitchend",f.get("__pitchend")),f.set("__rotateend",()=>t.emit("update:bearing",r.value.getBearing())),r.value.on("rotateend",f.get("__rotateend")),n.vnode.props){for(const d of On)if(n.vnode.props["onMap:"+d]){const _=`map:${d}`,W=Pn(n,r.value,t,_);f.set(d,W),r.value.on(d,W)}}r.value.getCanvas().addEventListener("webglcontextlost",k)}async function y(){h.isMounted=!1,h.isLoaded=!1,b.value=!1,r.value&&(r.value.getCanvas().removeEventListener("webglcontextlost",k),l.value=!1,f.forEach((s,d)=>{r.value.off(d.startsWith("__")?d.substring(2):d,s)}),r.value.remove())}function k(){y(),ve(v)}return ct(v),le(y),t.expose({map:r}),()=>[g("div",{ref:a,style:{height:e.height,width:e.width}}),l.value&&t.slots.default?t.slots.default({}):void 0]},render(){return null}});function $n(e,t,n){S(e,a=>{var r,l;a&&ue.indexOf(a)===-1||((r=t.value)!=null&&r.hasControl(n)&&t.value.removeControl(n),(l=t.value)==null||l.addControl(n,a))},{immediate:!0})}function we(e,t){const n=T(se),a=T(mt),r=We();return r.value=e(),$n(()=>t.position,n,r.value),le(()=>{var l;return a.value&&((l=n.value)==null?void 0:l.removeControl(r.value))}),{control:r,map:n}}class jn{constructor(t,n){O(this,"container");this.isAdded=t,this.container=document.createElement("div"),this.setClasses(n)}getDefaultPosition(){return be.TOP_LEFT}onAdd(){return ve(()=>this.isAdded.value=!0),this.container}onRemove(){this.isAdded.value=!1,this.container.remove()}setClasses(t){this.container.className=t}}const gr=R({name:"MglCustomControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},class:{type:String,default:"maplibregl-ctrl maplibregl-ctrl-group"}},slots:Object,setup(e,{slots:t}){const n=I(!1),{control:a}=we(()=>new jn(n,e.class),e);return S(()=>e.class,()=>a.value.setClasses(e.class)),()=>{var r;return n.value?g(Qo,{to:a.value.container},(r=t.default)==null?void 0:r.call(t,{})):Te("custom-component")}},render(){return null}}),yr=R({name:"MglFullscreenControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},container:{type:Object,default:null}},setup(e){const{control:t,map:n}=we(()=>new re.FullscreenControl({container:e.container||void 0}),e);function a(){ve(()=>{var r;return(r=n.value)==null?void 0:r.resize()})}t.value.on("fullscreenstart",a),t.value.on("fullscreenend",a),le(()=>{t.value.off("fullscreenstart",a),t.value.off("fullscreenend",a)})},render(){return null}}),br=R({name:"MglGeolocateControl",props:{position:{type:String,default:be.TOP_RIGHT,validator:e=>ue.indexOf(e)!==-1},positionOptions:{type:Object,default:()=>({enableHighAccuracy:!1,timeout:6e3})},fitBoundsOptions:{type:Object,default:()=>({maxZoom:15})},trackUserLocation:{type:Boolean,default:!1},showAccuracyCircle:{type:Boolean,default:!0},showUserLocation:{type:Boolean,default:!0}},emits:["trackuserlocationstart","trackuserlocationend","userlocationlostfocus","userlocationfocus","geolocate","error","outofmaxbounds"],setup(e,t){const{control:n}=we(()=>new re.GeolocateControl({positionOptions:e.positionOptions,fitBoundsOptions:e.fitBoundsOptions,trackUserLocation:e.trackUserLocation,showAccuracyCircle:e.showAccuracyCircle,showUserLocation:e.showUserLocation}),e);function a(r){const l=b=>{t.emit(r,b)};n.value.on(r,l),le(()=>{n.value.off(r,l)})}a("trackuserlocationstart"),a("trackuserlocationend"),a("userlocationlostfocus"),a("userlocationfocus"),a("geolocate"),a("error"),a("outofmaxbounds")},render(){return null}}),wr=R({name:"MglNavigationControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},showCompass:{type:Boolean,default:!0},showZoom:{type:Boolean,default:!0},visualizePitch:Boolean},setup(e){we(()=>new re.NavigationControl({showCompass:e.showCompass,showZoom:e.showZoom,visualizePitch:e.visualizePitch}),e)},render(){return null}});var vt=(e=>(e.IMPERIAL="imperial",e.METRIC="metric",e.NAUTICAL="nautical",e))(vt||{});const Ln=Object.values(vt),xr=R({name:"MglScaleControl",props:{position:{type:String,validator:e=>ue.indexOf(e)!==-1},maxWidth:{type:Number,default:100},unit:{type:String,default:"metric",validator:e=>Ln.indexOf(e)!==-1}},setup(e){we(()=>new re.ScaleControl({maxWidth:e.maxWidth,unit:e.unit}),e)},render(){return null}});class Vn{constructor(){O(this,"unmountHandlers",new Map)}registerUnmountHandler(t,n){this.unmountHandlers.set(t,n)}unregisterUnmountHandler(t){this.unmountHandlers.delete(t)}unmount(){this.unmountHandlers.forEach(t=>t())}}const he=class he{static genSourceOpts(t){const n={...t};for(const a of Object.keys(n))(n[a]===void 0||a==="sourceId")&&delete n[a];return n}static getSourceRef(t,n){const a=typeof n=="string",r=String(t)+(a?n:"");let l=he.REFS.get(r);return l||(l=I(a?null:void 0),he.REFS.set(r,l)),l}};O(he,"REFS",new Map);let ge=he;function Un(e,t,n){const a=T(se),r=T(ye);function l(){r.value&&(a.value.addSource(t.sourceId,ge.genSourceOpts(t)),e.value=a.value.getSource(t.sourceId))}return S(r,l,{immediate:!0}),a.value.on("style.load",l),le(()=>{r.value&&(n.unmount(),a.value.removeSource(t.sourceId)),a.value.off("style.load",l)})}const Sr=R({name:"MglGeoJsonSource",props:{sourceId:{type:String,required:!0},data:{type:[Object,String],required:!0},maxzoom:Number,attribution:String,buffer:Number,tolerance:Number,cluster:Boolean,clusterRadius:Number,clusterMaxZoom:Number,clusterMinPoints:Number,clusterProperties:Object,lineMetrics:Boolean,generateId:Boolean,promoteId:[Object,String],filter:[Array,String,Object]},slots:Object,setup(e,{slots:t}){const n=T(Ge),a=ge.getSourceRef(n,e.sourceId),r=new Vn,l={...e,type:"geojson"};return Z(Ke,e.sourceId),Z(ht,r),Un(a,l,r),S([Xo(e.data)?e.data:()=>e.data,a],([b,f])=>{f==null||f.setData(b||{type:"FeatureCollection",features:[]})},{immediate:!0}),()=>[Te("GeoJSON Source"),a.value&&t.default?t.default({}):void 0]}}),U=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","touchstart","touchend","touchcancel"];function q(){return{layerId:{type:String,required:!0},source:{type:String},metadata:{type:[Object,Array,String,Number]},sourceLayer:{type:String},minzoom:{type:Number},maxzoom:{type:Number},filter:{type:Object},before:{type:String},layout:{type:Object},paint:{type:Object}}}function Wn(e,t,n,a){const r={id:e,type:t,source:n.source||a,metadata:n.metadata,minzoom:n.minzoom,maxzoom:n.maxzoom,"source-layer":n.sourceLayer,filter:n.filter,paint:n.paint,layout:n.layout};for(const l of Object.keys(r))r[l]===void 0&&delete r[l];return r}function Hn(e,t,n){if(n.props)for(const a of U){const r="on"+a.charAt(0).toUpperCase()+a.substr(1);n.props[r]&&e.on(a,t,n.props[r])}}function Gn(e,t,n){if(n.props)for(const a of U){const r="on"+a.charAt(0).toUpperCase()+a.substr(1);n.props[r]&&e.off(a,t,n.props[r])}}function gt(e,t){const n=T(se),a=T(ye),r=T(ht);function l(){a.value&&(t&&Gn(n.value,e,t.vnode),n.value.getLayer(e)&&n.value.removeLayer(e))}r.registerUnmountHandler(e,l),le(()=>{r.unregisterUnmountHandler(e),l()})}R({name:"MglBackgroundLayer",props:{layerId:{type:String,required:!0},metadata:[Object,Array,String,Number],minzoom:Number,maxzoom:Number,before:String,layout:Object,paint:Object},emits:[...U],setup(e){const t=T(se),n=T(ye);return gt(e.layerId),S(()=>e.layout,a=>{if(a)for(const[r,l]of Object.entries(a))t.value.setLayoutProperty(e.layerId,r,l)}),S(()=>e.paint,a=>{if(a)for(const[r,l]of Object.entries(a))t.value.setPaintProperty(e.layerId,r,l)}),S(n,a=>{a&&t.value.addLayer({id:e.layerId,type:"background",metadata:e.metadata,minzoom:e.minzoom,maxzoom:e.maxzoom,layout:e.layout,paint:e.paint},e.before||void 0)},{immediate:!0}),()=>Te("Background Layer")}});function J(e,t){const n=T(Ke);if(!n&&!t.source)return;const a=He(),r=T(se),l=T(ye),b=T(Ge),f=ge.getSourceRef(b,t.source||n);return gt(t.layerId,a),S(()=>t.minzoom,()=>r.value.setLayerZoomRange(t.layerId,t.minzoom||0,t.maxzoom||24)),S(()=>t.maxzoom,()=>r.value.setLayerZoomRange(t.layerId,t.minzoom||0,t.maxzoom||24)),S(()=>t.layout,h=>{if(h)for(const[v,y]of Object.entries(h))r.value.setLayoutProperty(t.layerId,v,y)},{deep:!0}),S(()=>t.paint,h=>{if(h)for(const[v,y]of Object.entries(h))r.value.setPaintProperty(t.layerId,v,y)},{deep:!0}),S(()=>t.filter,h=>r.value.setFilter(t.layerId,h),{deep:!0}),S([l,f],([h,v])=>{h&&(v||v===void 0)&&(r.value.addLayer(Wn(t.layerId,e,t,n),t.before||void 0),Hn(r.value,t.layerId,a.vnode))},{immediate:!0}),()=>Te(`${e} Layer`)}R({name:"MglCircleLayer",props:q(),emits:[...U],setup(e){return J("circle",e)}});R({name:"MglFillLayer",props:q(),emits:[...U],setup(e){return J("fill",e)}});R({name:"MglFillExtrusionLayer",props:q(),emits:[...U],setup(e){return J("fill-extrusion",e)}});R({name:"MglHeatmapLayer",props:q(),emits:[...U],setup(e){return J("heatmap",e)}});R({name:"MglHillshadeLayer",props:q(),emits:[...U],setup(e){return J("hillshade",e)}});const Cr=R({name:"MglLineLayer",props:q(),emits:[...U],setup(e){return J("line",e)}});R({name:"MglRasterLayer",props:q(),emits:[...U],setup(e){return J("raster",e)}});R({name:"MglSymbolLayer",props:q(),emits:[...U],setup(e){return J("symbol",e)}});const A=[];for(let e=0;e<256;++e)A.push((e+256).toString(16).slice(1));function Kn(e,t=0){return(A[e[t+0]]+A[e[t+1]]+A[e[t+2]]+A[e[t+3]]+"-"+A[e[t+4]]+A[e[t+5]]+"-"+A[e[t+6]]+A[e[t+7]]+"-"+A[e[t+8]]+A[e[t+9]]+"-"+A[e[t+10]]+A[e[t+11]]+A[e[t+12]]+A[e[t+13]]+A[e[t+14]]+A[e[t+15]]).toLowerCase()}let Ue;const Zn=new Uint8Array(16);function qn(){if(!Ue){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ue=crypto.getRandomValues.bind(crypto)}return Ue(Zn)}const Jn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ut={randomUUID:Jn};function ne(e,t,n){var r;if(ut.randomUUID&&!e)return ut.randomUUID();e=e||{};const a=e.random??((r=e.rng)==null?void 0:r.call(e))??qn();if(a.length<16)throw new Error("Random bytes length must be >= 16");return a[6]=a[6]&15|64,a[8]=a[8]&63|128,Kn(a)}function j(){return{name:"Untitled",description:"A new geographic item",creation_timestamp:Date.now(),modification_timestamp:Date.now(),created_by:"anonymous",modified_by:"anonymous",tags:[]}}function Yn(){return{...j(),version:1,signature:void 0}}class oe{constructor(t=ne(),n,a,r){O(this,"id");O(this,"meta");O(this,"routes");O(this,"drafts");this.id=t,this.routes=n||{id:ne(),meta:j(),routes:[]},this.drafts=a||{id:ne(),meta:j(),drafts:[]},this.meta={...Yn(),...r}}toStorage(){return{id:this.id,meta:this.meta,routes:this.routes,drafts:this.drafts}}static fromStorage(t){return new oe(t.id,t.routes,t.drafts,t.meta)}clone(){return oe.fromStorage(this.toStorage())}updateName(t){this.meta.name=t,this.meta.modification_timestamp=Date.now()}updateDescription(t){this.meta.description=t,this.meta.modification_timestamp=Date.now()}addTag(t){this.meta.tags.includes(t)||(this.meta.tags.push(t),this.meta.modification_timestamp=Date.now())}removeTag(t){const n=this.meta.tags.indexOf(t);n>-1&&(this.meta.tags.splice(n,1),this.meta.modification_timestamp=Date.now())}}class yt{constructor(t=[],n=ne(),a=j()){O(this,"id");O(this,"meta");O(this,"routesInternal");this.id=n,this.meta=a||j(),this.routesInternal=t}get name(){return this.meta||(this.meta=j()),this.meta.name}set name(t){this.meta||(this.meta=j()),this.meta.name=t}get routes(){return H(this.routesInternal)}set routes(t){this.routesInternal=H(t)}findRoute(t){return this.routesInternal.find(n=>n.id===t)}existRoute(t){return this.routesInternal.some(n=>n.id===t)}addRoute(t){if(this.existRoute(t.id))throw new Error(`[CartoSketch.Route] Route ${t.id} already exist`);this.routesInternal.push(H(t)),this.updateModificationTime()}updateRoute(t){const n=this.routesInternal.findIndex(a=>a.id===t.id);if(n===-1)throw new Error(`[CartoSketch.Route] Route ${t.id} not found`);this.routesInternal[n]=H(t),this.updateModificationTime()}removeRoute(t){const n=this.routesInternal.findIndex(a=>a.id===t);n!==-1&&(this.routesInternal.splice(n,1),this.updateModificationTime())}updateModificationTime(){this.meta.modification_timestamp=Date.now()}exportAsGeoJSON(){return{type:"FeatureCollection",features:this.routesInternal.map(t=>t.exportAsGeoJSON()),properties:this.meta}}exportToStorage(){return Object.freeze({id:this.id,meta:this.meta,routes:this.routesInternal.map(t=>t.exportToStorage())})}}class Be{constructor(t=ne(),n=[],a={},r=j()){O(this,"id");O(this,"meta");O(this,"properties");O(this,"points");this.id=t,this.meta=r||j(),this.properties=a,this.points=n}get name(){return this.meta||(this.meta=j()),this.meta.name}set name(t){this.meta||(this.meta=j()),this.meta.name=t}setPoints(t){this.points=H(t),this.updateModificationTime()}appendPoint(t){this.points.push(H(t)),this.updateModificationTime()}getPoints(){return H(this.points)}setProperties(t){const n=H(t);Object.assign(this.properties,n),this.updateModificationTime()}updateModificationTime(){this.meta.modification_timestamp=Date.now()}exportAsGeoJSON(){return{type:"Feature",properties:{...this.properties,...this.meta,description:JSON.stringify({name:this.meta.name,id:this.id})},geometry:{type:"LineString",coordinates:this.points.map(t=>[t.longitude,t.latitude])}}}exportToStorage(){return H({id:this.id,meta:this.meta,properties:this.properties,points:this.points})}}function Qn(e){if(!e)throw new Error("[importItemFromStorage] Invalid data provided");const t=new Be(e.id||ne(),e.points||[],e.properties||{},e.meta);return e.meta&&(t.meta=e.meta),t}function Xn(e){if(!e)throw new Error("[readCollectionFromStorage] Invalid data provided");const t=(e.routes||[]).map(a=>Qn(a)),n=new yt(t,e.id||ne(),e.meta);return e.meta&&(n.meta=e.meta),n}const kr=tn("sketches",()=>{const e=I([]),t=I(null),n=I(null),a=D(()=>{if(!t.value)return null;const c=e.value.find(u=>u.id===t.value);return c?new yt(c.routes.routes.map(u=>new Be(u.id,u.points,u.properties,u.meta)),c.routes.id,c.routes.meta):null}),r=D(()=>a.value?a.value.routes.map(c=>({id:c.id,name:c.name,points:c.getPoints()})):[]),l=D(()=>t.value&&e.value.find(c=>c.id===t.value)||null),b=D(()=>l.value?l.value.drafts.drafts:[]);async function f(){const c=await on("sketches");c?c&&typeof c=="object"&&"routes"in c&&!("sketches"in c)?(console.info("[SketchStore] Migrating old route data to new sketch format"),await h(c)):Array.isArray(c)?(e.value=c.map(u=>oe.fromStorage(u)),!t.value&&e.value.length>0&&(t.value=e.value[0].id)):await v():await v()}async function h(c){try{const u=Xn(c),p=new oe;p.meta.name=u.meta.name||"Migrated Routes",p.routes=u.exportToStorage(),e.value=[p],t.value=p.id,await P("sketches",e.value.map(x=>x.toStorage())),await E(),console.info("[SketchStore] Route migration to sketch format complete")}catch(u){console.error("[SketchStore] Failed to migrate route data:",u),await v()}}async function v(){const c=new oe;c.meta.name="Default Sketch",e.value=[c],t.value=c.id,await P("sketches",e.value.map(u=>u.toStorage())),await E()}async function y(c="New Sketch"){const u=new oe;return u.meta.name=c,e.value.push(u),await P("sketches",e.value.map(p=>p.toStorage())),await E(),u}async function k(c,u){const p=e.value.find(x=>x.id===c);p&&(u.name!==void 0&&p.updateName(u.name),u.description!==void 0&&p.updateDescription(u.description),u.tags!==void 0&&(p.meta.tags.forEach(x=>p.removeTag(x)),u.tags.forEach(x=>p.addTag(x))),await P("sketches",e.value.map(x=>x.toStorage())),await E())}async function s(c){const u=e.value.findIndex(p=>p.id===c);u!==-1&&(e.value.splice(u,1),t.value===c&&(t.value=e.value.length>0?e.value[0].id:null),await P("sketches",e.value.map(p=>p.toStorage())),await E())}function d(c){t.value=c,n.value=null}async function _(c,u={}){l.value||await v();const p=new Be(void 0,[],u);return p.meta.name=c,l.value&&l.value.routes.routes.push(p.exportToStorage()),await P("sketches",e.value.map(x=>x.toStorage())),await E(),p}async function W(c){if(!l.value)return;const u=l.value.routes.routes.findIndex(p=>p.id===c);u!==-1&&(l.value.routes.routes.splice(u,1),n.value===c&&(n.value=null),await P("sketches",e.value.map(p=>p.toStorage())),await E())}async function ae(c,u){if(!l.value)return;const p=l.value.routes.routes.find(x=>x.id===c);p&&(p.points.push(u),p.meta.modification_timestamp=Date.now(),await P("sketches",e.value.map(x=>x.toStorage())),await E())}async function Fe(c,u){if(!l.value)return;const p=l.value.routes.routes.find(x=>x.id===c);p&&(u.name!==void 0&&(p.meta.name=u.name),u.properties!==void 0&&(p.properties={...p.properties,...u.properties}),p.meta.modification_timestamp=Date.now(),await P("sketches",e.value.map(x=>x.toStorage())),await E())}async function L(c){if(!l.value)return;const u=l.value.routes.routes.find(p=>p.id===c);u&&(u.points=[],u.meta.modification_timestamp=Date.now(),await P("sketches",e.value.map(p=>p.toStorage())),await E())}function Y(c){if(!l.value)return null;const u=l.value.routes.routes.find(p=>p.id===c);return u?new Be(u.id,u.points,u.properties,u.meta):null}function ce(c){n.value=c}async function G(c,u={},p={}){l.value||await v();const x={id:crypto.randomUUID(),meta:{...j(),...p},shape:c,properties:u};return l.value&&l.value.drafts.drafts.push(x),await P("sketches",e.value.map(Pe=>Pe.toStorage())),await E(),x}async function Oe(c,u){if(!l.value)return;const p=l.value.drafts.drafts.find(x=>x.id===c);p&&(u.shape!==void 0&&(p.shape=u.shape),u.properties!==void 0&&(p.properties={...p.properties,...u.properties}),u.meta!==void 0&&(p.meta={...p.meta,...u.meta},p.meta.modification_timestamp=Date.now()),await P("sketches",e.value.map(x=>x.toStorage())),await E())}async function K(c){if(!l.value)return;const u=l.value.drafts.drafts.findIndex(p=>p.id===c);u!==-1&&(l.value.drafts.drafts.splice(u,1),await P("sketches",e.value.map(p=>p.toStorage())),await E())}function Q(c){return l.value&&l.value.drafts.drafts.find(u=>u.id===c)||null}return{sketches:e,currentSketchId:t,currentRouteId:n,routeCollection:a,routes:r,currentSketch:l,currentDrafts:b,init:f,createSketch:y,updateSketch:k,deleteSketch:s,setCurrentSketchId:d,addRoute:_,deleteRoute:W,addPointToRoute:ae,updateRoute:Fe,clearRoutePoints:L,getRouteById:Y,setCurrentRouteId:ce,addDraft:G,updateDraft:Oe,deleteDraft:K,getDraftById:Q}});export{pr as A,xr as C,sr as D,zn as E,wr as L,yr as M,fr as N,ur as R,gr as S,cr as T,dr as U,Cr as V,Sr as _,hr as a,mr as b,br as h,kr as u,vr as y};
